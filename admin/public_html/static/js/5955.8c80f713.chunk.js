"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[5955],{6566:(e,t,l)=>{l.d(t,{A:()=>n});var s=l(17706);const n=()=>{var e,t;const l={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_IS_DEMO:"true"}.MAP_API_KEY,{google_map_key:n}=null===(e=s.M.getState())||void 0===e||null===(t=e.globalSettings)||void 0===t?void 0:t.settings;return n||l}},8808:(e,t,l)=>{l.d(t,{O:()=>i});var s=l(59051),n=l.n(s);const i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const l=t/3600;let s,i;l>=168?(s="weeks",i=l/168):l>=24?(s="days",i=l/24):l>=1?(s="hours",i=l):(s="minutes",i=t);return n()(e).add(i,s).toDate()}},28257:(e,t,l)=>{l.d(t,{A:()=>m});l(9950);var s=l(84619),n=l(96011),i=l.n(n),a=l(63620);var o=l(91854),d=l(99674),r=l(59233),c=l(74635),u=l(44414);const v=a.bo?{componentRestrictions:{country:a.bo}}:{},m=e=>{let{value:t,setValue:l,setLocation:n,withLanguages:m=!0}=e;const{placePredictions:p,getPlacePredictions:x,isPlacePredictionsLoading:h}=(0,s.A)({apiKey:a.CJ,libraries:["places","geocode"],options:v}),{defaultLang:j,languages:g}=(0,o.d4)((e=>e.formLang),o.bN),A=()=>(0,u.jsx)(d.A,{allowClear:!0,searchValue:t,showSearch:!0,autoClearSearchValue:!0,loading:h,options:null===p||void 0===p?void 0:p.map((e=>({label:e.description,value:e.description}))),onSearch:e=>{l(e),e.length>0&&x({input:e})},onSelect:async e=>{const t=await async function(e){let t={address:e,key:arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.CJ};return i().get("https://maps.googleapis.com/maps/api/geocode/json",{params:t}).then((e=>{let{data:t}=e;return t.results[0]})).catch((e=>"not found"))}(e);n({lat:null===t||void 0===t?void 0:t.geometry.location.lat,lng:null===t||void 0===t?void 0:t.geometry.location.lng})},getPopupContainer:e=>e.parentNode});return m?(0,u.jsx)(u.Fragment,{children:g.map(((e,t)=>(0,u.jsx)(r.A.Item,{label:(0,c.t)("address"),name:`address[${e.locale}]`,rules:[{required:e.locale===j,message:(0,c.t)("required")}],hidden:e.locale!==j,children:A()},"address"+t)))}):(0,u.jsx)(r.A.Item,{label:(0,c.t)("address"),name:"address",rules:[{required:!0,message:(0,c.t)("required")}],children:A()})}},31281:(e,t,l)=>{function s(e,t){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"title";const s=e.map((e=>({[e.locale]:""===t[`${l}[${e.locale}]`]?void 0:t[`${l}[${e.locale}]`]})));return Object.assign({},...s)}l.d(t,{A:()=>s})},47992:(e,t,l)=>{l.d(t,{G:()=>r});var s=l(9950),n=l(95491),i=l.n(n),a=l(99674),o=l(90650),d=l(44414);const r=e=>{let{fetchOptions:t,debounceTimeout:l=400,onClear:n,refetchOptions:r=!1,...c}=e;const[u,v]=(0,s.useState)(!1),[m,p]=(0,s.useState)([]),x=(0,s.useMemo)((()=>i()((e=>{p([]),v(!0),t(e).then((e=>{p(e),v(!1)}))}),l)),[t,l]);return(0,d.jsx)(a.A,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:x,onClear:()=>{x(""),n&&n()},notFoundContent:u?(0,d.jsx)(o.A,{size:"small"}):"no results",...c,options:m,onFocus:()=>{m.length&&!r||x("")}})}},51066:(e,t,l)=>{l.d(t,{Q:()=>i});var s=l(17706),n=l(80415);const i=()=>{var e,t,l,i;return null!==(e=null===(t=s.M.getState())||void 0===t||null===(l=t.globalSettings)||void 0===l||null===(i=l.settings)||void 0===i?void 0:i.hour_format)&&void 0!==e?e:n.G}},53610:(e,t,l)=>{l.r(t),l.d(t,{default:()=>xt});var s=l(9950),n=l(81419),i=l(9083),a=l(82706),o=l(48538),d=l(74635),r=l(59051),c=l.n(r),u=l(63022),v=l(44414);const m=()=>{var e;const{selectedSlots:t,isModalOpen:l,setIsModalOpen:r,setViewContent:m}=(0,s.useContext)(u.BookingContext),p=e=>{m(e),r(!1)};return(0,v.jsxs)(a.A,{title:`${null===(e=c()(null===t||void 0===t?void 0:t.start))||void 0===e?void 0:e.format("HH:mm")}`,visible:l,onOk:()=>{r(!1)},onCancel:()=>{r(!1)},width:280,footer:null,className:"calendar-modal",children:[(0,v.jsx)(o.A,{type:"text",className:"w-100",icon:(0,v.jsx)(n.A,{}),onClick:()=>p("addService"),style:{borderRadius:0,textAlign:"left",fontSize:16},children:(0,d.t)("add.booking")}),(0,v.jsx)(o.A,{type:"text",className:"w-100",icon:(0,v.jsx)(i.A,{}),onClick:()=>p("blockTime"),style:{borderRadius:0,textAlign:"left",fontSize:16},children:(0,d.t)("add.blocked.time")})]})};l(66379);var p=l(91854),x=l(1753),h=l(23263),j=l(90650),g=l(44071),A=l(2970),f=l(28429),y=l(48676),_=l(65820),b=l(51066);const w=()=>{var e;const t=(0,f.Zp)(),l=(0,p.wA)(),n=(0,g.ye)(c()),{bookingList:i,loading:a}=(0,p.d4)((e=>e.booking)),{disabledTimes:o}=(0,p.d4)((e=>e.disabledTimes)),d=(0,_.s)(),{infoForm:r,setIsLoading:m,setViewContent:x,setIsModalOpen:w,setSelectedSlots:C,setCalculatedData:k,setServiceData:S}=(0,s.useContext)(u.BookingContext),N=(0,b.Q)();(0,s.useEffect)((()=>{var e;if(null!==(e=d.values)&&void 0!==e&&e.notify_service_id){var t,l;const e={id:null===(t=d.values)||void 0===t?void 0:t.notify_service_id,parent_id:null===(l=d.values)||void 0===l?void 0:l.notify_service_id};D(e)}}),[null===(e=d.values)||void 0===e?void 0:e.notify_service_id]);const D=(0,s.useCallback)((e=>{if(e.disabled)return x("updateBlockTime"),void t(`?disabled_slot_id=${e.id}`);x("updateForm"),m(!0),t(`?service_id=${e.id}`),A.A.getBookingById(e.parent_id).then((t=>{var l,s,n,i,a,o,d,u,v,p,x,h,j,g,f,y,_,b,w,N,D,F,I,O,T,M,B,q,$;let{data:Y}=t;S(Y),C({start:Y[(null===Y||void 0===Y?void 0:Y.length)-1].start_date,end:Y[(null===Y||void 0===Y?void 0:Y.length)-1].end_date}),((e,t)=>{A.A.calculate({user_id:e.user_id,payment_id:e.payment_id,data:t.map((e=>({data:e.data,note:e.note,service_master_id:e.service_master.id,start_date:c().utc(null===e||void 0===e?void 0:e.start_date).format("YYYY-MM-DD HH:mm")}))),ids:e.ids}).then((e=>{let{data:l}=e;const s=l.items.map(((e,l)=>({...e,...t[l],booking_id:t[l].id,status:t[l].status,type:t[l].type,notes:t[l].notes})));k({...l,items:s})})).catch((e=>{console.error(e)})).finally((()=>m(!1)))})({user_id:null===(l=Y[0])||void 0===l?void 0:l.user_id,start:null===(s=Y[0])||void 0===s?void 0:s.start_date,payment_id:null===(n=Y[0])||void 0===n||null===(i=n.transaction)||void 0===i||null===(a=i.payment_system)||void 0===a?void 0:a.id,ids:Y.map((e=>e.id))},Y),r.setFieldsValue({id:e.parent_id,shop:{label:null===(o=Y[0])||void 0===o||null===(d=o.shop)||void 0===d||null===(u=d.translation)||void 0===u?void 0:u.title,value:null===(v=Y[0])||void 0===v||null===(p=v.shop)||void 0===p?void 0:p.id,key:null===(x=Y[0])||void 0===x||null===(h=x.shop)||void 0===h?void 0:h.id},client:{label:`${null===(j=Y[0])||void 0===j||null===(g=j.user)||void 0===g?void 0:g.firstname} ${null===(f=Y[0])||void 0===f||null===(y=f.user)||void 0===y?void 0:y.lastname}`,value:null===(_=Y[0])||void 0===_||null===(b=_.user)||void 0===b?void 0:b.id,key:null===(w=Y[0])||void 0===w||null===(N=w.user)||void 0===N?void 0:N.id},payment_id:{label:(null===(D=Y[0])||void 0===D||null===(F=D.transaction)||void 0===F||null===(I=F.payment_system)||void 0===I?void 0:I.tag)||"cash",value:null===(O=Y[0])||void 0===O||null===(T=O.transaction)||void 0===T||null===(M=T.payment_system)||void 0===M?void 0:M.id,key:null===(B=Y[0])||void 0===B||null===(q=B.transaction)||void 0===q||null===($=q.payment_system)||void 0===$?void 0:$.id}})})).catch((e=>{console.log(e)}))}),[]),{defaultDate:F,scrollToTime:I}=(0,s.useMemo)((()=>({defaultDate:new Date,scrollToTime:new Date})),[]);return(0,s.useEffect)((()=>{l((0,y.nP)({perPage:100}))}),[l]),(0,v.jsx)(h.A,{className:"h-100",children:(0,v.jsx)(j.A,{spinning:a,children:(0,v.jsx)(g.Vv,{localizer:n,startAccessor:"start",endAccessor:"end",defaultDate:F,events:[...i,...o],onSelectEvent:D,onSelectSlot:e=>{let{start:t,end:l}=e;w(!0),C({start:t,end:l})},selectable:!0,scrollToTime:I,timeslots:3,step:30,defaultView:"day",eventPropGetter:(e,t,l,s)=>e.disabled?{className:"disabled-slot"}:"",formats:{timeGutterFormat:N,eventTimeRangeFormat:e=>{let{start:t,end:l}=e;return`${c()(t).format(N)} - ${c()(l).format(N)}`}}})})})};var C=l(52695);const k=e=>{let{children:t,open:l,setOpen:n,footer:i}=e;const a=(0,f.Zp)(),{setCalculatedData:o}=(0,s.useContext)(u.BookingContext);return(0,v.jsx)(C.A,{onClose:()=>{n(""),a("/master/calendar"),o({})},visible:l,className:"drawer-view",width:600,headerStyle:{display:"none"},footer:i,destroyOnClose:!0,children:t})};var S=l(59233),N=l(55902),D=l(47992),F=l(85023),I=l(8750),O=l(66362),T=l(87094),M=l(41988),B=(l(13567),l(17491)),q=l(50686),$=l(72124),Y=l(55660),H=l(82371);const L={getAll:e=>H.A.get("dashboard/master/users",{params:e})};async function V(e){const t={search:e,perPage:10};return L.getAll(t).then((e=>{let{data:t}=e;return t.map((e=>({label:`${null===e||void 0===e?void 0:e.firstname} ${null===e||void 0===e?void 0:e.lastname}`,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id})))}))}const P=async e=>await $.A.get(e).then((e=>{let{data:t}=e;return null===t||void 0===t?void 0:t.map((e=>{var t,l;return{label:null===e||void 0===e||null===(t=e.service)||void 0===t||null===(l=t.translation)||void 0===l?void 0:l.title,value:null===e||void 0===e?void 0:e.id,key:`${null===e||void 0===e?void 0:e.id} ${e.type}`}}))}));async function E(e){const t={search:e,status:"approved"};return Y.A.getAll(t).then((e=>{let{data:t}=e;return t.map((e=>{var t;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id,key:e.id}}))}))}async function z(){return B.A.getAll().then((e=>{let{data:t}=e;return t.filter((e=>e.active)).map((e=>({value:e.id,label:e.tag,key:e.id})))}))}var W=l(40895),G=l(53774),R=l(24513);const Z=e=>{var t,l,n,i,a,o,r,m,x,j,g,A,f,y,_,b,w,C,k;let{item:S}=e;const{setViewContent:N,serviceForm:D,service_id:F,setUpdateStatus:I,setSelectedMaster:O}=(0,s.useContext)(u.BookingContext),{defaultCurrency:T}=(0,p.d4)((e=>e.currency),p.bN);return(0,v.jsx)(h.A,{className:`service-card ${Boolean((null===(t=S.errors)||void 0===t?void 0:t.length)>0)&&!F&&"error"}`,children:(0,v.jsxs)("ul",{className:"mb-0",children:[(0,v.jsx)("li",{className:"mb-3 flex justify-content-between gap-2",children:(0,v.jsx)("strong",{className:"font-size-5",children:null===(l=S.service_master)||void 0===l||null===(n=l.service)||void 0===n||null===(i=n.translation)||void 0===i?void 0:i.title})}),(0,v.jsx)("li",{children:`${c().parseZone(S.start_date).format("LT")} - ${c().parseZone(S.end_date).format("LT")} (${null===S||void 0===S||null===(a=S.service_master)||void 0===a?void 0:a.interval}min + ${null===S||void 0===S||null===(o=S.service_master)||void 0===o?void 0:o.pause}min processing time)`}),(null===S||void 0===S?void 0:S.status)&&(0,v.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,v.jsxs)("span",{children:[(0,d.t)("status"),":"]}),(0,d.t)(null===S||void 0===S?void 0:S.status)," ",(0,v.jsx)(R.A,{onClick:e=>(e=>{e.stopPropagation(),I({status:S.status,booking_id:S.booking_id})})(e),className:"edit-icon"})]}),(null===S||void 0===S?void 0:S.type)&&(0,v.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,v.jsxs)("span",{children:[(0,d.t)("type"),":"]}),(0,d.t)(null===S||void 0===S?void 0:S.type)]}),(0,v.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,v.jsxs)("span",{children:[(0,d.t)("shop"),":"]}),(0,d.t)(null===S||void 0===S||null===(r=S.shop)||void 0===r||null===(m=r.translation)||void 0===m?void 0:m.title)]}),(0,v.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,v.jsxs)("span",{children:[(0,d.t)("master.fullname"),":"]}),(0,d.t)(null===S||void 0===S||null===(x=S.master)||void 0===x?void 0:x.full_name)]}),(0,v.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,v.jsxs)("span",{children:[(0,d.t)("service.name"),":"]}),(0,d.t)(null===S||void 0===S||null===(j=S.service_master)||void 0===j||null===(g=j.service)||void 0===g||null===(A=g.translation)||void 0===A?void 0:A.title)]}),!(null===S||void 0===S||null===(f=S.extras)||void 0===f||!f.length)&&(null===S||void 0===S||null===(y=S.extras)||void 0===y?void 0:y.map((e=>{var t;return(0,v.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,v.jsxs)("span",{children:[(0,d.t)("extra"),":"]}),(0,d.t)(null===e||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title)," -"," ",(0,G.default)(null===e||void 0===e?void 0:e.price,null===T||void 0===T?void 0:T.symbol,null===T||void 0===T?void 0:T.position)]})}))),(0,v.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,v.jsxs)("span",{children:[(0,d.t)("client"),":"]}),(0,d.t)(null===S||void 0===S||null===(_=S.user)||void 0===_?void 0:_.full_name)]}),(0,v.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,v.jsxs)("span",{children:[(0,d.t)("payment.type"),":"]}),(0,d.t)((null===S||void 0===S||null===(b=S.transaction)||void 0===b||null===(w=b.payment_system)||void 0===w?void 0:w.tag)||"cash")]}),(0,v.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,v.jsxs)("span",{children:[(0,d.t)("transaction.status"),":"]}),(0,d.t)((null===S||void 0===S||null===(C=S.transaction)||void 0===C?void 0:C.status)||"progress")]}),(0,v.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,v.jsxs)("span",{children:[(0,d.t)("commission.fee"),":"]}),(0,G.default)(null===S||void 0===S?void 0:S.commission_fee,null===T||void 0===T?void 0:T.symbol,null===T||void 0===T?void 0:T.position)]}),(0,v.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,v.jsxs)("span",{children:[(0,d.t)("discount"),":"]}),(0,G.default)(null===S||void 0===S?void 0:S.discount,null===T||void 0===T?void 0:T.symbol,null===T||void 0===T?void 0:T.position)]}),(0,v.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,v.jsxs)("span",{children:[(0,d.t)("gift.cart.price"),":"]}),(0,G.default)(null===S||void 0===S?void 0:S.gift_cart_price,null===T||void 0===T?void 0:T.symbol,null===T||void 0===T?void 0:T.position)]}),(0,v.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,v.jsxs)("span",{children:[(0,d.t)("service.fee"),":"]}),(0,G.default)(null===S||void 0===S?void 0:S.service_fee,null===T||void 0===T?void 0:T.symbol,null===T||void 0===T?void 0:T.position)]}),(0,v.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,v.jsxs)("span",{children:[(0,d.t)("service.master.price"),":"]}),(0,G.default)(null===S||void 0===S?void 0:S.service_master.price,null===T||void 0===T?void 0:T.symbol,null===T||void 0===T?void 0:T.position)]}),(0,v.jsx)(W.A,{}),(0,v.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,v.jsxs)("strong",{children:[(0,d.t)("total.price"),":"]}),(0,G.default)(null===S||void 0===S?void 0:S.total_price,null===T||void 0===T?void 0:T.symbol,null===T||void 0===T?void 0:T.position)]}),!F&&(0,v.jsx)("div",{className:"error-list",children:null===(k=S.errors)||void 0===k?void 0:k.map(((e,t)=>(0,v.jsx)("li",{children:e},t)))})]})})},{Title:K}=O.A,U=e=>{var t;let{isDisabled:l,title:n="new.booking",isAdd:i=!1}=e;const{calculatedData:a,setViewContent:r,setInfoData:c,infoForm:m}=(0,s.useContext)(u.BookingContext);return(0,v.jsxs)(T.A,{gutter:12,children:[(0,v.jsx)(M.A,{span:24,className:"mb-4",children:(0,v.jsx)(K,{level:2,children:(0,d.t)(n)})}),(0,v.jsx)(M.A,{span:24,children:(0,v.jsx)(S.A.Item,{name:"client",label:(0,d.t)("select.client"),placeholder:(0,d.t)("select.client"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,v.jsx)(D.G,{fetchOptions:V,style:{width:"100%"},disabled:!0})})}),(0,v.jsx)(M.A,{span:24,children:(0,v.jsx)(S.A.Item,{name:"payment_id",rules:[{required:!0,message:(0,d.t)("required")}],label:(0,d.t)("payment"),children:(0,v.jsx)(F.D,{className:"w-100",refetch:!0,placeholder:(0,d.t)("select.payment.type"),fetchOptions:z,disabled:!0})})}),null===a||void 0===a||null===(t=a.items)||void 0===t?void 0:t.map((e=>(0,v.jsx)(M.A,{span:24,children:(0,v.jsx)(Z,{item:e})},e.id))),i&&(0,v.jsx)(M.A,{span:24,children:(0,v.jsx)(o.A,{block:!0,type:"dashed",icon:(0,v.jsx)(I.A,{}),disabled:l,onClick:()=>{c(null===m||void 0===m?void 0:m.getFieldsValue()),r("serviceForm")},children:(0,d.t)("add.service")})})]})},J=()=>{const{infoForm:e,setCalculatedData:t,setIsUpdate:l,setOpenService:n,isLoalding:i,calculatedData:a}=(0,s.useContext)(u.BookingContext),o=S.A.useWatch("client",e),d=S.A.useWatch("payment_id",e);return(0,v.jsx)(j.A,{spinning:i,children:(0,v.jsxs)(S.A,{form:e,layout:"vertical",onFinish:s=>{const n={user_id:s.client.value,payment_id:s.payment_id.value,data:null===a||void 0===a?void 0:a.items.map((e=>{var t;return{note:e.note,data:e.data,service_master_id:null===(t=e.service_master)||void 0===t?void 0:t.id}})),start_date:null===a||void 0===a?void 0:a.start_date};A.A.update(s.id,n).then((()=>{l(!1),e.resetFields(),t({})})).catch((e=>{console.error(e)}))},children:[(0,v.jsx)(S.A.Item,{name:"id",className:"d-none",children:(0,v.jsx)(N.A,{})}),(0,v.jsx)(U,{title:"update.booking",setOpenService:n,isDisabled:!(o&&d)})]})})};var Q=l(43957),X=l(12916),ee=l(99674),te=l(86971),le=l(35821);const{Title:se}=O.A,ne=e=>{var t,l;let{shop:s,setViewContent:n,getServiceByID:i,getMasterByID:a,selectedService:o,form:r}=e;return(0,v.jsxs)(T.A,{gutter:12,children:[(0,v.jsxs)(M.A,{span:24,children:[(0,v.jsx)(X.A,{icon:(0,v.jsx)(le.A,{}),onClick:()=>{r.resetFields(),n("updateForm")}}),(0,v.jsx)(se,{className:"my-4",level:2,children:(0,d.t)("edit.service")})]}),(0,v.jsx)(M.A,{span:12,children:(0,v.jsx)(S.A.Item,{name:"shop",label:(0,d.t)("select.shop"),placeholder:(0,d.t)("select.shop"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,v.jsx)(F.D,{className:"w-100",fetchOptions:E})})}),(0,v.jsx)(M.A,{span:12,children:(0,v.jsx)(S.A.Item,{name:"service",label:(0,d.t)("select.service"),placeholder:(0,d.t)("select.service"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,v.jsx)(F.D,{refetch:!0,disabled:!s,className:"w-100",onChange:e=>i(e),fetchOptions:()=>P({shop_id:s.value})})})}),(0,v.jsx)(M.A,{span:12,children:(0,v.jsx)(S.A.Item,{name:"extras",label:(0,d.t)("select.service.extras"),children:(0,v.jsx)(ee.A,{disabled:!(null!==o&&void 0!==o&&null!==(t=o.service_extras)&&void 0!==t&&t.length),options:null===o||void 0===o||null===(l=o.service_extras)||void 0===l?void 0:l.map((e=>{var t;return{label:(null===e||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title)||(0,d.t)("N/A"),value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}})),labelInValue:!0,placeholder:(0,d.t)("select.extra"),mode:"multiple"})})}),(0,v.jsx)(M.A,{span:12,children:(0,v.jsx)(S.A.Item,{name:"master",label:(0,d.t)("select.master"),placeholder:(0,d.t)("select.master"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,v.jsx)(F.D,{refetch:!0,className:"w-100",disabled:!o,onChange:e=>a(e),fetchOptions:()=>async function(e){let{service_id:t,shop_id:l}=e;const s={perPage:10,role:"master",service_id:t,shop_id:l};return q.A.getAll(s).then((e=>{let{data:t}=e;return t.map((e=>({label:`${null===e||void 0===e?void 0:e.firstname} ${null===e||void 0===e?void 0:e.lastname}`,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id})))}))}({shop_id:null===s||void 0===s?void 0:s.value,service_id:null===o||void 0===o?void 0:o.id})})})}),(0,v.jsx)(M.A,{span:12,children:(0,v.jsx)(S.A.Item,{label:(0,d.t)("start.date"),name:"start_date",rules:[{required:!0,message:(0,d.t)("required")}],children:(0,v.jsx)(te.A,{className:"w-100",showTime:!0})})}),(0,v.jsx)(M.A,{span:12,children:(0,v.jsx)(S.A.Item,{label:(0,d.t)("end.date"),name:"end_date",rules:[{required:!0,message:(0,d.t)("required")}],children:(0,v.jsx)(te.A,{className:"w-100",showTime:!0})})}),(0,v.jsx)(M.A,{span:24,children:(0,v.jsx)(S.A.Item,{name:"note",label:(0,d.t)("note"),rules:[{required:!1,message:(0,d.t)("required")}],children:(0,v.jsx)(N.A.TextArea,{})})})]})};var ie=l(54764);const ae=()=>{const e=(0,p.wA)(),{serviceForm:t,setCalculatedData:l,setViewContent:n,isLoalding:i,selectedService:a,setSelectedService:o,selectedMaster:d,setSelectedMaster:r}=(0,s.useContext)(u.BookingContext),m=S.A.useWatch("shop",t);return(0,v.jsx)(j.A,{spinning:i,children:(0,v.jsxs)(S.A,{form:t,layout:"vertical",onFinish:s=>{var i,a,o;const r={note:null===s||void 0===s?void 0:s.note,service_master_id:null===d||void 0===d||null===(i=d.service_master)||void 0===i?void 0:i.id,end_date:c()(s.end_date).format("YYYY-MM-DD HH:mm"),start_date:c()(s.start_date).format("YYYY-MM-DD HH:mm"),service_extras:null!==s&&void 0!==s&&null!==(a=s.extras)&&void 0!==a&&a.length?null===s||void 0===s||null===(o=s.extras)||void 0===o?void 0:o.map((e=>e.value)):void 0};Q.A.update(s.id,r).then((()=>{n(""),t.resetFields(),l({}),e((0,x.Wg)({}))})).catch((e=>{console.error(e)}))},children:[(0,v.jsx)(S.A.Item,{name:"id",className:"d-none",children:(0,v.jsx)(N.A,{})}),(0,v.jsx)(ne,{form:t,shop:m,setViewContent:n,getMasterByID:e=>{q.A.getById(e.value).then((e=>{let{data:t}=e;const l=null===t||void 0===t?void 0:t.service_masters.find((e=>e.service_id===a.id));r({...t,service_master:l})})).catch((e=>{console.log(e)}))},getServiceByID:e=>{ie.A.getById(e.value).then((e=>{o(e.data)})).catch((e=>{console.log(e)}))},selectedService:a})]})})};var oe=l(44070),de=l(92759),re=l(78003);const{useContext:ce,useState:ue}=l(9950),{BookingContext:ve}=l(63022),{default:me}=l(53774),pe=()=>{const e=(0,p.wA)(),[t,l]=ue(),{calculatedData:s,sumInterval:n,service_id:i,setViewContent:a}=ce(ve);return(0,v.jsxs)("div",{className:"w-100 d-flex between my-2",children:[(0,v.jsx)(re.A,{title:(0,d.t)("delete.the.booking"),onConfirm:()=>{l(!0),A.A.delete({"ids[0]":i}).then((()=>{a(""),e((0,x.Wg)()),de.Ay.success((0,d.t)("booking.successfully.delete"))})).catch((e=>{console.log(e)})).finally((()=>l(!1)))},okText:(0,d.t)("yes"),cancelText:(0,d.t)("no"),children:(0,v.jsx)(o.A,{loading:t,type:"danger",icon:(0,v.jsx)(oe.A,{})})}),(0,v.jsxs)("div",{className:"d-flex gap-2 my-2",children:[(0,v.jsxs)("strong",{className:"font-size-5",children:[(0,d.t)("total"),":"]}),(0,v.jsx)("strong",{className:"font-size-5 text-nowrap",children:`${me(null===s||void 0===s?void 0:s.total_price)} (${n}min)`})]})]})},xe=()=>{const{infoForm:e,setCalculatedData:t,selectedSlots:l,calculatedData:n,setViewContent:i}=(0,s.useContext)(u.BookingContext),a=(0,p.wA)(),o=S.A.useWatch("client",e),d=S.A.useWatch("payment_id",e);return(0,v.jsx)(S.A,{form:e,layout:"vertical",onFinish:s=>{A.A.create({user_id:s.client.value,payment_id:s.payment_id.value,data:null===n||void 0===n?void 0:n.items.map((e=>{var t;return{note:e.note,data:e.data,service_master_id:null===e||void 0===e||null===(t=e.service_master)||void 0===t?void 0:t.id}})),start_date:c()(null===l||void 0===l?void 0:l.start).format("YYYY-MM-DD HH:mm")}).then((()=>{i(""),t({}),e.resetFields(),a((0,x.Wg)())})).catch((e=>{console.error(e)}))},children:(0,v.jsx)(U,{isAdd:!0,isDisabled:!(o&&d)})})},he=()=>{const{calculatedData:e,infoForm:t,setCalculatedData:l,sumInterval:n,setViewContent:i}=(0,s.useContext)(u.BookingContext);return(0,v.jsxs)("div",{children:[(0,v.jsxs)("div",{className:"w-100 d-flex between my-2",children:[(0,v.jsx)("strong",{className:"font-size-5",children:"Total"}),(0,v.jsx)("strong",{className:"font-size-5",children:`${(0,G.default)(null===e||void 0===e?void 0:e.total_price)} (${n||0}min)`})]}),(0,v.jsxs)("div",{className:"w-100 d-flex gap-2",children:[(0,v.jsx)(o.A,{type:"primary",className:"w-100",onClick:t.submit,disabled:!(null!==e&&void 0!==e&&e.status),children:(0,d.t)("checkout")}),(0,v.jsx)(o.A,{type:"danger",className:"w-100",onClick:()=>{i(""),t.resetFields(),l({})},children:(0,d.t)("cancel")})]})]})};var je=l(63620),ge=l(8808),Ae=l(78498),fe=l(28257);const{Title:ye}=O.A,_e=e=>{var t,l;let{shop:s,setOpen:n,getServiceByID:i,selectedService:a,form:r,location:c,setLocation:u,value:m,setValue:p,defaultLang:x}=e;return(0,v.jsxs)(T.A,{children:[(0,v.jsxs)(M.A,{span:24,children:[(0,v.jsx)(X.A,{icon:(0,v.jsx)(le.A,{}),onClick:()=>{n("addService"),r.resetFields()}}),(0,v.jsx)(ye,{className:"my-4",level:2,children:(0,d.t)("select.service")})]}),(0,v.jsx)(M.A,{span:24,children:(0,v.jsx)(S.A.Item,{name:"service",label:(0,d.t)("select.service"),placeholder:(0,d.t)("select.service"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,v.jsx)(F.D,{refetch:!0,disabled:!s,className:"w-100",onChange:e=>i(e),fetchOptions:()=>P({shop_id:s.value})})})}),(0,v.jsx)(M.A,{span:24,children:(0,v.jsx)(S.A.Item,{name:"extras",label:(0,d.t)("select.service.extras"),children:(0,v.jsx)(ee.A,{disabled:!(null!==a&&void 0!==a&&null!==(t=a.service_extras)&&void 0!==t&&t.length),options:null===a||void 0===a||null===(l=a.service_extras)||void 0===l?void 0:l.map((e=>{var t;return{label:(null===e||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title)||(0,d.t)("N/A"),value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}})),labelInValue:!0,placeholder:(0,d.t)("select.extra"),mode:"multiple"})})}),(0,v.jsx)(M.A,{span:24,children:(0,v.jsx)(S.A.Item,{name:"note",label:(0,d.t)("note"),rules:[{required:!1,message:(0,d.t)("required")}],children:(0,v.jsx)(N.A.TextArea,{})})}),Boolean("offline_out"===(null===a||void 0===a?void 0:a.type))&&(0,v.jsxs)(M.A,{span:24,children:[(0,v.jsx)(fe.A,{value:m,setValue:p,setLocation:u}),(0,v.jsx)(Ae.A,{location:c,setLocation:u,setAddress:e=>{r.setFieldsValue({[`address[${x}]`]:e})}})]}),(0,v.jsx)(M.A,{span:24,className:"mt-4",children:(0,v.jsx)(o.A,{type:"primary",htmlType:"submit",className:"w-100",children:(0,d.t)("submit")})})]})},be=()=>{var e;const t=(0,p.wA)(),[l]=S.A.useForm(),{infoData:n,selectedSlots:i,setViewContent:a,calculatedData:o,setCalculatedData:d}=(0,s.useContext)(u.BookingContext),{defaultLang:r}=(0,p.d4)((e=>e.formLang)),{bookingList:m}=(0,p.d4)((e=>e.booking)),[h,j]=(0,s.useState)(null),[g,f]=(0,s.useState)(je.Jb),[y,_]=(0,s.useState)(""),{user:b}=(0,p.d4)((e=>e.auth)),w=null===b||void 0===b||null===(e=b.invite)||void 0===e?void 0:e.shop;return(0,v.jsx)(S.A,{layout:"vertical",form:l,onFinish:e=>{var s,u,v;let p=[];null!==o&&void 0!==o&&o.items&&(p=null===o||void 0===o||null===(s=o.items)||void 0===s?void 0:s.map((e=>{var t,l;return{...e,service_extras:null!==e&&void 0!==e&&null!==(t=e.extras)&&void 0!==t&&t.length?null===e||void 0===e||null===(l=e.extras)||void 0===l?void 0:l.map((e=>null===e||void 0===e?void 0:e.id)):void 0}})));const j={note:e.note,data:{address:e[`address[${r}]`],...g},service_master:h,service_extras:null!==e&&void 0!==e&&null!==(u=e.extras)&&void 0!==u&&u.length?null===e||void 0===e||null===(v=e.extras)||void 0===v?void 0:v.map((e=>null===e||void 0===e?void 0:e.value)):void 0};var f;(f=[...p,j],A.A.calculate({user_id:n.client.value,payment_id:n.payment_id.value,data:f.map((e=>{var t;return{note:e.note,data:e.data,service_master_id:null===(t=e.service_master)||void 0===t?void 0:t.id}})),start_date:c()(null===i||void 0===i?void 0:i.start).format("YYYY-MM-DD HH:mm")})).then((e=>{let{data:s}=e;l.resetFields(),(()=>{let e=(0,ge.O)(i.start,null===h||void 0===h?void 0:h.interval);var l,s;m.length>0?(e=(0,ge.O)(null===m||void 0===m||null===(l=m[m.length-1])||void 0===l?void 0:l.end,null===m||void 0===m||null===(s=m[m.length-1])||void 0===s?void 0:s.pause),t((0,x.lZ)({id:h.id,pause:h.pause,title:h.service.translation.title,start:e,end:(0,ge.O)(e,null===h||void 0===h?void 0:h.interval)}))):t((0,x.lZ)({id:h.id,pause:h.pause,title:h.service.translation.title,start:new Date(i.start),end:e}))})(),d(s),a("addService")})).catch((e=>{console.log(e)}))},children:(0,v.jsx)(_e,{shop:w,form:l,setOpen:a,location:g,setLocation:f,getServiceByID:e=>{$.A.getById(e.value).then((e=>{j(e.data)})).catch((e=>{console.log(e)}))},selectedService:h,value:y,setValue:_,defaultLang:r})})},{useContext:we}=l(9950),{BookingContext:Ce}=l(63022),{Button:ke}=l(30628),Se=()=>{const{serviceForm:e}=we(Ce);return(0,v.jsx)("div",{className:"d-flex gap-2",children:(0,v.jsx)(ke,{type:"primary",className:"w-100",onClick:e.submit,children:(0,d.t)("apply")})})};var Ne=l(99985);const{Title:De}=O.A,Fe=()=>{var e,t;const[l]=S.A.useForm(),[n,i]=(0,s.useState)(!1),{service_id:a,calculatedData:r,setCalculatedData:c}=(0,s.useContext)(u.BookingContext),m=null===r||void 0===r||null===(e=r.items)||void 0===e?void 0:e.find((e=>e.booking_id===Number(a)));return(0,v.jsxs)(s.Fragment,{children:[(0,v.jsx)(De,{level:2,children:(0,d.t)("notes")}),null===m||void 0===m||null===(t=m.notes)||void 0===t?void 0:t.map((e=>(0,v.jsx)(Ne.A,{message:e,className:"mb-2"}))),(0,v.jsxs)(S.A,{form:l,onFinish:e=>{i(!0),A.A.updateNote(a,e).then((e=>{let{data:t}=e;l.resetFields(),c((e=>{var l;return{...e,items:null===r||void 0===r||null===(l=r.items)||void 0===l?void 0:l.map((e=>e.booking_id===Number(a)?{...e,notes:t.notes}:e))}}))})).catch((e=>{console.log(e)})).finally((()=>i(!1)))},layout:"vertical",className:"mt-5",children:[(0,v.jsx)(S.A.Item,{name:"note",rules:[{required:!0}],label:"add.note",children:(0,v.jsx)(N.A.TextArea,{})}),(0,v.jsx)(o.A,{htmlType:"submit",type:"primary",loading:n,children:(0,d.t)("submit")})]})]})};var Ie=l(95749),Oe=l(47738),Te=l(19826),Me=l(12534),Be=l(69216);function qe(e,t,l,s){return{key:t,icon:l,children:s,label:e}}const $e=()=>{const{setViewContent:e,service_id:t}=(0,s.useContext)(u.BookingContext),l=[qe("Info",t?"updateForm":"addService",(0,v.jsx)(Ie.A,{})),qe("Forms","forms",(0,v.jsx)(Oe.A,{})),qe("Activity","activity",(0,v.jsx)(Te.A,{})),qe("Notes","notes",(0,v.jsx)(Me.A,{}))];return(0,v.jsx)("div",{className:"content-menu",children:(0,v.jsx)(Be.A,{mode:"inline",items:l,defaultSelectedKeys:["info"],onClick:t=>(t=>{e(t.key)})(t)})})};var Ye=l(90247);const{Title:He,Text:Le}=O.A,Ve=()=>{var e,t;const{setIsAddForm:l,calculatedData:n,setFormDetailId:i}=(0,s.useContext)(u.BookingContext),a=null===n||void 0===n||null===(e=n.items)||void 0===e?void 0:e.flatMap((e=>e.data.form||[]));return(0,v.jsxs)("div",{children:[(0,v.jsxs)("div",{className:"d-flex between",children:[(0,v.jsx)(He,{children:(0,d.t)("forms")}),(0,v.jsx)(o.A,{type:"text",size:"large",onClick:()=>l(!0),children:(0,d.t)("add.form")})]}),0===(null===a||void 0===a?void 0:a.length)&&(0,v.jsx)(h.A,{children:(0,v.jsx)(Ye.A,{image:Ye.A.PRESENTED_IMAGE_SIMPLE,description:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("strong",{children:"No client forms added yet."})," ",(0,v.jsx)("br",{})," Forms will appear here if required by any services in the appointment or if added manually."]})})}),null===n||void 0===n||null===(t=n.items)||void 0===t?void 0:t.map((e=>{var t;return e.data.form&&(0,v.jsx)("div",{children:null===(t=e.data.form)||void 0===t?void 0:t.map((e=>{var t;return(0,v.jsxs)(h.A,{children:[(0,v.jsx)(Le,{type:"secondary",children:c()().format("ddd Do MMM, h:mm a")}),(0,v.jsxs)(Le,{type:"success",className:"ml-2",children:["\u2022 ",(0,d.t)("complated")]}),(0,v.jsx)(He,{level:4,className:"mt-2",children:null===e||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title}),(0,v.jsx)(o.A,{onClick:()=>i(e.id),children:(0,d.t)("view.form")})]},null===e||void 0===e?void 0:e.id)}))},e.id)}))]})};var Pe=l(98252);const{Title:Ee}=O.A,ze=()=>{var e,t;const{serviceData:l,service_id:n}=(0,s.useContext)(u.BookingContext),i=null===l||void 0===l?void 0:l.find((e=>e.id==n)),a=Boolean(!(null!==i&&void 0!==i&&null!==(e=i.activities)&&void 0!==e&&e.length));return(0,v.jsxs)("div",{className:"h-100",children:[(0,v.jsx)(Ee,{children:(0,d.t)("activities")}),null===i||void 0===i||null===(t=i.activities)||void 0===t?void 0:t.map((e=>{var t;return(0,v.jsxs)(h.A,{className:"mb-2",children:[(0,v.jsx)(h.A.Meta,{avatar:(0,v.jsx)(Pe.A,{src:null===(t=e.user)||void 0===t?void 0:t.img,size:"large"}),title:e.user.firstname,description:c()(e.created_at).format("MMMM Do YYYY, h:mm a")}),(0,v.jsx)(h.A.Meta,{description:e.note,className:"mt-3"})]},e.id)})),a&&(0,v.jsx)(Ye.A,{description:(0,d.t)("activities.not.found")})]})};var We=l(57796),Ge=l(40577),Re=l(52765);const Ze=[{label:"M",value:"monday"},{label:"T",value:"tuesday"},{label:"W",value:"wednesday"},{label:"T",value:"thursday"},{label:"F",value:"friday"},{label:"S",value:"saturday"},{label:"S",value:"sunday"}],Ke=e=>{let{end:t}=e;return"date"===t?(0,v.jsx)(M.A,{span:12,children:(0,v.jsx)(S.A.Item,{name:"end_value_date",children:(0,v.jsx)(te.A,{className:"w-100"})})}):"after"===t?(0,v.jsx)(M.A,{span:12,children:(0,v.jsx)(S.A.Item,{label:(0,d.t)("occurrences"),name:"end_value",children:(0,v.jsx)(Ge.A,{className:"w-100"})})}):""},Ue=e=>{let{type:t,form:l}=e;const s=S.A.useWatch("end_type",l),n=S.A.useWatch("every",l);return"dont_repeat"===t?"":"custom"===t?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(M.A,{span:24,children:(0,v.jsx)(S.A.Item,{name:"every",label:"every",children:(0,v.jsxs)(N.A.Group,{compact:!0,children:[(0,v.jsx)(S.A.Item,{name:["every","number"],noStyle:!0,children:(0,v.jsx)(Ge.A,{})}),(0,v.jsx)(S.A.Item,{name:["every","type"],noStyle:!0,children:(0,v.jsxs)(ee.A,{children:[(0,v.jsx)(ee.A.Option,{value:"day",children:(0,d.t)("day")}),(0,v.jsx)(ee.A.Option,{value:"week",children:(0,d.t)("week")}),(0,v.jsx)(ee.A.Option,{value:"month",children:(0,d.t)("month")})]})})]})})}),"week"===(null===n||void 0===n?void 0:n.type)&&(0,v.jsx)(M.A,{span:24,children:(0,v.jsx)(S.A.Item,{name:"on_days",label:(0,d.t)("on.days"),children:(0,v.jsx)(Re.A.Group,{options:Ze})})}),(0,v.jsx)(M.A,{span:24,children:(0,v.jsx)(S.A.Item,{name:"end_type",label:(0,d.t)("end"),placeholder:(0,d.t)("select.end"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,v.jsxs)(ee.A,{style:{width:"100%"},children:[(0,v.jsx)(ee.A.Option,{value:"never",children:(0,d.t)("never")}),(0,v.jsx)(ee.A.Option,{value:"date",children:(0,d.t)("date")}),(0,v.jsx)(ee.A.Option,{value:"after",children:(0,d.t)("after")})]})})}),(0,v.jsx)(Ke,{end:s})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(M.A,{span:24,children:(0,v.jsx)(S.A.Item,{name:"end_type",label:(0,d.t)("end"),placeholder:(0,d.t)("select.end"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,v.jsxs)(ee.A,{style:{width:"100%"},children:[(0,v.jsx)(ee.A.Option,{value:"never",children:(0,d.t)("never")}),(0,v.jsx)(ee.A.Option,{value:"date",children:(0,d.t)("date")}),(0,v.jsx)(ee.A.Option,{value:"after",children:(0,d.t)("after")})]})})}),(0,v.jsx)(Ke,{end:s})]})};var Je=l(80415);const{Title:Qe}=O.A,Xe=e=>{let{form:t}=e;const l=S.A.useWatch("repeats",t),{languages:s,defaultLang:n}=(0,p.d4)((e=>e.formLang),p.bN);return(0,v.jsxs)(T.A,{gutter:[12,12],children:[(0,v.jsx)(M.A,{span:24,children:(0,v.jsx)(Qe,{className:"my-4",level:2,children:(0,d.t)("add.blocked.time")})}),(0,v.jsx)(M.A,{span:24,children:s.filter((e=>e.locale===n)).map((e=>(0,v.jsx)(S.A.Item,{label:(0,d.t)("title"),name:`title[${e.locale}]`,rules:[{required:e.locale===n,message:(0,d.t)("required")}],children:(0,v.jsx)(N.A,{})},"title"+e.locale)))}),(0,v.jsx)(M.A,{span:12,children:(0,v.jsx)(S.A.Item,{label:(0,d.t)("date"),name:"date",rules:[{required:!0,message:(0,d.t)("required")}],children:(0,v.jsx)(te.A,{className:"w-100"})})}),(0,v.jsx)(M.A,{span:12,children:(0,v.jsx)(S.A.Item,{label:(0,d.t)("from"),name:"from",rules:[{required:!0,message:(0,d.t)("required")}],children:(0,v.jsx)(We.A,{use12Hours:Je.wO,format:Je.xt,className:"w-100",showTime:!0})})}),(0,v.jsx)(M.A,{span:12,children:(0,v.jsx)(S.A.Item,{label:(0,d.t)("to"),name:"to",rules:[{required:!0,message:(0,d.t)("required")}],children:(0,v.jsx)(We.A,{use12Hours:Je.wO,format:Je.xt,className:"w-100",showTime:!0})})}),(0,v.jsx)(M.A,{span:24,children:(0,v.jsx)(S.A.Item,{name:"repeats",label:(0,d.t)("repeats"),placeholder:(0,d.t)("select.repeat"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,v.jsxs)(ee.A,{style:{width:"100%"},children:[(0,v.jsx)(ee.A.Option,{value:"dont_repeat",children:(0,d.t)("dont_repeat")}),(0,v.jsx)(ee.A.Option,{value:"day",children:(0,d.t)("day")}),(0,v.jsx)(ee.A.Option,{value:"week",children:(0,d.t)("week")}),(0,v.jsx)(ee.A.Option,{value:"month",children:(0,d.t)("month")}),(0,v.jsx)(ee.A.Option,{value:"custom",children:(0,d.t)("custom")})]})})}),(0,v.jsx)(Ue,{type:l,form:t}),(0,v.jsx)(M.A,{span:24,style:{flexGrow:1},children:s.filter((e=>e.locale===n)).map((e=>(0,v.jsx)(S.A.Item,{label:(0,d.t)("description"),name:`description[${e.locale}]`,rules:[{required:e.locale===n,message:(0,d.t)("required")}],children:(0,v.jsx)(N.A.TextArea,{})},"description"+e.locale)))})]})};var et=l(84970);const tt=()=>{const e=(0,p.wA)(),{defaultLang:t}=(0,p.d4)((e=>e.formLang)),{selectedSlots:l,setViewContent:n,blocktimeForm:i}=(0,s.useContext)(u.BookingContext);return(0,v.jsx)(S.A,{form:i,layout:"vertical",onFinish:l=>{var s,i,a,o;et.A.create({repeats:l.repeats,end_type:l.end_type,master_id:null===(s=l.master_id)||void 0===s?void 0:s.value,to:c()(l.to).format("HH:mm"),custom_repeat_type:null===(i=l.every)||void 0===i?void 0:i.type,from:c()(l.from).format("HH:mm"),date:c()(l.date).format("YYYY-MM-DD"),end_value:l.end_value||l.end_value_date,[`title[${t}]`]:l[`title[${t}]`],custom_repeat_value:l.on_days&&(null===(a=l.every)||void 0===a?void 0:a.number)&&[null===(o=l.every)||void 0===o?void 0:o.number,...l.on_days],[`description[${t}]`]:l[`description[${t}]`]}).then((()=>{n(""),e((0,y.nP)({perPage:100}))})).catch((e=>{console.log(e)}))},initialValues:{date:c()(),end_type:"never",repeats:"dont_repeat",from:c()(null===l||void 0===l?void 0:l.start,"HH:mm:ss"),to:c()(null===l||void 0===l?void 0:l.end,"HH:mm:ss"),every:{type:"day",number:1}},children:(0,v.jsx)(Xe,{form:i})})},lt=()=>{const e=(0,p.wA)(),{blocktimeForm:t,disabled_slot_id:l,setViewContent:n}=(0,s.useContext)(u.BookingContext);return(0,v.jsxs)(T.A,{gutter:6,children:[Boolean(l)&&(0,v.jsx)(M.A,{span:2,children:(0,v.jsx)(re.A,{title:"Delete the task",description:"Are you sure to delete this task?",onConfirm:()=>{et.A.delete({"ids[0]":l}).then((()=>{n(""),e((0,y.nP)({perPage:100}))})).catch((e=>{console.log(e)}))},okText:"Yes",cancelText:"No",children:(0,v.jsx)(o.A,{type:"danger",icon:(0,v.jsx)(oe.A,{})})})}),(0,v.jsx)(M.A,{span:Boolean(l)?22:24,children:(0,v.jsx)(o.A,{type:"primary",className:"w-100",onClick:()=>t.submit(),children:(0,d.t)("submit")})})]})};var st=l(31281);const nt=()=>{const e=(0,p.wA)(),{languages:t}=(0,p.d4)((e=>e.formLang)),{setViewContent:l,disabled_slot_id:n,blocktimeForm:i}=(0,s.useContext)(u.BookingContext),[a,o]=(0,s.useState)(!1);function d(e){if(null===e||void 0===e||!e.translations)return{};const{translations:l}=e,s=t.map((e=>{var t,s;return{[`title[${e.locale}]`]:null===(t=l.find((t=>t.locale===e.locale)))||void 0===t?void 0:t.title,[`description[${e.locale}]`]:null===(s=l.find((t=>t.locale===e.locale)))||void 0===s?void 0:s.description}}));return Object.assign({},...s)}return(0,s.useEffect)((()=>{n&&(o(!0),et.A.getById(n).then((e=>{var t,l,s,n,a,o;let{data:r}=e;const u={master_id:{label:`${(null===r||void 0===r||null===(t=r.master)||void 0===t?void 0:t.firstname)||""} ${(null===r||void 0===r||null===(l=r.master)||void 0===l?void 0:l.lastname)||""}`,value:null===r||void 0===r||null===(s=r.master)||void 0===s?void 0:s.id,key:null===r||void 0===r||null===(n=r.master)||void 0===n?void 0:n.id},every:{type:r.custom_repeat_type,number:null===(a=r.custom_repeat_value)||void 0===a?void 0:a[0]},on_days:null===(o=r.custom_repeat_value)||void 0===o?void 0:o.filter(((e,t)=>0!==t)),repeats:r.repeats,end_type:r.end_type,end_value:r.end_value,date:c()(r.date,"YYYY-MM-DD"),end_value_date:"date"===r.end_type?c()(r.end_value.replace(/\"/g,""),"YYYY-MM-DD"):"",from:c()(null===r||void 0===r?void 0:r.from,"HH:mm:ss"),to:c()(null===r||void 0===r?void 0:r.to,"HH:mm:ss"),...d(r)};i.setFieldsValue(u)})).catch((e=>{console.log(e)})).finally((()=>o(!1))))}),[n]),(0,v.jsx)(j.A,{spinning:a,children:(0,v.jsx)(S.A,{form:i,layout:"vertical",onFinish:s=>{var i,a,o,d,r;et.A.update(n,{repeats:s.repeats,end_type:s.end_type,master_id:null===(i=s.master_id)||void 0===i?void 0:i.value,to:c()(s.to).format("HH:mm"),custom_repeat_type:null===(a=s.every)||void 0===a?void 0:a.type,from:c()(s.from).format("HH:mm"),date:c()(s.date).format("YYYY-MM-DD"),end_value:(null===(o=s.end_value)||void 0===o?void 0:o.toString())||s.end_value_date,title:(0,st.A)(t,s),description:(0,st.A)(t,s,"description"),custom_repeat_value:s.on_days&&(null===(d=s.every)||void 0===d?void 0:d.number)&&[null===(r=s.every)||void 0===r?void 0:r.number,...s.on_days]}).then((()=>{l(""),e((0,y.nP)({perPage:100}))})).catch((e=>{console.log(e)}))},children:(0,v.jsx)(Xe,{form:i})})})},it=()=>{const{viewContent:e,setViewContent:t}=(0,s.useContext)(u.BookingContext);return(0,v.jsx)(k,{open:e,setOpen:t,footer:(()=>{switch(e){case"addService":return(0,v.jsx)(he,{});case"updateForm":return(0,v.jsx)(pe,{});case"updateService":return(0,v.jsx)(Se,{});case"blockTime":case"updateBlockTime":return(0,v.jsx)(lt,{});default:return""}})(),children:(0,v.jsxs)(v.Fragment,{children:["addService"!==e&&"serviceForm"!==e&&"blockTime"!==e&&"updateBlockTime"!==e&&(0,v.jsx)($e,{}),(()=>{switch(e){case"addService":return(0,v.jsx)(xe,{});case"serviceForm":return(0,v.jsx)(be,{});case"updateForm":return(0,v.jsx)(J,{});case"updateService":return(0,v.jsx)(ae,{});case"notes":return(0,v.jsx)(Fe,{});case"forms":return(0,v.jsx)(Ve,{});case"activity":return(0,v.jsx)(ze,{});case"blockTime":return(0,v.jsx)(tt,{});case"updateBlockTime":return(0,v.jsx)(nt,{})}})()]})})};var at=l(66136),ot=l(24893),dt=l(25933);const{Title:rt}=O.A,ct=e=>{var t,l,n;let{item:i}=e;const[a]=S.A.useForm(),{service_id:r,setIsAddForm:c,calculatedData:m,setCalculatedData:p}=(0,s.useContext)(u.BookingContext),x=e=>{var t,l,s;switch(e.answer_type){case"single_answer":return(0,v.jsx)(ot.Ay.Group,{children:null===(t=e.answer)||void 0===t?void 0:t.map((e=>(0,v.jsx)(ot.Ay,{value:e,children:e})))});case"short_answer":return(0,v.jsx)(N.A,{});case"long_answer":return(0,v.jsx)(N.A.TextArea,{});case"multiple_choice":return(0,v.jsx)(Re.A.Group,{children:null===(l=e.answer)||void 0===l?void 0:l.map((e=>(0,v.jsx)(Re.A,{value:e,children:e})))});case"drop_down":return(0,v.jsx)(ee.A,{children:null===(s=e.answer)||void 0===s?void 0:s.map((e=>(0,v.jsx)(ee.A.Option,{value:e,children:e})))});case"yes_or_no":return(0,v.jsx)(dt.A,{});default:return""}},j=null===m||void 0===m||null===(t=m.items)||void 0===t?void 0:t.flatMap((e=>e.data.form||[]));return(0,v.jsxs)(h.A,{className:"w-100",children:[(0,v.jsx)(rt,{children:null===i||void 0===i||null===(l=i.translation)||void 0===l?void 0:l.title}),(0,v.jsxs)(S.A,{layout:"vertical",form:a,onFinish:e=>{var t,l;A.A.update(r,{data:{...null===m||void 0===m||null===(t=m.items[0])||void 0===t?void 0:t.data,form:[...j,{...i,data:null===(l=i.data)||void 0===l?void 0:l.map((t=>{const l=e[t.answer_type];return{...t,user_answer:l?"object"===typeof l?l:[l]:void 0}}))}]}}).then((e=>{a.resetFields(),c(!1),p((t=>({...t,items:t.items.map((t=>({...t,data:e.data.data})))})))})).catch((e=>{console.log(e)}))},children:[null===(n=i.data)||void 0===n?void 0:n.map((e=>(0,v.jsx)(v.Fragment,{children:"description_text"===e.answer_type?(0,v.jsx)(Ne.A,{message:e.question,type:"info"}):(0,v.jsx)(S.A.Item,{label:e.question,name:e.answer_type,rules:[{required:Boolean(e.required)}],children:x(e)})}))),(0,v.jsx)(o.A,{className:"mt-4",type:"primary",htmlType:"submit",children:(0,d.t)("complate")})]})]})},ut=()=>{const{isAddForm:e,setIsAddForm:t}=(0,s.useContext)(u.BookingContext),[l,n]=(0,s.useState)([]),[i,o]=(0,s.useState)(null),r=l.map((e=>({key:e.id,label:e.translation.title}))),c=(0,s.useMemo)((()=>l.find((e=>e.id===i))),[i,l]);return(0,s.useEffect)((()=>{at.A.getAll().then((e=>{let{data:t}=e;n(t),o(t[0].id)})).catch((e=>{console.log(e)}))}),[]),(0,v.jsx)(a.A,{centered:!0,width:912,footer:null,visible:e,onCancel:()=>{t(!1)},title:(0,d.t)("select.a.form"),children:(0,v.jsxs)("div",{className:"d-flex gap-2",children:[(0,v.jsx)(Be.A,{style:{width:256},mode:"vertical",items:r,onClick:e=>{let{key:t}=e;return o(Number(t))}}),(0,v.jsx)(ct,{item:c,formList:l})]})})};var vt=l(91524);const mt=()=>{var e,t,l;const{formDetailId:n,setFormDetailId:i,calculatedData:o}=(0,s.useContext)(u.BookingContext),r=null===o||void 0===o||null===(e=o.items)||void 0===e?void 0:e.flatMap((e=>e.data.form||[])).find((e=>e.id===n));return(0,v.jsx)(a.A,{footer:null,visible:n,onCancel:()=>{i(null)},title:(0,d.t)("form.detail"),children:(0,v.jsx)(vt.A,{title:null===r||void 0===r||null===(t=r.translation)||void 0===t?void 0:t.title,layout:"vertical",children:null===r||void 0===r||null===(l=r.data)||void 0===l?void 0:l.map(((e,t)=>{var l,s;return"yes_or_no"===e.answer_type?(0,v.jsx)(vt.A.Item,{label:e.question,span:12,children:null===e||void 0===e||null===(l=e.user_answer)||void 0===l?void 0:l.map((e=>e?(0,d.t)("yes"):(0,d.t)("no")))},t):(0,v.jsx)(vt.A.Item,{label:e.question,span:12,children:null===e||void 0===e||null===(s=e.user_answer)||void 0===s?void 0:s.map((e=>(e.answer_type,(0,v.jsx)("div",{className:"ml-1",children:e}))))},t)}))})})},pt=()=>{const[e]=S.A.useForm(),{updateStatus:t,setUpdateStatus:l,setCalculatedData:n}=(0,s.useContext)(u.BookingContext),i=()=>{l(null),e.resetFields()};return(0,v.jsx)(a.A,{title:(0,d.t)("update.status"),visible:t,onCancel:i,width:280,footer:null,children:(0,v.jsxs)(S.A,{form:e,onFinish:e=>{A.A.changeStatus(t.booking_id,e).then((e=>{let{data:l}=e;i(),n((e=>({...e,items:e.items.map((e=>({...e,status:e.booking_id===t.booking_id?l.status:e.status})))})))})).catch((e=>{console.log(e)}))},layout:"vertical",initialValues:{status:null===t||void 0===t?void 0:t.status},children:[(0,v.jsx)(S.A.Item,{name:"status",rules:[{required:!0}],label:"status",children:(0,v.jsxs)(ee.A,{children:[(0,v.jsx)(ee.A.Option,{value:"new",children:(0,d.t)("new")}),(0,v.jsx)(ee.A.Option,{value:"canceled",children:(0,d.t)("canceled")}),(0,v.jsx)(ee.A.Option,{value:"booked",children:(0,d.t)("booked")}),(0,v.jsx)(ee.A.Option,{value:"progress",children:(0,d.t)("progress")}),(0,v.jsx)(ee.A.Option,{value:"ended",children:(0,d.t)("ended")})]})}),(0,v.jsx)(o.A,{htmlType:"submit",type:"primary",children:(0,d.t)("submit")})]})})},xt=()=>{const e=(0,p.wA)();return(0,s.useEffect)((()=>{e((0,x.Wg)())}),[e]),(0,v.jsxs)(u.default,{children:[(0,v.jsx)(w,{}),(0,v.jsx)(m,{}),(0,v.jsx)(it,{}),(0,v.jsx)(ut,{}),(0,v.jsx)(mt,{}),(0,v.jsx)(pt,{})]})}},53774:(e,t,l)=>{function s(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"$",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"after";const l=Number(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,");return"after"===t?`${l} ${e}`:`${e} ${l}`}l.r(t),l.d(t,{default:()=>s})},63022:(e,t,l)=>{l.r(t),l.d(t,{BookingContext:()=>o,default:()=>d});var s=l(59233),n=l(9950),i=l(42074),a=l(44414);const o=(0,n.createContext)(null),d=e=>{var t;let{children:l}=e,[d]=(0,i.ok)();const r=d.get("service_id"),c=d.get("disabled_slot_id"),[u]=s.A.useForm(),[v]=s.A.useForm(),[m]=s.A.useForm(),[p,x]=(0,n.useState)([]),[h,j]=(0,n.useState)({}),[g,A]=(0,n.useState)({}),[f,y]=(0,n.useState)(!1),[_,b]=(0,n.useState)(null),[w,C]=(0,n.useState)(!1),[k,S]=(0,n.useState)(""),[N,D]=(0,n.useState)(!1),[F,I]=(0,n.useState)(null),[O,T]=(0,n.useState)(null),[M,B]=(0,n.useState)(null),[q,$]=(0,n.useState)(null),Y=null===h||void 0===h||null===(t=h.items)||void 0===t?void 0:t.reduce(((e,t)=>{var l;return e+(null===t||void 0===t||null===(l=t.service_master)||void 0===l?void 0:l.interval)}),0);return(0,a.jsx)(o.Provider,{value:{infoForm:v,serviceForm:u,serviceData:p,setServiceData:x,calculatedData:h,setCalculatedData:j,selectedSlots:_,setSelectedSlots:b,isModalOpen:f,setIsModalOpen:y,isLoalding:w,setIsLoading:C,viewContent:k,setViewContent:S,sumInterval:Y,infoData:g,setInfoData:A,service_id:r,isAddForm:N,setIsAddForm:D,disabled_slot_id:c,blocktimeForm:m,formDetailId:F,setFormDetailId:I,updateStatus:O,setUpdateStatus:T,selectedService:M,setSelectedService:B,selectedMaster:q,setSelectedMaster:$},children:l})}},65820:(e,t,l)=>{l.d(t,{s:()=>a});var s=l(28429),n=l(21215),i=l.n(n);const a=()=>{const e=(0,s.Zp)(),t=(0,s.zy)(),l=i().parse(t.search,{ignoreQueryPrefix:!0});return{values:l,set:(t,s)=>e({search:i().stringify({...l,[t]:s})}),reset:t=>{const s={...l};s[t]&&delete s[t],e({search:i().stringify({...s})})},clear:()=>e({search:i().stringify({})}),merge:t=>e({search:i().stringify({...l,...t})})}}},66136:(e,t,l)=>{l.d(t,{A:()=>n});var s=l(82371);const n={getAll:e=>s.A.get("rest/form-options",{params:e}),getById:e=>s.A.get(`rest/form-options/${e}`)}},78498:(e,t,l)=>{l.d(t,{A:()=>h});var s=l(9950),n=l(97239);const i=l.p+"static/media/pin.0e41858db80c699cd8a2.png";var a=l(96011),o=l.n(a),d=l(63620);async function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.CJ,l={latlng:`${null===e||void 0===e?void 0:e.lat},${null===e||void 0===e?void 0:e.lng}`,key:t};return o().get("https://maps.googleapis.com/maps/api/geocode/json",{params:l}).then((e=>{var t;let{data:l}=e;return null===(t=l.results[0])||void 0===t?void 0:t.formatted_address})).catch((e=>"not found"))}var c=l(39174),u=l(85923),v=l(70030),m=l(6566),p=l(44414);const x=(0,m.A)();const h=(0,n.GoogleApiWrapper)({apiKey:x,libraries:["places","geometry"]})((function(e){var t,l;const[a,o]=(0,s.useState)(),{t:d}=(0,v.B)(),m=async()=>{await navigator.geolocation.getCurrentPosition((function(e){const t={lat:e.coords.latitude,lng:e.coords.longitude};o(t)}),(function(e){u.oR.warning(d("turn.on.gps"))}))};(0,s.useEffect)((()=>{m()}),[]);const h=[{lat:Number(null===e||void 0===e||null===(t=e.location)||void 0===t?void 0:t.lat)||0,lng:Number(null===e||void 0===e||null===(l=e.location)||void 0===l?void 0:l.lng)||0}];for(var j=new e.google.maps.LatLngBounds,g=0;g<h.length;g++)j.extend(h[g]);return(0,p.jsxs)("div",{className:"map-container",style:{height:400,width:"100%"},children:[(0,p.jsx)("button",{className:"map-button",type:"button",onClick:()=>{m(),a&&(async t=>{const l={lat:null===t||void 0===t?void 0:t.lat,lng:null===t||void 0===t?void 0:t.lng};e.setLocation(l);const s=await r(l,x);e.setAddress(s)})(a)},children:(0,p.jsx)(c.uFi,{})}),(0,p.jsx)(n.Map,{cursor:"pointer",onClick:async(t,l,s)=>{const{latLng:n}=s,i={lat:n.lat(),lng:n.lng()};e.setLocation(i);const a=await r(i,x);e.setAddress(a)},google:e.google,defaultZoom:12,zoom:10,className:"clickable",initialCenter:e.location,center:e.location,children:(0,p.jsx)(n.Marker,{position:e.location,icon:{url:i,scaledSize:new e.google.maps.Size(32,32)},className:"marker"})})]})}))},80415:(e,t,l)=>{l.d(t,{G:()=>a,HV:()=>n,LH:()=>s,PR:()=>i,wO:()=>d,xt:()=>o});const s={new:[1,2,3,4,5],accepted:[1,2,3,4,5],ready:[1,2,3,4,5],on_a_way:[1,2,3,4,5],delivered:[1,2,3,4,5],canceled:[1,2,3,4,5],cooking:[1,2,3,4,5]},n=(new Date,new Date,["new","accepted","ready","on_a_way","pause","delivered","canceled"]),i=30,a="HH:mm",o="hh:mm a",d=!0},85023:(e,t,l)=>{l.d(t,{D:()=>o});var s=l(9950),n=l(99674),i=l(90650),a=l(44414);const o=e=>{let{fetchOptions:t,refetch:l=!1,value:o,...d}=e;const[r,c]=(0,s.useState)(!1),[u,v]=(0,s.useState)([]);"object"===typeof(null===o||void 0===o?void 0:o.label)&&null!==(null===o||void 0===o?void 0:o.label)&&(o.label=o.label.value);return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(n.A,{labelInValue:!0,filterOption:!1,notFoundContent:r?(0,a.jsx)(i.A,{size:"small"}):"no results",value:o,...d,options:r?[]:u,onFocus:()=>{u.length&&!l||(c(!0),t().then((e=>{v(e),c(!1)})))},getPopupContainer:e=>e.parentNode})})}}}]);