"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[2182],{2182:(e,i,l)=>{l.r(i),l.d(i,{default:()=>n});l(9950);var a=l(28429),t=l(97792),s=l(44414);const n=()=>{const{id:e}=(0,a.g)();return(0,s.jsx)(t.A,{id:e})}},12196:(e,i,l)=>{l.d(i,{A:()=>j});var a=l(9950),t=l(59233),s=l(72243),n=l(87094),r=l(41988),d=l(80737),m=l(66876),o=l(82706),c=l(48538),u=l(8750),p=l(44070),v=l(48970),h=l(64924),x=l(70030),g=l(44414);const j=e=>{var i;let{mediaList:l,setMediaList:j,name:A="products"}=e;const{t:b}=(0,x.B)(),[f]=t.A.useForm(),[y,w]=(0,a.useState)(null),[N,_]=(0,a.useState)([]),[q,I]=(0,a.useState)(!1),[L,k]=(0,a.useState)(!1),V=async e=>{let{file:i,type:l}=e;i.name?(w("video"===l?(0,g.jsx)("video",{controls:!0,src:i.name,width:450,height:450}):(0,g.jsx)(s.A,{src:i.name,width:"100%",height:450,alt:"preview-img"})),I(!0)):w(null)},F=e=>({uid:e.title,name:e.title,status:"done",url:e.title,created:!0});return(0,g.jsxs)(n.A,{gutter:[24,24],children:[(0,g.jsx)(r.A,{span:24,children:(0,g.jsx)(d.A,{className:"align-items-start",children:(0,g.jsx)(m.A,{customRequest:e=>{let{file:i,onSuccess:l}=e;k(!0);const a=new FormData;a.append("image",i),a.append("type",A),h.A.upload(a).then((e=>{let{data:i}=e;j((e=>({...e,images:[...e.images,{...F(i),isVideo:!0}]}))),l("ok")}))},accept:"video/*",listType:"text",className:"video-upload",multiple:!1,fileList:[],children:(0,g.jsxs)("div",{className:"media-upload",children:[(0,g.jsx)(u.A,{})," ",(0,g.jsx)("span",{children:b("upload.video")})]})})})}),(0,g.jsx)(r.A,{span:24,children:null===l||void 0===l||null===(i=l.previews)||void 0===i?void 0:i.map(((e,i)=>{var a,t;return(0,g.jsxs)(d.A,{className:"uploaded-file",wrap:!0,children:[(0,g.jsx)("span",{className:"media-item",onClick:()=>V({type:"img",file:null===l||void 0===l?void 0:l.previews[i]}),children:null===l||void 0===l||null===(a=l.previews[i])||void 0===a?void 0:a.name}),(0,g.jsx)("span",{className:"media-item",onClick:()=>V({type:"video",file:null===l||void 0===l?void 0:l.images[i]}),children:null===l||void 0===l||null===(t=l.images[i])||void 0===t?void 0:t.name}),(0,g.jsx)(p.A,{className:"delete-media-item",onClick:()=>(e=>{const i=l.images.filter(((i,l)=>{if(l!==e)return i})),a=l.previews.filter(((i,l)=>{if(l!==e)return i}));j({images:i,previews:a})})(i)})]})}))}),(0,g.jsx)(o.A,{title:"Video Preview",visible:q,onCancel:()=>{I(!1)},footer:null,children:y}),(0,g.jsx)(o.A,{title:"Preview image",visible:L,footer:null,onCancel:()=>k(!1),children:(0,g.jsx)(t.A,{form:f,onFinish:()=>{j((e=>({...e,previews:[...e.previews,...N]}))),_([]),k(!1)},layout:"vertical",children:(0,g.jsxs)(n.A,{gutter:[24,24],children:[(0,g.jsx)(r.A,{span:24,children:(0,g.jsx)(t.A.Item,{label:b("preview.image"),name:"preview-image",rules:[{required:!(null!==N&&void 0!==N&&N.length),message:b("required")}],children:(0,g.jsx)(v.A,{type:A,imageList:N,setImageList:_,multiple:!1,text:"upload.image",form:f})})}),(0,g.jsx)(r.A,{span:24,className:"d-flex justify-content-end",children:(0,g.jsx)(c.A,{type:"primary",onClick:()=>f.submit(),children:b("save")})})]})})})]})}},31281:(e,i,l)=>{function a(e,i){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"title";const a=e.map((e=>({[e.locale]:""===i[`${l}[${e.locale}]`]?void 0:i[`${l}[${e.locale}]`]})));return Object.assign({},...a)}l.d(i,{A:()=>a})},97792:(e,i,l)=>{l.d(i,{A:()=>I});var a=l(9950),t=l(91854),s=l(70030),n=l(59233),r=l(23263),d=l(90650),m=l(87094),o=l(41988),c=l(55902),u=l(99674),p=l(40577),v=l(25933),h=l(48538),x=l(28429),g=l(75114),j=l(85923),A=l(31281),b=l(71999),f=l(74623),y=l(74635),w=l(48970),N=l(12196),_=l(44414);const q=[{value:"main",label:(0,y.t)("main")},{value:"standard",label:(0,y.t)("standard")},{value:"main_top_banner",label:(0,y.t)("main_top_banner")},{value:"main_banner",label:(0,y.t)("main_banner")},{value:"main_left_banner",label:(0,y.t)("main_left_banner")},{value:"standard_top_banner",label:(0,y.t)("standard_top_banner")}],I=e=>{var i,l,y;let{id:I}=e;const{t:L}=(0,s.B)(),k=(0,t.wA)(),V=(0,x.Zp)(),[F]=n.A.useForm(),{activeMenu:P}=(0,t.d4)((e=>e.menu),t.bN),{defaultLang:S,languages:$}=(0,t.d4)((e=>e.formLang),t.bN),[C,E]=(0,a.useState)((null===(i=P.data)||void 0===i||null===(l=i.img)||void 0===l?void 0:l.filter((e=>!(null!==e&&void 0!==e&&e.isVideo))))||[]),[M,O]=(0,a.useState)((null===P||void 0===P||null===(y=P.data)||void 0===y?void 0:y.initialMediaFile)||{images:[],previews:[]}),B=(0,a.useMemo)((()=>[{value:"minute",label:L("minute")},{value:"hour",label:L("hour")},{value:"day",label:L("day")},{value:"month",label:L("month")},{value:"year",label:L("year")}]),[]),[z,R]=(0,a.useState)(!1),[K,T]=(0,a.useState)(!1),U=e=>{R(!0);const i="catalog/advert";g.A.create(e).then((e=>{V(`/${i}`),j.oR.success(L("successfully.created")),k((0,f.EK)({...P,nextUrl:i}))})).finally((()=>R(!1)))},D=e=>{R(!0);g.A.update(I,e).then((e=>{V("/catalog/advert"),j.oR.success(L("successfully.updated")),k((0,f.EK)({...P,nextUrl:"catalog/advert"}))})).finally((()=>R(!1)))};function Z(e){if(!e)return{};const{translations:i}=e,l=$.map((e=>{var l,a;return{[`title[${e.locale}]`]:null===(l=i.find((i=>i.locale===e.locale)))||void 0===l?void 0:l.title,[`description[${e.locale}]`]:null===(a=i.find((i=>i.locale===e.locale)))||void 0===a?void 0:a.description}}));return Object.assign({},...l)}const G=e=>e.map((e=>({uid:e.id,name:e.path,url:e.path,isVideo:Boolean(e.preview)}))),H=e=>{const i={images:[],previews:[]},l=e.filter((e=>e.preview)).map((e=>({uid:e.id,name:e.preview,url:e.preview}))),a=e.filter((e=>e.preview)).map((e=>({uid:e.id,name:e.path,url:e.path,isVideo:!0})));return i.previews=l,i.images=a,i};return(0,a.useEffect)((()=>{var e;I&&(e=I,T(!0),g.A.getById(e).then((e=>{let i=e.data;const l={...i,time_type:{value:i.time_type,label:L(i.time_type)},img:G(i.galleries),initialMediaFile:H(e.data.galleries),...Z(i)};E(G(i.galleries).filter((e=>!e.isVideo))),O(H(e.data.galleries)),F.setFieldsValue(l),k((0,f.Ok)({activeMenu:P,data:l}))})).finally((()=>{k((0,f.km)(P)),T(!1)})))}),[I]),K?(0,_.jsx)(r.A,{title:L("edit.ad"),children:(0,_.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,_.jsx)(d.A,{size:"large",className:"py-5"})})}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(r.A,{title:L(I?"edit.ad":"add.ad"),extra:(0,_.jsx)(b.A,{})}),(0,_.jsx)(n.A,{layout:"vertical",form:F,initialValues:{active:!0},onFinish:e=>{var i;const l=M.images.map((e=>e.name)),a=M.previews.map((e=>e.name)),t={...e,images:[...l,...C.map((e=>null===e||void 0===e?void 0:e.name))],previews:a,title:(0,A.A)($,e,"title"),description:(0,A.A)($,e,"description"),active:Number(e.active),time_type:e.time_type.value,type:(null===(i=e.type)||void 0===i?void 0:i.value)||e.type};I?D(t):U(t)},children:(0,_.jsxs)(m.A,{gutter:[24,24],children:[(0,_.jsx)(o.A,{span:12,children:(0,_.jsxs)(r.A,{title:L("basic.info"),className:"h-100",children:[$.map((e=>(0,_.jsx)(n.A.Item,{label:L("name"),name:`title[${e.locale}]`,rules:[{required:e.locale===S,message:L("required")},{validator:(e,i)=>i&&""===(null===i||void 0===i?void 0:i.trim())?Promise.reject(new Error(L("no.empty.space"))):i&&(null===i||void 0===i?void 0:i.length)<2?Promise.reject(new Error(L("min.2.letters"))):Promise.resolve()}],hidden:e.locale!==S,children:(0,_.jsx)(c.A,{maxLength:50})},"title"+e.id))),$.map((e=>(0,_.jsx)(n.A.Item,{label:L("description"),name:`description[${e.locale}]`,rules:[{required:e.locale===S,message:L("required")},{validator:(e,i)=>i&&""===(null===i||void 0===i?void 0:i.trim())?Promise.reject(new Error(L("no.empty.space"))):i&&(null===i||void 0===i?void 0:i.trim().length)<5?Promise.reject(new Error(L("must.be.at.least.5"))):Promise.resolve()}],hidden:e.locale!==S,children:(0,_.jsx)(c.A,{maxLength:150})},"description"+e.locale))),(0,_.jsx)(n.A.Item,{label:L("type"),name:"type",rules:[{required:!0,message:L("required")}],children:(0,_.jsx)(u.A,{labelInValue:!0,filterOption:!1,options:q})})]})}),(0,_.jsx)(o.A,{span:12,children:(0,_.jsxs)(r.A,{title:L("time.and.price"),className:"h-100",children:[(0,_.jsx)(n.A.Item,{label:L("time.type"),name:"time_type",rules:[{required:!0,message:L("required")}],children:(0,_.jsx)(u.A,{labelInValue:!0,filterOption:!1,options:B})}),(0,_.jsx)(n.A.Item,{label:L("time"),name:"time",rules:[{required:!0,message:L("required")},{type:"number",min:0,message:L("must.be.positive")},{type:"number",max:32e3,message:L("must.be.less.than.32000")}],children:(0,_.jsx)(p.A,{className:"w-100"})}),(0,_.jsx)(n.A.Item,{label:L("price"),name:"price",rules:[{required:!0,message:L("required")},{type:"number",max:1e20,message:L("max.length.20")}],children:(0,_.jsx)(p.A,{className:"w-100",min:0})}),(0,_.jsx)(n.A.Item,{label:L("active"),name:"active",valuePropName:"checked",children:(0,_.jsx)(v.A,{})})]})}),(0,_.jsx)(o.A,{span:16,children:(0,_.jsx)(r.A,{title:L("video"),className:"h-100",children:(0,_.jsx)(N.A,{form:F,name:"other",mediaList:M,setMediaList:O})})}),(0,_.jsx)(o.A,{span:8,children:(0,_.jsx)(r.A,{title:L("media"),className:"h-100",children:(0,_.jsx)(n.A.Item,{rules:[{required:!(null!==C&&void 0!==C&&C.length),message:L("required")}],name:"images",children:(0,_.jsx)(w.A,{type:"other",imageList:C,setImageList:E,form:F,multiple:!1})})})}),(0,_.jsx)(o.A,{span:24,className:"d-flex justify-content-end",children:(0,_.jsx)(h.A,{type:"primary",htmlType:"submit",loading:z,children:L("submit")})})]})})]})}}}]);