"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[858],{12196:(e,i,l)=>{l.d(i,{A:()=>g});var s=l(9950),t=l(59233),a=l(72243),n=l(87094),r=l(41988),d=l(80737),o=l(66876),c=l(82706),m=l(48538),u=l(8750),p=l(44070),v=l(48970),h=l(64924),x=l(70030),j=l(44414);const g=e=>{var i;let{mediaList:l,setMediaList:g,name:A="products"}=e;const{t:f}=(0,x.B)(),[b]=t.A.useForm(),[w,y]=(0,s.useState)(null),[N,L]=(0,s.useState)([]),[S,k]=(0,s.useState)(!1),[C,q]=(0,s.useState)(!1),F=async e=>{let{file:i,type:l}=e;i.name?(y("video"===l?(0,j.jsx)("video",{controls:!0,src:i.name,width:450,height:450}):(0,j.jsx)(a.A,{src:i.name,width:"100%",height:450,alt:"preview-img"})),k(!0)):y(null)},P=e=>({uid:e.title,name:e.title,status:"done",url:e.title,created:!0});return(0,j.jsxs)(n.A,{gutter:[24,24],children:[(0,j.jsx)(r.A,{span:24,children:(0,j.jsx)(d.A,{className:"align-items-start",children:(0,j.jsx)(o.A,{customRequest:e=>{let{file:i,onSuccess:l}=e;q(!0);const s=new FormData;s.append("image",i),s.append("type",A),h.A.upload(s).then((e=>{let{data:i}=e;g((e=>({...e,images:[...e.images,{...P(i),isVideo:!0}]}))),l("ok")}))},accept:"video/*",listType:"text",className:"video-upload",multiple:!1,fileList:[],children:(0,j.jsxs)("div",{className:"media-upload",children:[(0,j.jsx)(u.A,{})," ",(0,j.jsx)("span",{children:f("upload.video")})]})})})}),(0,j.jsx)(r.A,{span:24,children:null===l||void 0===l||null===(i=l.previews)||void 0===i?void 0:i.map(((e,i)=>{var s,t;return(0,j.jsxs)(d.A,{className:"uploaded-file",wrap:!0,children:[(0,j.jsx)("span",{className:"media-item",onClick:()=>F({type:"img",file:null===l||void 0===l?void 0:l.previews[i]}),children:null===l||void 0===l||null===(s=l.previews[i])||void 0===s?void 0:s.name}),(0,j.jsx)("span",{className:"media-item",onClick:()=>F({type:"video",file:null===l||void 0===l?void 0:l.images[i]}),children:null===l||void 0===l||null===(t=l.images[i])||void 0===t?void 0:t.name}),(0,j.jsx)(p.A,{className:"delete-media-item",onClick:()=>(e=>{const i=l.images.filter(((i,l)=>{if(l!==e)return i})),s=l.previews.filter(((i,l)=>{if(l!==e)return i}));g({images:i,previews:s})})(i)})]})}))}),(0,j.jsx)(c.A,{title:"Video Preview",visible:S,onCancel:()=>{k(!1)},footer:null,children:w}),(0,j.jsx)(c.A,{title:"Preview image",visible:C,footer:null,onCancel:()=>q(!1),children:(0,j.jsx)(t.A,{form:b,onFinish:()=>{g((e=>({...e,previews:[...e.previews,...N]}))),L([]),q(!1)},layout:"vertical",children:(0,j.jsxs)(n.A,{gutter:[24,24],children:[(0,j.jsx)(r.A,{span:24,children:(0,j.jsx)(t.A.Item,{label:f("preview.image"),name:"preview-image",rules:[{required:!(null!==N&&void 0!==N&&N.length),message:f("required")}],children:(0,j.jsx)(v.A,{type:A,imageList:N,setImageList:L,multiple:!1,text:"upload.image",form:b})})}),(0,j.jsx)(r.A,{span:24,className:"d-flex justify-content-end",children:(0,j.jsx)(m.A,{type:"primary",onClick:()=>b.submit(),children:f("save")})})]})})})]})}},31281:(e,i,l)=>{function s(e,i){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"title";const s=e.map((e=>({[e.locale]:""===i[`${l}[${e.locale}]`]?void 0:i[`${l}[${e.locale}]`]})));return Object.assign({},...s)}l.d(i,{A:()=>s})},40858:(e,i,l)=>{l.r(i),l.d(i,{default:()=>j});var s=l(9950),t=l(28429),a=l(85923),n=l(59233),r=l(23263),d=l(91854),o=l(74623),c=l(5386),m=l(5302),u=l(70030),p=l(31281),v=l(71999),h=l(82035),x=l(44414);const j=()=>{const{t:e}=(0,u.B)(),{activeMenu:i}=(0,d.d4)((e=>e.menu),d.bN),l=(0,d.wA)(),[j]=n.A.useForm(),g=(0,t.Zp)(),{languages:A}=(0,d.d4)((e=>e.formLang),d.bN);(0,s.useEffect)((()=>()=>{const e=j.getFieldsValue(!0);l((0,o.Ok)({activeMenu:i,data:e}))}),[]);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(r.A,{title:e("add.banner"),extra:(0,x.jsx)(v.A,{})}),(0,x.jsx)(h.A,{form:j,handleSubmit:(s,t,n)=>{var r;const u=n.images.map((e=>e.name)),v=n.previews.map((e=>e.name)),h={products:null===(r=s.products)||void 0===r?void 0:r.map((e=>e.value)),images:[...u,...t.map((e=>e.name))],previews:v,clickable:!0,title:(0,p.A)(A,s,"title"),description:(0,p.A)(A,s,"description")},x="banners";return m.A.create(h).then((()=>{a.oR.success(e("successfully.created")),(0,d.vA)((()=>{l((0,o.EK)({...i,nextUrl:x})),l((0,c.s)({}))})),g(`/${x}`)}))}})]})}},47992:(e,i,l)=>{l.d(i,{G:()=>o});var s=l(9950),t=l(95491),a=l.n(t),n=l(99674),r=l(90650),d=l(44414);const o=e=>{let{fetchOptions:i,debounceTimeout:l=400,onClear:t,refetchOptions:o=!1,...c}=e;const[m,u]=(0,s.useState)(!1),[p,v]=(0,s.useState)([]),h=(0,s.useMemo)((()=>a()((e=>{v([]),u(!0),i(e).then((e=>{v(e),u(!1)}))}),l)),[i,l]);return(0,d.jsx)(n.A,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:h,onClear:()=>{h(""),t&&t()},notFoundContent:m?(0,d.jsx)(r.A,{size:"small"}):"no results",...c,options:p,onFocus:()=>{p.length&&!o||h("")}})}},82035:(e,i,l)=>{l.d(i,{A:()=>j});var s=l(9950),t=l(59233),a=l(87094),n=l(41988),r=l(23263),d=l(55902),o=l(48538),c=l(47992),m=l(48970),u=l(70030),p=l(91854),v=l(47933),h=l(12196),x=l(44414);function j(e){var i,l;let{form:j,handleSubmit:g}=e;const{t:A}=(0,u.B)(),{activeMenu:f}=(0,p.d4)((e=>e.menu),p.bN),{languages:b,defaultLang:w}=(0,p.d4)((e=>e.formLang),p.bN),[y,N]=(0,s.useState)((null===(i=f.data)||void 0===i?void 0:i.img.filter((e=>!e.isVideo)))||[]),[L,S]=(0,s.useState)(!1),[k,C]=(0,s.useState)((null===f||void 0===f||null===(l=f.data)||void 0===l?void 0:l.initialMediaFile)||{images:[],previews:[]});return(0,x.jsx)(t.A,{name:"banner-form",layout:"vertical",onFinish:e=>{S(!0),g(e,y,k).finally((()=>S(!1)))},form:j,initialValues:{clickable:!0,...f.data},className:"d-flex flex-column h-100",children:(0,x.jsxs)(a.A,{gutter:[24,24],children:[(0,x.jsx)(n.A,{span:16,children:(0,x.jsxs)(a.A,{gutter:[24,24],children:[(0,x.jsx)(n.A,{span:24,children:(0,x.jsx)(r.A,{title:A("images"),className:"h-100",children:(0,x.jsx)(t.A.Item,{rules:[{required:!y.length,message:A("required")}],label:A("image"),name:"images",children:(0,x.jsx)(m.A,{type:"banners",imageList:y,setImageList:N,form:j,length:"1",multiple:!1})})})}),(0,x.jsx)(n.A,{span:24,children:(0,x.jsx)(r.A,{title:A("video"),className:"h-100",children:(0,x.jsx)(h.A,{name:"banners",form:j,mediaList:k,setMediaList:C})})})]})}),(0,x.jsx)(n.A,{span:8,children:(0,x.jsxs)(r.A,{title:A("basic.info"),className:"h-100",children:[b.map((e=>(0,x.jsx)(t.A.Item,{label:A("title"),name:`title[${e.locale}]`,rules:[{required:e.locale===w,message:A("required")},{validator:(e,i)=>i&&""===(null===i||void 0===i?void 0:i.trim())?Promise.reject(new Error(A("no.empty.space"))):i&&(null===i||void 0===i?void 0:i.trim().length)<2?Promise.reject(new Error(A("must.be.at.least.2"))):Promise.resolve()}],hidden:e.locale!==w,children:(0,x.jsx)(d.A,{maxLength:50})},"title"+e.locale))),b.map((e=>(0,x.jsx)(t.A.Item,{label:A("description"),name:`description[${e.locale}]`,rules:[{required:e.locale===w,message:A("required")},{validator:(e,i)=>i&&""===(null===i||void 0===i?void 0:i.trim())?Promise.reject(new Error(A("no.empty.space"))):i&&(null===i||void 0===i?void 0:i.trim().length)<5?Promise.reject(new Error(A("must.be.at.least.5"))):Promise.resolve()}],hidden:e.locale!==w,children:(0,x.jsx)(d.A.TextArea,{maxLength:150})},"description"+e.locale))),(0,x.jsx)(t.A.Item,{label:A("products"),name:"products",rules:[{required:!0,message:A("required")}],children:(0,x.jsx)(c.G,{mode:"multiple",fetchOptions:function(e){const i={search:e,perPage:10,status:"published"};return v.A.getAll(i).then((e=>e.data.map((e=>{var i;return{label:null===e||void 0===e||null===(i=e.translation)||void 0===i?void 0:i.title,value:e.id,key:e.id}}))))},debounceTimeout:200})})]})}),(0,x.jsx)(n.A,{span:24,children:(0,x.jsx)("div",{className:"d-flex justify-content-end",children:(0,x.jsx)("div",{className:"pb-5",children:(0,x.jsx)(o.A,{type:"primary",htmlType:"submit",loading:L,children:A("submit")})})})})]})})}}}]);