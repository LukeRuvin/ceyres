"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[3093],{23093:(e,t,l)=>{l.r(t),l.d(t,{default:()=>_});var i=l(9950),r=l(59233),a=l(23263),n=l(87094),s=l(41988),d=l(55902),o=l(99674),c=l(25933),u=l(48538),v=l(90650),m=l(85923),p=l(28429),h=l(71999),y=l(98591),g=l(91854),j=l(74623),A=l(62572),x=l(70030),f=l(48970),b=l(66133),w=l(27276),k=l(44414);const _=()=>{var e,t;const{t:l}=(0,x.B)(),_=(0,p.Zp)(),I=(0,g.wA)(),{activeMenu:P}=(0,g.d4)((e=>e.menu),g.bN),{state:E}=(0,p.zy)(),[S,$]=(0,i.useState)(!1),[q,F]=(0,i.useState)("service"),[z,L]=(0,i.useState)(null!==(e=P.data)&&void 0!==e&&e.image?[null===(t=P.data)||void 0===t?void 0:t.image]:[]),[N]=r.A.useForm(),[C,O]=(0,i.useState)(!1),[V,B]=(0,i.useState)(null),{uuid:D}=(0,p.g)(),{defaultLang:M,languages:U}=(0,g.d4)((e=>e.formLang),g.bN);(0,i.useEffect)((()=>()=>{const e=N.getFieldsValue(!0);I((0,j.Ok)({activeMenu:P,data:e}))}),[]);const K=e=>({name:e,url:e});function R(e){if(!e)return{};const{translations:t}=e,l=U.map((e=>{var l,i;return{[`title[${e.locale}]`]:null===(l=t.find((t=>t.locale===e.locale)))||void 0===l?void 0:l.title,[`description[${e.locale}]`]:null===(i=t.find((t=>t.locale===e.locale)))||void 0===i?void 0:i.description}}));return Object.assign({},...l)}(0,i.useEffect)((()=>{var e;P.refetch&&(e=D,$(!0),A.A.getById(e).then((e=>{var t,l;let i=e.data;const r={...i,...R(i),image:[K(i.img)],keywords:i.keywords.split(","),parent_id:{label:null===(t=i.parent)||void 0===t||null===(l=t.translation)||void 0===l?void 0:l.title,value:i.parent_id,key:i.parent_id}};N.setFieldsValue(r),L([K(i.img)])})).finally((()=>{$(!1),I((0,j.km)(P))})))}),[P.refetch]);return(0,k.jsx)(a.A,{title:l("category.clone"),extra:(0,k.jsx)(h.A,{}),children:S?(0,k.jsx)("div",{className:"d-flex justify-content-center align-items-center py-5",children:(0,k.jsx)(v.A,{size:"large",className:"mt-5 pt-5"})}):(0,k.jsxs)(r.A,{name:"basic",layout:"vertical",onFinish:e=>{var t,i,r;O(!0);const a={...e,type:null!==(t=e.parent_id)&&void 0!==t&&t.value?q:"main",active:e.active?1:0,keywords:e.keywords.join(","),parent_id:null===(i=e.parent_id)||void 0===i?void 0:i.value,"images[0]":null===(r=z[0])||void 0===r?void 0:r.name},n=null!==E&&void 0!==E&&E.parentId?`service-category/${E.parentUuid}`:"catalog/service-categories";A.A.create(a).then((()=>{m.oR.success(l("successfully.updated")),I((0,j.EK)({...P,nextUrl:n})),I((0,b.Y)({type:null!==E&&void 0!==E&&E.parentId?"sub_service":"service",parent_id:null===E||void 0===E?void 0:E.parentId})),_(`/${n}`)})).catch((e=>B(e.response.data.params))).finally((()=>O(!1)))},initialValues:{parent_id:{title:"---",value:0,key:0},active:!0,...P.data},form:N,children:[(0,k.jsxs)(n.A,{gutter:12,children:[(0,k.jsx)(s.A,{span:12,children:U.map(((e,t)=>(0,k.jsx)(r.A.Item,{label:l("name"),name:`title[${e.locale}]`,help:V&&V[`title.${M}`]?V[`title.${M}`][0]:null,validateStatus:V?"error":"success",rules:[{validator:(t,i)=>i||(null===e||void 0===e?void 0:e.locale)!==M?i&&""===(null===i||void 0===i?void 0:i.trim())?Promise.reject(new Error(l("no.empty.space"))):i&&(null===i||void 0===i?void 0:i.trim().length)<2?Promise.reject(new Error(l("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(l("required")))}],hidden:e.locale!==M,children:(0,k.jsx)(d.A,{})},e.title+t)))}),(0,k.jsx)(s.A,{span:12,children:U.map(((e,t)=>(0,k.jsx)(r.A.Item,{label:l("description"),name:`description[${e.locale}]`,rules:[{validator:(t,i)=>i||(null===e||void 0===e?void 0:e.locale)!==M?i&&""===(null===i||void 0===i?void 0:i.trim())?Promise.reject(new Error(l("no.empty.space"))):i&&(null===i||void 0===i?void 0:i.trim().length)<5?Promise.reject(new Error(l("must.be.at.least.5"))):Promise.resolve():Promise.reject(new Error(l("required")))}],hidden:e.locale!==M,children:(0,k.jsx)(y.A,{rows:4})},e.locale+t)))}),(0,k.jsx)(s.A,{span:12,children:(0,k.jsx)(r.A.Item,{label:l("keywords"),name:"keywords",rules:[{required:!0,message:l("required")}],children:(0,k.jsx)(o.A,{mode:"tags",style:{width:"100%"}})})}),!(null!==E&&void 0!==E&&E.parentId)&&(0,k.jsx)(s.A,{span:12,children:(0,k.jsx)(r.A.Item,{label:l("parent.category"),name:"parent_id",rules:[{required:!1,message:l("required")}],children:(0,k.jsx)(w.v,{refetch:!0,fetchOptions:async function(){return A.A.getAll({perPage:100,type:"service"}).then((e=>e.data.map((e=>{var t,l;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id,key:e.id,type:"service",children:null===(l=e.children)||void 0===l?void 0:l.map((e=>{var t,l;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id,key:e.id,type:"sub_service",disabled:"child_service"===e.type,children:null===(l=e.children)||void 0===l?void 0:l.map((e=>{var t;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id,key:e.id,disabled:!0,type:"child_service"}}))}}))}}))))},onSelect:(e,t,l)=>{const{type:i}=t||{};F("service"===i?"sub_service":"sub_service"===i?"child_service":"service")},allowClear:!0})})}),(0,k.jsx)(s.A,{span:4,children:(0,k.jsx)(r.A.Item,{label:l("image"),name:"images",rules:[{validator:()=>0===(null===z||void 0===z?void 0:z.length)?Promise.reject(new Error(l("required"))):Promise.resolve()}],children:(0,k.jsx)(f.A,{type:"categories",imageList:z,setImageList:L,form:N,multiple:!1})})}),(0,k.jsx)(s.A,{span:2,children:(0,k.jsx)(r.A.Item,{label:l("active"),name:"active",valuePropName:"checked",children:(0,k.jsx)(c.A,{})})})]}),(0,k.jsx)(u.A,{type:"primary",htmlType:"submit",loading:C,children:l("submit")})]})})}},27276:(e,t,l)=>{l.d(t,{v:()=>s});var i=l(9950),r=l(90777),a=l(90650),n=l(44414);const s=e=>{let{fetchOptions:t,refetch:l=!1,...s}=e;const[d,o]=(0,i.useState)(!1),[c,u]=(0,i.useState)([]);return(0,n.jsx)(r.A,{treeLine:!0,treeData:d?[]:c,treeDefaultExpandAll:!0,labelInValue:!0,onFocus:()=>{c.length&&!l||(o(!0),t().then((e=>{u(e),o(!1)})))},notFoundContent:d?(0,n.jsx)(a.A,{size:"small"}):"no results",...s})}}}]);