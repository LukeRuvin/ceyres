"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[856],{8168:(e,l,n)=>{function t(e){switch(e){case"ascend":return"asc";case"descend":return"desc"}}n.d(l,{A:()=>t})},8297:(e,l,n)=>{n.d(l,{A:()=>o});var t=n(9950),a=n(55902),s=n(41397),i=n(60767),d=n(44414);function o(e){let{handleChange:l,defaultValue:n,resetSearch:o,...r}=e;const[c,u]=(0,t.useState)(n),v=(0,t.useMemo)((()=>(0,s.debounce)((e=>{l(e)}),800)),[]);return(0,t.useEffect)((()=>{u(n)}),[o]),(0,d.jsx)(a.A,{value:c,onChange:e=>{u(e.target.value),v(e.target.value)},prefix:(0,d.jsx)(i.A,{}),...r})}},13700:(e,l,n)=>{n.d(l,{A:()=>o});var t=n(89379),a=n(9950);const s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"};var i=n(25085),d=function(e,l){return a.createElement(i.A,(0,t.A)((0,t.A)({},e),{},{ref:l,icon:s}))};const o=a.forwardRef(d)},28645:(e,l,n)=>{n.d(l,{A:()=>p});var t=n(9950),a=n(66362),s=n(69216),i=n(80737),d=n(25933),o=n(57811),r=n(81541),c=n(48538),u=n(89323),v=n(70030),h=n(44414);const{Text:m}=a.A,p=e=>{let{columns:l=[],setColumns:n,style:a,size:p="",iconOnly:x}=e;const{t:j}=(0,v.B)(),[A,f]=(0,t.useState)(!1),g=(0,h.jsx)(s.A,{children:null===l||void 0===l?void 0:l.map(((e,t)=>(0,h.jsx)(s.A.Item,{children:(0,h.jsxs)(i.A,{className:"d-flex justify-content-between",children:[(0,h.jsx)(m,{children:e.title}),(0,h.jsx)(d.A,{defaultChecked:!0,onClick:()=>function(e){const t=null===l||void 0===l?void 0:l.map((l=>(l.dataIndex===e.dataIndex&&(l.is_show=!(null!==l&&void 0!==l&&l.is_show)),l)));n(t)}(e),disabled:1===t})]})},e+t)))});return(0,h.jsx)(o.A,{overlay:g,trigger:["click"],onVisibleChange:e=>{f(e)},visible:A,children:(0,h.jsx)(r.A,{title:j("change.columns"),children:(0,h.jsx)(c.A,{style:{...a},size:p,icon:(0,h.jsx)(u.A,{}),children:x?null:j("Columns")})})})}},29597:(e,l,n)=>{function t(e){var l;if(null===e||void 0===e||!e.location)return{lat:47.4143302506288,lng:8.532059477976883};const n=null===e||void 0===e||null===(l=e.location)||void 0===l?void 0:l.split(", ");return{lat:Number(null===n||void 0===n?void 0:n[0]),lng:Number(null===n||void 0===n?void 0:n[1])}}n.d(l,{A:()=>t})},35116:(e,l,n)=>{n.d(l,{A:()=>r});n(9950);var t=n(48538),a=n(44070),s=n(85923),i=n(70030),d=n(13311),o=n(44414);function r(e){let{size:l="",onClick:n,type:r="default",...c}=e;const{t:u}=(0,i.B)(),{isDemo:v}=(0,d.A)();return(0,o.jsx)(t.A,{size:l,icon:(0,o.jsx)(a.A,{}),onClick:e=>{v?s.oR.warning(u("cannot.work.demo")):n(e)},type:r,...c})}},41478:(e,l,n)=>{e.exports=n.p+"static/media/user.fbe7078c52acde79652d.jpg"},47992:(e,l,n)=>{n.d(l,{G:()=>r});var t=n(9950),a=n(95491),s=n.n(a),i=n(99674),d=n(90650),o=n(44414);const r=e=>{let{fetchOptions:l,debounceTimeout:n=400,onClear:a,refetchOptions:r=!1,...c}=e;const[u,v]=(0,t.useState)(!1),[h,m]=(0,t.useState)([]),p=(0,t.useMemo)((()=>s()((e=>{m([]),v(!0),l(e).then((e=>{m(e),v(!1)}))}),n)),[l,n]);return(0,o.jsx)(i.A,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:p,onClear:()=>{p(""),a&&a()},notFoundContent:u?(0,o.jsx)(d.A,{size:"small"}):"no results",...c,options:h,onFocus:()=>{h.length&&!r||p("")}})}},51066:(e,l,n)=>{n.d(l,{Q:()=>s});var t=n(17706),a=n(80415);const s=()=>{var e,l,n,s;return null!==(e=null===(l=t.M.getState())||void 0===l||null===(n=l.globalSettings)||void 0===n||null===(s=n.settings)||void 0===s?void 0:s.hour_format)&&void 0!==e?e:a.G}},53387:(e,l,n)=>{n.d(l,{A:()=>o});var t=n(89379),a=n(9950);const s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"};var i=n(25085),d=function(e,l){return a.createElement(i.A,(0,t.A)((0,t.A)({},e),{},{ref:l,icon:s}))};const o=a.forwardRef(d)},53774:(e,l,n)=>{function t(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"$",l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"after";const n=Number(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,");return"after"===l?`${n} ${e}`:`${e} ${n}`}n.r(l),n.d(l,{default:()=>t})},60856:(e,l,n)=>{n.r(l),n.d(l,{default:()=>Ce});var t=n(9950),a=n(54909),s=n(86971),i=n(12916),d=n(48538),o=n(80737),r=n(23263),c=n(81541),u=n(52913),v=n(28429),h=n(24513),m=n(12678),p=n(44070),x=n(53387),j=n(13700),A=n(91854),f=n(74623),g=n(70030),y=n(88986),b=n(53177),w=n(33824),_=n(8168),C=n(8297),k=n(51242),S=n(47992),I=n(53271),M=n(28645),z=n(85923),H=n(35116),V=n(19689),Y=n(55386),D=n(76083),N=n(59051),P=n.n(N),B=n(63620),$=n(39174),O=n(38525),F=n(65820),R=n(59233),E=n(82706),G=n(87094),L=n(41988),T=n(99674),q=n(44414);function Q(e){let{orderDetails:l,handleCancel:n,status:a}=e;const{activeMenu:s}=(0,A.d4)((e=>e.menu),A.bN),[i]=R.A.useForm(),o=(0,A.wA)(),{t:r}=(0,g.B)(),[c,u]=(0,t.useState)(!1),[v,h]=(0,t.useState)(a);(0,t.useEffect)((()=>{const e=a.findIndex((e=>e.name===l.status));let n=[a[e],a[e+1],{name:"canceled",id:8,active:!0}];e<0&&(n=[a[e+1],"canceled"]),h(n)}),[l]);return(0,q.jsx)(E.A,{visible:!!l,title:l.title,onCancel:n,footer:[(0,q.jsx)(d.A,{type:"primary",onClick:()=>i.submit(),loading:c,children:r("save")},"save-form"),(0,q.jsx)(d.A,{type:"default",onClick:n,children:r("cancel")},"cansel-modal")],children:(0,q.jsx)(R.A,{form:i,layout:"vertical",onFinish:e=>{u(!0);const t={...e};V.A.updateStatus(l.id,t).then((()=>{n(),o((0,f.Ms)(s))})).finally((()=>u(!1)))},initialValues:{status:l.status},children:(0,q.jsx)(G.A,{gutter:12,children:(0,q.jsx)(L.A,{span:24,children:(0,q.jsx)(R.A.Item,{label:r("status"),name:"status",rules:[{required:!0,message:r("required")}],children:(0,q.jsx)(T.A,{children:null===v||void 0===v?void 0:v.map((e=>(0,q.jsx)(T.A.Option,{value:null===e||void 0===e?void 0:e.name,children:r(null===e||void 0===e?void 0:e.name)},null===e||void 0===e?void 0:e.name)))})})})})})})}var K=n(86366),U=n(69286),Z=n(81446),W=n(50384),X=n(41478),J=n(73631),ee=n(29597),le=n(47965),ne=n(89379);const te={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M688 312v-48c0-4.4-3.6-8-8-8H296c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8zm-392 88c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H296zm376 116c-119.3 0-216 96.7-216 216s96.7 216 216 216 216-96.7 216-216-96.7-216-216-216zm107.5 323.5C750.8 868.2 712.6 884 672 884s-78.8-15.8-107.5-44.5C535.8 810.8 520 772.6 520 732s15.8-78.8 44.5-107.5C593.2 595.8 631.4 580 672 580s78.8 15.8 107.5 44.5C808.2 653.2 824 691.4 824 732s-15.8 78.8-44.5 107.5zM761 656h-44.3c-2.6 0-5 1.2-6.5 3.3l-63.5 87.8-23.1-31.9a7.92 7.92 0 00-6.5-3.3H573c-6.5 0-10.3 7.4-6.5 12.7l73.8 102.1c3.2 4.4 9.7 4.4 12.9 0l114.2-158c3.9-5.3.1-12.7-6.4-12.7zM440 852H208V148h560v344c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V108c0-17.7-14.3-32-32-32H168c-17.7 0-32 14.3-32 32v784c0 17.7 14.3 32 32 32h272c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"file-done",theme:"outlined"};var ae=n(25085),se=function(e,l){return t.createElement(ae.A,(0,ne.A)((0,ne.A)({},e),{},{ref:l,icon:te}))};const ie=t.forwardRef(se);var de=n(6604),oe=n(68873),re=n(51066);function ce(e){return e?P()(e).format(`DD-MM-YYYY, ${(0,re.Q)()}`):""}const{Step:ue}=K.A,ve=()=>(0,q.jsx)("div",{style:{position:"absolute",transform:"translate(-50%, -100%)"},children:(0,q.jsx)("img",{src:X,width:"50",alt:"Pin"})}),he=()=>(0,q.jsx)("div",{style:{position:"absolute",transform:"translate(-50%, -100%)"},children:(0,q.jsx)("img",{src:J,width:"50",alt:"Pin"})}),me=["blue","red","gold","volcano","cyan","lime"],pe=e=>{var l,n,a,s,o,c;let{id:u,handleCancel:v}=e;const{t:h}=(0,g.B)(),[m,p]=(0,t.useState)(null),[x,j]=(0,t.useState)(null),[f,y]=(0,t.useState)(null),{settings:b}=(0,A.d4)((e=>e.globalSettings),A.bN),w=(0,ee.A)(b),[_,C]=(0,t.useState)(0),[k,S]=(0,t.useState)((0,ee.A)(b)),[I,M]=(0,t.useState)((0,ee.A)(b)),[z,H]=(0,t.useState)([{id:0,name:"new",icon:(0,q.jsx)(le.A,{})},{id:1,name:"accepted",icon:(0,q.jsx)(ie,{})},{id:3,name:"ready",icon:(0,q.jsx)(W.LW,{})},{id:4,name:"on_a_way",icon:(0,q.jsx)(W.vBC,{})},{id:5,name:"delivered",icon:(0,q.jsx)(de.eDZ,{})}]);const{google_map_key:Y}=(0,A.d4)((e=>e.globalSettings.settings),A.bN);(0,t.useEffect)((()=>{p(!0),V.A.getById(u).then((e=>{var l;let{data:n}=e;H("canceled"===n.status?[{id:1,name:"new",icon:(0,q.jsx)(le.A,{})},{id:5,name:"canceled",icon:(0,q.jsx)(oe.XfH,{})}]:z),C("canceled"===n.status?1:null===(l=z.find((e=>e.name===n.status)))||void 0===l?void 0:l.id),y("canceled"===n.status?"error":"success"),j(n),M({lat:n.address_from.latitude,lng:n.address_from.longitude}),S({lat:n.address_to.latitude,lng:n.address_to.longitude})})).finally((()=>{p(!1)}))}),[]);return(0,q.jsx)(q.Fragment,{children:(0,q.jsx)(E.A,{visible:!!u,title:h("show.locations"),onCancel:()=>v(),style:{minWidth:"80vw"},footer:[(0,q.jsx)(d.A,{type:"default",onClick:v,children:h("cancel")},"cancelBtn")],children:m?(0,q.jsx)(Z.A,{}):(0,q.jsxs)(r.A,{children:[(0,q.jsx)(K.A,{current:_,status:f,className:"mb-5",children:null===z||void 0===z?void 0:z.map(((e,l)=>(0,q.jsx)(ue,{title:h(e.name),icon:null===e||void 0===e?void 0:e.icon},e.id+l)))}),(0,q.jsxs)(G.A,{gutter:12,children:[(0,q.jsxs)(L.A,{span:12,children:[(0,q.jsxs)("h3",{children:[h("order.id")," #",null===x||void 0===x?void 0:x.id]}),(0,q.jsxs)("p",{children:[(0,q.jsx)(W.A5h,{})," ",ce(null===x||void 0===x?void 0:x.created_at)]}),(0,q.jsxs)("p",{children:[h("delivery.time"),": ",ce(null===x||void 0===x?void 0:x.delivery_date)]}),(0,q.jsxs)("span",{children:[(0,q.jsx)("strong",{children:null===x||void 0===x||null===(l=x.shop)||void 0===l||null===(n=l.translation)||void 0===n?void 0:n.title})," ",null===x||void 0===x||null===(a=x.details)||void 0===a?void 0:a.map(((e,l)=>{var n;return(0,q.jsx)(i.A,{color:me[l],children:null===e||void 0===e||null===(n=e.stock)||void 0===n?void 0:n.product.translation.title})}))]})]}),(0,q.jsxs)(L.A,{span:12,children:[(0,q.jsxs)("p",{children:[h("status"),": ","new"===(null===x||void 0===x?void 0:x.status)?(0,q.jsx)(i.A,{color:"blue",children:h(null===x||void 0===x?void 0:x.status)}):"canceled"===(null===x||void 0===x?void 0:x.status)?(0,q.jsx)(i.A,{color:"error",children:h(null===x||void 0===x?void 0:x.status)}):(0,q.jsx)(i.A,{color:"cyan",children:h(null===x||void 0===x?void 0:x.status)})]}),(0,q.jsxs)("p",{children:[h("order.type"),": ",(0,q.jsx)("strong",{children:h("parcel")})]}),(0,q.jsxs)("p",{children:[h("payment.method"),": ",(0,q.jsx)("strong",{children:null===x||void 0===x||null===(s=x.transaction)||void 0===s||null===(o=s.payment_system)||void 0===o?void 0:o.tag})]}),(0,q.jsxs)("p",{children:[h("payment.status"),": ",(0,q.jsx)("strong",{children:null===x||void 0===x||null===(c=x.transaction)||void 0===c?void 0:c.status})]})]}),(0,q.jsxs)(L.A,{span:24,className:"mt-5",children:[(0,q.jsx)("h4",{children:h("map")}),(0,q.jsx)("div",{className:"map-container",style:{height:400,width:"100%"},children:(0,q.jsxs)(U.Ay,{bootstrapURLKeys:{key:B.CJ||Y},defaultZoom:15,center:w,yesIWantToUseGoogleMapApiInternals:!0,options:{fullscreenControl:!1},onGoogleApiLoaded:e=>{let{map:l,maps:n}=e;const t=[k,I].map((e=>({lat:Number(e.lat||"0"),lng:Number(e.lng||"0")})));let a=new n.LatLngBounds;for(var s=0;s<t.length;s++)a.extend(t[s]);l.fitBounds(a)},children:[(0,q.jsx)(he,{lat:null===k||void 0===k?void 0:k.lat,lng:null===k||void 0===k?void 0:k.lng}),(0,q.jsx)(ve,{lat:null===I||void 0===I?void 0:I.lat,lng:null===I||void 0===I?void 0:I.lng})]})})]})]})]})})})};var xe=n(91524),je=n(53774);const Ae=["paid","canceled"];function fe(e){var l;let{data:n,handleCancel:a,fetchParcelDetails:s}=e;const[i]=R.A.useForm(),{t:o}=(0,g.B)(),[r,c]=(0,t.useState)(!1);return(0,q.jsx)(E.A,{visible:!!n,title:o("transaction.status"),closable:!1,footer:[(0,q.jsx)(d.A,{type:"primary",onClick:()=>i.submit(),loading:r,children:o("save")},"save-form"),(0,q.jsx)(d.A,{type:"default",onClick:a,children:o("cancel")},"cansel-modal")],children:(0,q.jsx)(R.A,{form:i,layout:"vertical",onFinish:e=>{c(!0),V.A.transactionStatus(null===n||void 0===n?void 0:n.id,e).then((()=>{a(),s()})).catch((e=>z.oR.error(e.message))).finally((()=>c(!1)))},initialValues:{status:null===n||void 0===n||null===(l=n.transaction)||void 0===l?void 0:l.status},children:(0,q.jsx)(G.A,{gutter:12,children:(0,q.jsx)(L.A,{span:24,children:(0,q.jsx)(R.A.Item,{label:o("status"),name:"status",rules:[{validator:(e,l)=>"paid"===l||"canceled"===l?Promise.resolve():Promise.reject(new Error(o("required")))}],children:(0,q.jsx)(T.A,{children:Ae.map(((e,l)=>(0,q.jsx)(T.A.Option,{value:e,children:o(e)},l)))})})})})})})}const ge=e=>{var l,n,a,s,i,o,r,c,u,v,m,p,x;let{id:j,handleCancel:A}=e;const{t:f}=(0,g.B)(),[y,b]=(0,t.useState)(null),[w,_]=(0,t.useState)(null),[C,k]=(0,t.useState)(!1),S=(0,re.Q)();function I(){b(!0),V.A.getById(j).then((e=>{let{data:l}=e;_(l)})).finally((()=>{b(!1)}))}return(0,t.useEffect)((()=>{I()}),[]),(0,q.jsx)(q.Fragment,{children:(0,q.jsx)(E.A,{visible:!!j,title:`${f("parcel.id")} #${j}`,onCancel:()=>A(),footer:[(0,q.jsx)(d.A,{type:"default",onClick:A,children:f("cancel")},"cancelBtn")],className:"large-modal",children:y?(0,q.jsx)(Z.A,{}):(0,q.jsxs)(q.Fragment,{children:[(0,q.jsxs)(G.A,{gutter:24,children:[(0,q.jsx)(L.A,{span:12,children:(0,q.jsxs)(xe.A,{title:f("sender.details"),bordered:!0,children:[(0,q.jsx)(xe.A.Item,{label:f("username"),span:3,children:null===w||void 0===w?void 0:w.username_from}),(0,q.jsx)(xe.A.Item,{label:f("phone"),span:3,children:null===w||void 0===w?void 0:w.phone_from}),(0,q.jsx)(xe.A.Item,{label:f("address"),span:3,children:null===w||void 0===w||null===(l=w.address_from)||void 0===l?void 0:l.address}),(0,q.jsx)(xe.A.Item,{label:f("house"),span:3,children:null===w||void 0===w||null===(n=w.address_from)||void 0===n?void 0:n.house}),(0,q.jsx)(xe.A.Item,{label:f("stage"),span:3,children:null===w||void 0===w||null===(a=w.address_from)||void 0===a?void 0:a.stage}),(0,q.jsx)(xe.A.Item,{label:f("room"),span:3,children:null===w||void 0===w||null===(s=w.address_from)||void 0===s?void 0:s.room})]})}),(0,q.jsx)(L.A,{span:12,children:(0,q.jsxs)(xe.A,{title:f("receiver.details"),bordered:!0,children:[(0,q.jsx)(xe.A.Item,{label:f("username"),span:3,children:null===w||void 0===w?void 0:w.username_to}),(0,q.jsx)(xe.A.Item,{label:f("phone"),span:3,children:null===w||void 0===w?void 0:w.phone_to}),(0,q.jsx)(xe.A.Item,{label:f("address"),span:3,children:null===w||void 0===w||null===(i=w.address_to)||void 0===i?void 0:i.address}),(0,q.jsx)(xe.A.Item,{label:f("house"),span:3,children:null===w||void 0===w||null===(o=w.address_to)||void 0===o?void 0:o.house}),(0,q.jsx)(xe.A.Item,{label:f("stage"),span:3,children:null===w||void 0===w||null===(r=w.address_to)||void 0===r?void 0:r.stage}),(0,q.jsx)(xe.A.Item,{label:f("room"),span:3,children:null===w||void 0===w||null===(c=w.address_to)||void 0===c?void 0:c.room})]})}),(0,q.jsx)(L.A,{span:24,children:(0,q.jsxs)(xe.A,{bordered:!0,className:"mt-4",children:[(0,q.jsxs)(xe.A.Item,{label:f("client"),span:3,children:[null===w||void 0===w||null===(u=w.user)||void 0===u?void 0:u.firstname," ",null===w||void 0===w||null===(v=w.user)||void 0===v?void 0:v.lastname]}),(0,q.jsx)(xe.A.Item,{label:f("delivery.date.&.time"),span:3,children:null===w||void 0===w?void 0:w.delivery_date}),(0,q.jsx)(xe.A.Item,{label:f("price"),span:3,children:(0,je.default)(null===w||void 0===w?void 0:w.total_price)}),(0,q.jsx)(xe.A.Item,{label:f("created.at"),span:3,children:P()(null===w||void 0===w?void 0:w.created_at).format(`YYYY-MM-DD ${S}`)}),(0,q.jsx)(xe.A.Item,{label:f("note"),span:3,children:null!==(m=null===w||void 0===w?void 0:w.note)&&void 0!==m?m:"---"}),(0,q.jsx)(xe.A.Item,{label:f("transaction"),span:3,children:(0,q.jsxs)("span",{style:{cursor:"pointer"},onClick:()=>k(!0),children:[null!==(p=null===w||void 0===w||null===(x=w.transaction)||void 0===x?void 0:x.status)&&void 0!==p?p:f("N/A")," ",(0,q.jsx)(h.A,{})]})})]})})]}),C&&(0,q.jsx)(fe,{handleCancel:()=>k(!1),data:w,fetchParcelDetails:I})]})})})};function ye(e){var l,n,a;let{orderDetails:s,handleCancel:i}=e;const{t:o}=(0,g.B)(),{activeMenu:r}=(0,A.d4)((e=>e.menu),A.bN),[c]=R.A.useForm(),u=(0,A.wA)(),[v,h]=(0,t.useState)(!1);return(0,q.jsx)(E.A,{visible:!!s,onCancel:i,footer:[(0,q.jsx)(d.A,{type:"primary",onClick:()=>c.submit(),loading:v,children:o("save")},"saveBtn"),(0,q.jsx)(d.A,{type:"default",onClick:i,children:o("cancel")},"cancelBtn")],children:(0,q.jsx)(R.A,{form:c,layout:"vertical",onFinish:e=>{const l={deliveryman_id:e.deliveryman.value};h(!0),V.A.updateDelivery(s.id,l).then((()=>{i(),u((0,f.Ms)(r))})).finally((()=>h(!1)))},initialValues:{deliveryman:{label:s.deliveryman?(null===s||void 0===s||null===(l=s.deliveryman)||void 0===l?void 0:l.firstname)+" "+(null===s||void 0===s||null===(n=s.deliveryman)||void 0===n?void 0:n.lastname):null,value:s.deliveryman?null===s||void 0===s||null===(a=s.deliveryman)||void 0===a?void 0:a.id:null}},children:(0,q.jsx)(G.A,{gutter:12,children:(0,q.jsx)(L.A,{span:24,children:(0,q.jsx)(R.A.Item,{label:o("deliveryman"),name:"deliveryman",rules:[{required:!0,message:o("required")}],children:(0,q.jsx)(S.G,{className:"w-100",debounceTimeout:500,placeholder:o("select.shop"),fetchOptions:async function(e){const l={search:e.length?e:void 0,page:1,perPage:10,role:"deliveryman",exist_token:1};return I.A.getAll(l).then((e=>{let{data:l}=e;return l.map((e=>({label:[(null===e||void 0===e?void 0:e.firstname)||"",(null===e||void 0===e?void 0:e.lastname)||""].join(" "),value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id})))}))},allowClear:!0})})})})})})}var be=n(90352);const{TabPane:we}=a.A,{RangePicker:_e}=s.A;function Ce(){var e,l,n,s,N,R,E,G,L,T;const{type:K}=(0,v.g)(),U=(0,A.wA)(),Z=(0,v.Zp)(),W=(0,F.s)(),{t:X}=(0,g.B)(),{statusList:J,loading:ee}=(0,A.d4)((e=>e.orderStatus),A.bN),{activeMenu:le}=(0,A.d4)((e=>e.menu),A.bN),[ne,te]=(0,t.useState)(null),[ae,se]=(0,t.useState)(null),[ie,de]=(0,t.useState)(null),oe=(0,re.Q)(),ce=[{name:"all",id:"0",active:!0,sort:0},...J],[ue,ve]=(0,t.useState)([{title:X("id"),is_show:!0,dataIndex:"id",key:"id",sorter:!0},{title:X("client"),is_show:!0,dataIndex:"user",key:"user",render:e=>(0,q.jsxs)("div",{children:[null===e||void 0===e?void 0:e.firstname," ",(null===e||void 0===e?void 0:e.lastname)||""]})},{title:X("status"),is_show:!0,dataIndex:"status",key:"status",render:(e,l)=>(0,q.jsxs)("div",{className:"cursor-pointer",children:["new"===e?(0,q.jsx)(i.A,{color:"blue",children:X(e)}):"canceled"===e?(0,q.jsx)(i.A,{color:"error",children:X(e)}):(0,q.jsx)(i.A,{color:"cyan",children:X(e)}),"delivered"!==e&&"canceled"!==e?(0,q.jsx)(h.A,{onClick:e=>{e.stopPropagation(),te(l)}}):""]})},{title:X("deliveryman"),is_show:!0,dataIndex:"deliveryman",key:"deliveryman",render:(e,l)=>(0,q.jsx)("div",{children:"ready"===(null===l||void 0===l?void 0:l.status)&&"pickup"!==(null===l||void 0===l?void 0:l.delivery_type)?(0,q.jsx)(d.A,{type:"link",onClick:()=>de(l),children:(0,q.jsxs)(o.A,{children:[e?`${null===e||void 0===e?void 0:e.firstname} ${null===e||void 0===e?void 0:e.lastname}`:X("add.deliveryman"),(0,q.jsx)(h.A,{})]})}):(0,q.jsxs)("div",{children:[null===e||void 0===e?void 0:e.firstname," ",null===e||void 0===e?void 0:e.lastname]})})},{title:X("payment.type"),is_show:!0,dataIndex:"transaction",key:"transaction",render:e=>{var l;return X(null===e||void 0===e||null===(l=e.payment_system)||void 0===l?void 0:l.tag)||"-"}},{title:X("created.at"),is_show:!0,dataIndex:"created_at",key:"created_at",render:e=>P()(e).format(`YYYY-MM-DD ${oe}`)},{title:X("delivery.date"),is_show:!0,dataIndex:"delivery_date",key:"delivery_date",render:e=>P()(e).format("YYYY-MM-DD")},{title:X("options"),is_show:!0,key:"options",render:(e,l)=>(0,q.jsxs)(o.A,{children:[(0,q.jsx)(d.A,{icon:(0,q.jsx)($.kMs,{}),onClick:e=>{e.stopPropagation(),se(l.id)}}),(0,q.jsx)(d.A,{icon:(0,q.jsx)(m.A,{}),onClick:e=>{e.stopPropagation(),(e=>{W.set("parcelId",e.id)})(l)}}),(0,q.jsx)(d.A,{type:"primary",icon:(0,q.jsx)(h.A,{}),onClick:e=>{e.stopPropagation(),(e=>{U((0,k.Uy)()),U((0,f.X4)({url:`parcel-orders/${e.id}`,id:"edit_parcel_order",name:X("edit.parcel.order")})),Z(`/parcel-orders/${e.id}`)})(l)},disabled:"delivered"===l.status||"canceled"===l.status}),(0,q.jsx)(H.A,{icon:(0,q.jsx)(p.A,{}),onClick:e=>{e.stopPropagation(),Se([l.id]),he(!0),Me(!0)}})]})}]),{setIsModalVisible:he}=(0,t.useContext)(Y.o),[me,xe]=(0,t.useState)(!1),[je,Ae]=(0,t.useState)(W.values.status||"all"),fe=(null===(e=le.data)||void 0===e?void 0:e.role)||je,Ce=le.data,[ke,Se]=(0,t.useState)(null),[Ie,Me]=(0,t.useState)(null),[ze,He]=(0,t.useState)(!1),[Ve,Ye]=(0,t.useState)(P()().subtract(1,"months"),P()()),{data:De,loading:Ne,params:Pe,meta:Be}=(0,A.d4)((e=>e.parcelOrders),A.bN),$e={search:null===Ce||void 0===Ce?void 0:Ce.search,sort:null===Ce||void 0===Ce?void 0:Ce.sort,column:null===Ce||void 0===Ce?void 0:Ce.column,perPage:null===Ce||void 0===Ce?void 0:Ce.perPage,page:null===Ce||void 0===Ce?void 0:Ce.page,user_id:null===Ce||void 0===Ce?void 0:Ce.user_id,status:"all"===fe?void 0:fe,shop_id:null!==(null===(l=le.data)||void 0===l?void 0:l.shop_id)?null===(n=le.data)||void 0===n?void 0:n.shop_id:null,delivery_type:"scheduled"!==K?K:void 0,delivery_date_from:"scheduled"===K?P()().add(1,"day").format("YYYY-MM-DD"):void 0,date_from:Ve?null===(s=Ve[0])||void 0===s?void 0:s.format("YYYY-MM-DD"):null,date_to:Ve?null===(N=Ve[1])||void 0===N?void 0:N.format("YYYY-MM-DD"):null};(0,y.A)((()=>{U((0,w.xj)($e))}),[Ce,Ve,K]);const Oe=(e,l)=>{U((0,f.Ok)({activeMenu:le,data:{...Ce,[l]:e}}))};const Fe=()=>{te(null),de(null),se(null),W.clear()};(0,t.useEffect)((()=>{null!==le&&void 0!==le&&le.refetch&&(0,A.vA)((()=>{U((0,w.xj)($e)),U((0,f.km)(le))}))}),[null===le||void 0===le?void 0:le.refetch]),(0,t.useEffect)((()=>{U((0,be.rA)({}))}),[]);const Re={selectedRowKeys:ke,onChange:e=>{Se(e)}};return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(o.A,{className:"justify-content-end w-100 mb-3",children:(0,q.jsx)(d.A,{type:"primary",icon:(0,q.jsx)(x.A,{}),onClick:()=>{(0,A.vA)((()=>{U((0,k.Uy)()),U((0,f.X4)({id:"parcel-orders/add",url:"parcel-orders/add",name:"add.parcel.order"}))})),Z("/parcel-orders/add")},style:{width:"100%"},children:X("add.parcel.order")})}),(0,q.jsx)(r.A,{children:(0,q.jsxs)(o.A,{wrap:!0,className:"order-filter",children:[(0,q.jsx)(C.A,{defaultValue:null===Ce||void 0===Ce?void 0:Ce.search,resetSearch:!(null!==Ce&&void 0!==Ce&&Ce.search),placeholder:X("search"),handleChange:e=>Oe(e,"search")}),(0,q.jsx)(S.G,{placeholder:X("select.client"),fetchOptions:async function(e){const l={search:e,perPage:10};return I.A.search(l).then((e=>{let{data:l}=e;return l.map((e=>({label:`${null===e||void 0===e?void 0:e.firstname} ${null===e||void 0===e?void 0:e.lastname}`,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id})))}))},onSelect:e=>Oe(e.value,"user_id"),onDeselect:()=>Oe(null,"user_id"),style:{width:"100%"},value:null===Ce||void 0===Ce?void 0:Ce.user_id}),(0,q.jsx)(_e,{value:Ve,onChange:e=>Ye(e),disabledDate:e=>e&&e>P()().endOf("day"),style:{width:"100%"}}),(0,q.jsxs)(d.A,{onClick:()=>{xe(!0);const e="all"!==je?{status:je}:null;V.A.export(e).then((e=>{var l;window.location.href=B.bb+(null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.file_name)})).finally((()=>xe(!1)))},loading:me,style:{width:"100%"},children:[(0,q.jsx)(O.$tV,{className:"mr-2"}),X("export")]}),(0,q.jsx)(d.A,{onClick:()=>{(0,A.vA)((()=>{U((0,b.gw)()),U((0,f.Ok)({activeMenu:le,data:null})),U((0,w.xj)({status:void 0,page:null===Ce||void 0===Ce?void 0:Ce.page,perPage:20}))})),Ye(void 0)},style:{width:"100%"},icon:(0,q.jsx)(j.A,{}),children:X("clear")})]})}),(0,q.jsxs)(r.A,{loading:ee,children:[(0,q.jsxs)(o.A,{className:"justify-content-between align-items-start w-100",children:[(0,q.jsx)(a.A,{onChange:e=>{const l=e;U((0,f.Ok)({activeMenu:le,data:{role:l,page:1}})),Ae(e),Z(`?status=${l}`)},type:"card",activeKey:fe,children:ce.filter((e=>!0===e.active)).map((e=>(0,q.jsx)(we,{tab:X(e.name)},e.name)))}),(0,q.jsxs)(o.A,{children:[null!==ke&&0!==ke.length&&(0,q.jsx)(c.A,{title:X("delete.selected"),children:(0,q.jsx)(H.A,{type:"primary",onClick:()=>{null===ke||0===ke.length?z.oR.warning(X("select.the.product")):(he(!0),Me(!1))},danger:!0})}),(0,q.jsx)(M.A,{setColumns:ve,columns:ue,iconOnly:!0})]})]}),(0,q.jsx)(u.A,{scroll:{x:!0},rowSelection:Re,columns:null===ue||void 0===ue?void 0:ue.filter((e=>e.is_show)),dataSource:De,loading:Ne,pagination:{pageSize:Pe.perPage,page:(null===(R=le.data)||void 0===R?void 0:R.page)||1,total:Be.total,defaultCurrent:null===(E=le.data)||void 0===E?void 0:E.page,current:null===(G=le.data)||void 0===G?void 0:G.page},rowKey:e=>e.id,onChange:function(e,l,n){const{pageSize:t,current:a}=e,{field:s,order:i}=n,d=(0,_.A)(i);U((0,f.Ok)({activeMenu:le,data:{...Ce,perPage:t,page:a,column:s,sort:d}}))}})]}),ne&&(0,q.jsx)(Q,{orderDetails:ne,handleCancel:Fe,status:J}),ie&&(0,q.jsx)(ye,{orderDetails:ie,handleCancel:Fe}),ae&&(0,q.jsx)(pe,{id:ae,handleCancel:Fe}),!(null===W||void 0===W||null===(L=W.values)||void 0===L||!L.parcelId)&&(0,q.jsx)(ge,{id:null===W||void 0===W||null===(T=W.values)||void 0===T?void 0:T.parcelId,handleCancel:Fe}),(0,q.jsx)(D.A,{click:()=>{He(!0);const e={...Object.assign({},...ke.map(((e,l)=>({[`ids[${l}]`]:e}))))};V.A.delete(e).then((()=>{z.oR.success(X("successfully.deleted")),he(!1),U((0,w.xj)($e)),Me(null),Se(null)})).finally((()=>{He(!1)}))},text:X(Ie?"delete":"all.delete"),loading:ze,setText:Se})]})}},65820:(e,l,n)=>{n.d(l,{s:()=>i});var t=n(28429),a=n(21215),s=n.n(a);const i=()=>{const e=(0,t.Zp)(),l=(0,t.zy)(),n=s().parse(l.search,{ignoreQueryPrefix:!0});return{values:n,set:(l,t)=>e({search:s().stringify({...n,[l]:t})}),reset:l=>{const t={...n};t[l]&&delete t[l],e({search:s().stringify({...t})})},clear:()=>e({search:s().stringify({})}),merge:l=>e({search:s().stringify({...n,...l})})}}},73631:(e,l,n)=>{e.exports=n.p+"static/media/shop.46d7a94ca800c711764a.png"},80415:(e,l,n)=>{n.d(l,{G:()=>i,HV:()=>a,LH:()=>t,PR:()=>s,wO:()=>o,xt:()=>d});const t={new:[1,2,3,4,5],accepted:[1,2,3,4,5],ready:[1,2,3,4,5],on_a_way:[1,2,3,4,5],delivered:[1,2,3,4,5],canceled:[1,2,3,4,5],cooking:[1,2,3,4,5]},a=(new Date,new Date,["new","accepted","ready","on_a_way","pause","delivered","canceled"]),s=30,i="HH:mm",d="hh:mm a",o=!0},89323:(e,l,n)=>{n.d(l,{A:()=>o});var t=n(89379),a=n(9950);const s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 208H676V232h212v136zm0 224H676V432h212v160zM412 432h200v160H412V432zm200-64H412V232h200v136zm-476 64h212v160H136V432zm0-200h212v136H136V232zm0 424h212v136H136V656zm276 0h200v136H412V656zm476 136H676V656h212v136z"}}]},name:"table",theme:"outlined"};var i=n(25085),d=function(e,l){return a.createElement(i.A,(0,t.A)((0,t.A)({},e),{},{ref:l,icon:s}))};const o=a.forwardRef(d)}}]);