"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[2633],{27276:(e,t,l)=>{l.d(t,{v:()=>s});var a=l(9950),i=l(90777),n=l(90650),r=l(44414);const s=e=>{let{fetchOptions:t,refetch:l=!1,...s}=e;const[o,d]=(0,a.useState)(!1),[u,c]=(0,a.useState)([]);return(0,r.jsx)(i.A,{treeLine:!0,treeData:o?[]:u,treeDefaultExpandAll:!0,labelInValue:!0,onFocus:()=>{u.length&&!l||(d(!0),t().then((e=>{c(e),d(!1)})))},notFoundContent:o?(0,r.jsx)(n.A,{size:"small"}):"no results",...s})}},52633:(e,t,l)=>{l.r(t),l.d(t,{default:()=>S});var a=l(9950),i=l(59233),n=l(23263),r=l(87094),s=l(41988),o=l(55902),d=l(99674),u=l(40577),c=l(25933),m=l(48538),v=l(90650),p=l(85923),h=l(28429),j=l(71999),g=l(98591),y=l(91854),x=l(74623),A=l(62572),f=l(28264),b=l(70030),w=l(48970),k=(l(79406),l(27276)),I=l(44414);const S=()=>{var e,t;const{t:l}=(0,b.B)(),S=(0,h.Zp)(),_=(0,y.wA)(),{activeMenu:E}=(0,y.d4)((e=>e.menu),y.bN),{state:P}=(0,h.zy)(),[q,F]=(0,a.useState)(!1),[$,C]=(0,a.useState)("main"),[z,N]=(0,a.useState)(null!==(e=E.data)&&void 0!==e&&e.image?[null===(t=E.data)||void 0===t?void 0:t.image]:[]),[O]=i.A.useForm(),[L,V]=(0,a.useState)(!1),[M,B]=(0,a.useState)(null),{uuid:D}=(0,h.g)(),{defaultLang:T,languages:U}=(0,y.d4)((e=>e.formLang),y.bN);(0,a.useEffect)((()=>()=>{const e=O.getFieldsValue(!0);_((0,x.Ok)({activeMenu:E,data:e}))}),[]);const K=e=>({name:e,url:e});function R(e){if(!e)return{};const{translations:t}=e,l=U.map((e=>{var l,a;return{[`title[${e.locale}]`]:null===(l=t.find((t=>t.locale===e.locale)))||void 0===l?void 0:l.title,[`description[${e.locale}]`]:null===(a=t.find((t=>t.locale===e.locale)))||void 0===a?void 0:a.description}}));return Object.assign({},...l)}(0,a.useEffect)((()=>{var e;E.refetch&&(e=D,F(!0),A.A.getById(e).then((e=>{var t,l;let a=e.data;const i={...a,...R(a),image:[K(a.img)],keywords:a.keywords.split(","),parent_id:{label:null===(t=a.parent)||void 0===t||null===(l=t.translation)||void 0===l?void 0:l.title,value:a.parent_id,key:a.parent_id}};O.setFieldsValue(i),N([K(a.img)])})).finally((()=>{F(!1),_((0,x.km)(E))})))}),[E.refetch]);return(0,I.jsx)(n.A,{title:l("category.clone"),extra:(0,I.jsx)(j.A,{}),children:q?(0,I.jsx)("div",{className:"d-flex justify-content-center align-items-center py-5",children:(0,I.jsx)(v.A,{size:"large",className:"mt-5 pt-5"})}):(0,I.jsxs)(i.A,{name:"basic",layout:"vertical",onFinish:e=>{var t,a,i;V(!0);const n={...e,type:null!==(t=e.parent_id)&&void 0!==t&&t.value?$:"main",active:e.active?1:0,keywords:e.keywords.join(","),parent_id:null===(a=e.parent_id)||void 0===a?void 0:a.value,"images[0]":null===(i=z[0])||void 0===i?void 0:i.name},r=null!==P&&void 0!==P&&P.parentId?`category/${P.parentUuid}`:"catalog/categories";A.A.create(n).then((()=>{p.oR.success(l("successfully.updated")),_((0,x.EK)({...E,nextUrl:r})),_((0,f.jE)({type:null!==P&&void 0!==P&&P.parentId?"sub_main":"main",parent_id:null===P||void 0===P?void 0:P.parentId})),S(`/${r}`)})).catch((e=>B(e.response.data.params))).finally((()=>V(!1)))},initialValues:{parent_id:{title:"---",value:0,key:0},active:!0,...E.data},form:O,children:[(0,I.jsxs)(r.A,{gutter:12,children:[(0,I.jsx)(s.A,{span:12,children:U.map(((e,t)=>(0,I.jsx)(i.A.Item,{label:l("name"),name:`title[${e.locale}]`,help:M&&M[`title.${T}`]?M[`title.${T}`][0]:null,validateStatus:M?"error":"success",rules:[{validator:(t,a)=>a||(null===e||void 0===e?void 0:e.locale)!==T?a&&""===(null===a||void 0===a?void 0:a.trim())?Promise.reject(new Error(l("no.empty.space"))):a&&(null===a||void 0===a?void 0:a.trim().length)<2?Promise.reject(new Error(l("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(l("required")))}],hidden:e.locale!==T,children:(0,I.jsx)(o.A,{})},e.title+t)))}),(0,I.jsx)(s.A,{span:12,children:U.map(((e,t)=>(0,I.jsx)(i.A.Item,{label:l("description"),name:`description[${e.locale}]`,rules:[{validator:(t,a)=>a||(null===e||void 0===e?void 0:e.locale)!==T?a&&""===(null===a||void 0===a?void 0:a.trim())?Promise.reject(new Error(l("no.empty.space"))):a&&(null===a||void 0===a?void 0:a.trim().length)<5?Promise.reject(new Error(l("must.be.at.least.5"))):Promise.resolve():Promise.reject(new Error(l("required")))}],hidden:e.locale!==T,children:(0,I.jsx)(g.A,{rows:4})},e.locale+t)))}),(0,I.jsx)(s.A,{span:12,children:(0,I.jsx)(i.A.Item,{label:l("keywords"),name:"keywords",rules:[{required:!0,message:l("required")}],children:(0,I.jsx)(d.A,{mode:"tags",style:{width:"100%"}})})}),!(null!==P&&void 0!==P&&P.parentId)&&(0,I.jsx)(s.A,{span:12,children:(0,I.jsx)(i.A.Item,{label:l("parent.category"),name:"parent_id",rules:[{required:!1,message:l("required")}],children:(0,I.jsx)(k.v,{refetch:!0,fetchOptions:async function(){return A.A.getAll({perPage:100,type:"main"}).then((e=>e.data.map((e=>{var t,l;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id,key:e.id,type:"main",children:null===(l=e.children)||void 0===l?void 0:l.map((e=>{var t,l;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id,key:e.id,type:"sub_main",disabled:"child"===e.type,children:null===(l=e.children)||void 0===l?void 0:l.map((e=>{var t;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id,key:e.id,disabled:!0,type:"child"}}))}}))}}))))},onSelect:(e,t,l)=>{const{type:a}=t||{};C("main"===a?"sub_main":"sub_main"===a?"child":"main")},allowClear:!0})})}),(0,I.jsx)(s.A,{span:12,children:(0,I.jsx)(i.A.Item,{name:"input",label:l("input"),rules:[{required:!0,message:l("required")}],children:(0,I.jsx)(u.A,{min:0,parser:e=>parseInt(e,10),max:9999999,className:"w-100"})})}),(0,I.jsx)(s.A,{span:4,children:(0,I.jsx)(i.A.Item,{label:l("image"),name:"images",rules:[{validator:()=>0===(null===z||void 0===z?void 0:z.length)?Promise.reject(new Error(l("required"))):Promise.resolve()}],children:(0,I.jsx)(w.A,{type:"categories",imageList:z,setImageList:N,form:O,multiple:!1})})}),(0,I.jsx)(s.A,{span:2,children:(0,I.jsx)(i.A.Item,{label:l("active"),name:"active",valuePropName:"checked",children:(0,I.jsx)(c.A,{})})})]}),(0,I.jsx)(m.A,{type:"primary",htmlType:"submit",loading:L,children:l("submit")})]})})}},79406:(e,t,l)=>{l.d(t,{a:()=>d});var a=l(9950),i=l(95491),n=l.n(i),r=l(99674),s=l(90650),o=l(44414);const d=e=>{let{fetchOptions:t,debounceTimeout:l=400,refetch:i=!1,...d}=e;const[u,c]=(0,a.useState)(!1),[m,v]=(0,a.useState)([]),p=(0,a.useMemo)((()=>n()((e=>{v([]),c(!0),t(e).then((e=>{v(e),c(!1)}))}),l)),[t,l]);return(0,o.jsx)(r.A,{showSearch:!0,allowClear:!0,labelInValue:!0,onClear:()=>p(""),filterOption:!1,onSearch:p,notFoundContent:u?(0,o.jsx)(s.A,{size:"small"}):"no results",...d,options:m,onFocus:()=>{m.length&&!i||p("")}})}}}]);