"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[9485],{69485:(e,t,l)=>{l.r(t),l.d(t,{default:()=>E});var a=l(9950),r=l(59233),s=l(23263),i=l(87094),n=l(41988),o=l(55902),c=l(99674),d=l(25933),u=l(48538),m=l(90650),v=l(85923),p=l(28429),h=l(71999),g=l(98591),j=l(91854),y=l(74623),x=l(62572),A=l(63620),f=l(70030),w=l(48970),b=l(61707),k=l(44414);const E=()=>{var e,t;const{t:l}=(0,f.B)(),E=(0,p.Zp)(),P=(0,j.wA)(),{activeMenu:$}=(0,j.d4)((e=>e.menu),j.bN),[I,N]=(0,a.useState)(!1),[q,S]=(0,a.useState)(null!==(e=$.data)&&void 0!==e&&e.image?[null===(t=$.data)||void 0===t?void 0:t.image]:[]),[z]=r.A.useForm(),[F,L]=(0,a.useState)(!1),[V,B]=(0,a.useState)(null),C=(0,p.zy)(),{uuid:K}=(0,p.g)(),{params:M}=(0,j.d4)((e=>e.category),j.bN),{defaultLang:O,languages:R}=(0,j.d4)((e=>e.formLang),j.bN);(0,a.useEffect)((()=>()=>{const e=z.getFieldsValue(!0);P((0,y.Ok)({activeMenu:$,data:e}))}),[]);const U=e=>({name:e,url:A.sE+e});function _(e){if(!e)return{};const{translations:t}=e,l=R.map((e=>{var l,a;return{[`title[${e.locale}]`]:null===(l=t.find((t=>t.locale===e.locale)))||void 0===l?void 0:l.title,[`description[${e.locale}]`]:null===(a=t.find((t=>t.locale===e.locale)))||void 0===a?void 0:a.description}}));return Object.assign({},...l)}return(0,a.useEffect)((()=>{var e;$.refetch&&(e=K,N(!0),x.A.getById(e).then((e=>{let t=e.data;const l={...t,..._(t),image:[U(t.img)],keywords:t.keywords.split(",")};z.setFieldsValue(l),S([U(t.img)])})).finally((()=>{N(!1),P((0,y.km)($))})))}),[$.refetch]),(0,k.jsx)(s.A,{title:l("edit.category"),extra:(0,k.jsx)(h.A,{}),children:I?(0,k.jsx)("div",{className:"d-flex justify-content-center align-items-center py-5",children:(0,k.jsx)(m.A,{size:"large",className:"mt-5 pt-5"})}):(0,k.jsxs)(r.A,{name:"basic",layout:"vertical",onFinish:e=>{var t;L(!0);const a={...e,type:"receipt",active:e.active?1:0,keywords:e.keywords.join(","),parent_id:null,"images[0]":null===(t=q[0])||void 0===t?void 0:t.name},r="catalog/recipe-categories";"edit"===C.state?x.A.update(K,a).then((()=>{v.oR.success(l("successfully.updated")),P((0,y.EK)({...$,nextUrl:r})),P((0,b.rn)()),E(`/${r}`)})).catch((e=>B(e.response.data.params))).finally((()=>L(!1))):x.A.create(a).then((()=>{v.oR.success(l("successfully.updated")),P((0,y.EK)({...$,nextUrl:r})),P((0,b.rn)()),E(`/${r}`)})).catch((e=>B(e.response.data.params))).finally((()=>L(!1)))},initialValues:{parent_id:{title:"---",value:0,key:0},active:!0,...$.data},form:z,children:[(0,k.jsxs)(i.A,{gutter:12,children:[(0,k.jsx)(n.A,{span:12,children:R.map(((e,t)=>(0,k.jsx)(r.A.Item,{label:l("name"),name:`title[${e.locale}]`,help:V&&V[`title.${O}`]?V[`title.${O}`][0]:null,validateStatus:V?"error":"success",rules:[{validator:(t,a)=>a||(null===e||void 0===e?void 0:e.locale)!==O?a&&""===(null===a||void 0===a?void 0:a.trim())?Promise.reject(new Error(l("no.empty.space"))):a&&(null===a||void 0===a?void 0:a.trim().length)<2?Promise.reject(new Error(l("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(l("required")))}],hidden:e.locale!==O,children:(0,k.jsx)(o.A,{})},e.title+t)))}),(0,k.jsx)(n.A,{span:12,children:R.map(((e,t)=>(0,k.jsx)(r.A.Item,{label:l("description"),name:`description[${e.locale}]`,rules:[{validator:(t,a)=>a||(null===e||void 0===e?void 0:e.locale)!==O?a&&""===(null===a||void 0===a?void 0:a.trim())?Promise.reject(new Error(l("no.empty.space"))):a&&(null===a||void 0===a?void 0:a.trim().length)<5?Promise.reject(new Error(l("must.be.at.least.5"))):Promise.resolve():Promise.reject(new Error(l("required")))}],hidden:e.locale!==O,children:(0,k.jsx)(g.A,{rows:4})},e.locale+t)))}),(0,k.jsx)(n.A,{span:12,children:(0,k.jsx)(r.A.Item,{label:l("keywords"),name:"keywords",rules:[{required:!0,message:l("required")}],children:(0,k.jsx)(c.A,{mode:"tags",style:{width:"100%"}})})}),(0,k.jsx)(n.A,{span:4,children:(0,k.jsx)(r.A.Item,{label:l("image"),name:"images",rules:[{validator:()=>0===(null===q||void 0===q?void 0:q.length)?Promise.reject(new Error(l("required"))):Promise.resolve()}],children:(0,k.jsx)(w.A,{type:"categories",imageList:q,setImageList:S,form:z,multiple:!1})})}),(0,k.jsx)(n.A,{span:2,children:(0,k.jsx)(r.A.Item,{label:l("active"),name:"active",valuePropName:"checked",children:(0,k.jsx)(d.A,{})})})]}),(0,k.jsx)(u.A,{type:"primary",htmlType:"submit",loading:F,children:l("submit")})]})})}}}]);