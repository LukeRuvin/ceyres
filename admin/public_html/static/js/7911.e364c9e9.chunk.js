"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[7911],{8297:(e,l,i)=>{i.d(l,{A:()=>o});var t=i(9950),n=i(55902),a=i(41397),d=i(60767),s=i(44414);function o(e){let{handleChange:l,defaultValue:i,resetSearch:o,...r}=e;const[u,c]=(0,t.useState)(i),v=(0,t.useMemo)((()=>(0,a.debounce)((e=>{l(e)}),800)),[]);return(0,t.useEffect)((()=>{c(i)}),[o]),(0,s.jsx)(n.A,{value:u,onChange:e=>{c(e.target.value),v(e.target.value)},prefix:(0,s.jsx)(d.A,{}),...r})}},47911:(e,l,i)=>{i.r(l),i.d(l,{default:()=>M});var t=i(9950),n=i(25933),a=i(80737),d=i(48538),s=i(23263),o=i(52913),r=i(55386),u=i(91854),c=i(74623),v=i(85923),h=i(70030),p=i(66882),g=i(8297),A=i(88986),x=i(82206),y=i(28429),j=i(42074),f=i(24513),m=i(44070),b=i(59233),S=i(82706),_=i(90650),k=i(87094),C=i(41988),I=i(55902),O=i(71999),w=i(78687),z=i(80905),V=i(2905),q=i(44414);function F(e){let{visible:l,setVisible:i,id:a,setId:s}=e;const[o]=b.A.useForm(),r=(0,u.wA)(),{t:c}=(0,h.B)(),{defaultLang:g,languages:A}=(0,u.d4)((e=>e.formLang),u.bN),[y,j]=(0,t.useState)(!1),[f,m]=(0,t.useState)(!1),[F,M]=(0,t.useState)(null),$=()=>{M(null),i(!1),o.resetFields(),s(null)};function B(e){if(null===e||void 0===e||!e.translations)return{};const{translations:l}=e,i=A.map((e=>{var i;return{[`title[${null===e||void 0===e?void 0:e.locale}]`]:null===(i=l.find((l=>l.locale===e.locale)))||void 0===i?void 0:i.title}}));return Object.assign({},...i)}return(0,t.useEffect)((()=>{a&&(m(!0),x.A.show(a).then((e=>{var l,i,t,n,a,d;let{data:s}=e;M(s),o.setFieldsValue({active:null===s||void 0===s?void 0:s.active,country_id:{label:null===s||void 0===s||null===(l=s.country)||void 0===l||null===(i=l.translation)||void 0===i?void 0:i.title,value:null===s||void 0===s||null===(t=s.country)||void 0===t?void 0:t.id},region_id:{label:null===s||void 0===s||null===(n=s.region)||void 0===n||null===(a=n.translation)||void 0===a?void 0:a.title,value:null===s||void 0===s||null===(d=s.region)||void 0===d?void 0:d.id},...B(s)})})).finally((()=>m(!1))))}),[a]),(0,q.jsx)(S.A,{visible:l,onCancel:$,onOk:$,footer:null,loading:f,title:c("add.city"),children:(0,q.jsxs)(b.A,{form:o,onFinish:e=>{var l,i;j(!0);const t={country_id:null===e||void 0===e||null===(l=e.country_id)||void 0===l?void 0:l.value,region_id:null===e||void 0===e||null===(i=e.region_id)||void 0===i?void 0:i.value,active:null===e||void 0===e?void 0:e.active,title:{...Object.assign({},...null===A||void 0===A?void 0:A.map((l=>({[null===l||void 0===l?void 0:l.locale]:e[`title[${null===l||void 0===l?void 0:l.locale}]`]}))))}};null!==F&&void 0!==F&&F.id?(e=>{x.A.update(F.id,e).then((()=>{v.oR.success(c("successfully.updated")),(0,u.vA)((()=>{r((0,p.e)({}))})),$()})).finally((()=>j(!1)))})(t):(e=>{x.A.create(e).then((()=>{v.oR.success(c("successfully.added")),(0,u.vA)((()=>{r((0,p.e)({}))})),$()})).finally((()=>j(!1)))})(t)},layout:"vertical",initialValues:{active:!0},children:[(0,q.jsx)(_.A,{spinning:f,children:(0,q.jsxs)(k.A,{gutter:24,children:[(0,q.jsx)(C.A,{span:24,children:(0,q.jsx)(O.A,{})}),(0,q.jsx)(C.A,{span:24,children:A.map((e=>(0,q.jsx)(b.A.Item,{label:c("title"),name:`title[${e.locale}]`,hidden:e.locale!==g,rules:[{required:(null===e||void 0===e?void 0:e.locale)===g,message:c("required")}],children:(0,q.jsx)(I.A,{})},"title"+e.id)))}),(0,q.jsx)(C.A,{span:24,children:(0,q.jsx)(b.A.Item,{name:"region_id",label:c("region_id"),rules:[{required:!0,message:c("required")}],children:(0,q.jsx)(z.j,{fetchOptions:e=>{let{search:l,page:i}=e;return V.A.get({search:null!==l&&void 0!==l&&l.length?l:void 0,page:i}).then((e=>e.data.map((e=>{var l;return{label:null===e||void 0===e||null===(l=e.translation)||void 0===l?void 0:l.title,value:null===e||void 0===e?void 0:e.id}}))))}})})}),(0,q.jsx)(C.A,{span:24,children:(0,q.jsx)(b.A.Item,{name:"country_id",label:c("country_id"),rules:[{required:!0,message:c("required")}],children:(0,q.jsx)(z.j,{fetchOptions:e=>{let{search:l,page:i}=e;return w.A.get({search:null!==l&&void 0!==l&&l.length?l:void 0,page:i}).then((e=>e.data.map((e=>{var l;return{label:null===e||void 0===e||null===(l=e.translation)||void 0===l?void 0:l.title,value:e.id}}))))}})})}),(0,q.jsx)(C.A,{span:4,children:(0,q.jsx)(b.A.Item,{label:c("active"),name:"active",valuePropName:"checked",children:(0,q.jsx)(n.A,{defaultChecked:!0})})})]})}),(0,q.jsx)(d.A,{type:"primary",htmlType:"submit",loading:y,children:c("submit")})]})})}const M=()=>{const{t:e}=(0,h.B)(),l=(0,u.wA)(),i=(0,y.Zp)();let[b,S]=(0,j.ok)();const{setIsModalVisible:_}=(0,t.useContext)(r.o),{activeMenu:k}=(0,u.d4)((e=>e.menu),u.bN),C=null===k||void 0===k?void 0:k.data,I=b.get("country_id"),{list:O,meta:w,loading:z}=(0,u.d4)((e=>e.deliveryCity),u.bN),[V,M]=(0,t.useState)(!1),[$,B]=(0,t.useState)(!1),[N,R]=(0,t.useState)(!1),[T,E]=(0,t.useState)(null),H=[{title:e("id"),dataIndex:"id",key:"id"},{title:e("name"),dataIndex:"translation",key:"translation",render:(t,n)=>(0,q.jsx)("div",{style:{cursor:"pointer",textDecoration:"underline"},onClick:()=>(t=>{l((0,c.X4)({url:`deliveryzone/area?city_id=${t.id}`,id:"area",name:e("area")})),i(`/deliveryzone/area?city_id=${t.id}`)})(n),children:(null===t||void 0===t?void 0:t.title)||"-"})},{title:e("active"),dataIndex:"active",key:"active",render:(i,t)=>(0,q.jsx)(n.A,{onChange:()=>(i=>{M(i),x.A.status(i).then((()=>{_(!1),l((0,p.e)({country_id:I})),v.oR.success(e("successfully.updated"))})).finally((()=>{M(null)}))})(t.id),checked:i,loading:Boolean(V===t.id)},t.id)},{title:e("options"),dataIndex:"options",is_show:!0,render:(i,t)=>(0,q.jsxs)(a.A,{children:[(0,q.jsx)(d.A,{type:"primary",icon:(0,q.jsx)(f.A,{}),onClick:()=>(e=>{B(!0),E(e)})(t.id)}),(0,q.jsx)(d.A,{loading:Boolean(N===t.id),icon:(0,q.jsx)(m.A,{onClick:()=>(i=>{R(i),x.A.delete(i).then((()=>{l((0,p.e)()),v.oR.success(e("successfully.deleted"))})).finally((()=>{R(!1)}))})(t.id)})})]})}];(0,t.useEffect)((()=>{k.refetch&&(l((0,p.e)({country_id:I})),l((0,c.km)(k)))}),[k.refetch]),(0,A.A)((()=>{const e={search:null===C||void 0===C?void 0:C.search,country_id:I};l((0,p.e)(e))}),[null===k||void 0===k?void 0:k.data]);return(0,q.jsxs)(s.A,{title:e("cities"),extra:(0,q.jsxs)(a.A,{children:[(0,q.jsx)(g.A,{placeholder:e("search"),handleChange:e=>{return i=e,t="search",void l((0,c.Ok)({activeMenu:k,data:{...C,[t]:i}}));var i,t},defaultValue:null===C||void 0===C?void 0:C.search,resetSearch:!(null!==C&&void 0!==C&&C.search)}),(0,q.jsx)(d.A,{type:"primary",onClick:()=>B(!0),children:e("add.city")})]}),children:[(0,q.jsx)(o.A,{columns:H,dataSource:O,pagination:{pageSize:w.per_page,page:w.current_page,total:w.total},rowKey:e=>e.id,loading:z,onChange:e=>{const{pageSize:i,current:t}=e;l((0,p.e)({perPage:i,page:t,country_id:I}))}}),(0,q.jsx)(F,{visible:$,setVisible:B,id:T,setId:E})]})}},80905:(e,l,i)=>{i.d(l,{j:()=>r});var t=i(9950),n=i(95491),a=i.n(n),d=i(99674),s=i(90650),o=i(44414);const r=e=>{let{fetchOptions:l,debounceTimeout:i=400,hasMore:n,...r}=e;const[u,c]=(0,t.useState)(!1),[v,h]=(0,t.useState)([]),[p,g]=(0,t.useState)(!1),[A,x]=(0,t.useState)(null),[y,j]=(0,t.useState)(1),f=(0,t.useMemo)((()=>a()((e=>{h([]),x(e),c(!0),l({search:e}).then((e=>{h(e),j(2),c(!1)})).finally((()=>g(!1)))}),i)),[l,i,y]);return(0,o.jsxs)(d.A,{showSearch:!0,allowClear:!0,onPopupScroll:async e=>{const i=e.target;p||i.scrollTop+i.offsetHeight!==i.scrollHeight||n&&(g(!0),i.scrollTo(0,i.scrollHeight),l({search:A,page:y}).then((e=>{j((e=>e+1)),h([...v,...e])})).finally((()=>g(!1))))},labelInValue:!0,filterOption:!1,onSearch:f,notFoundContent:u?(0,o.jsx)(s.A,{size:"small"}):"no results",onFocus:()=>{v.length||f("")},...r,children:[v.map(((e,l)=>(0,o.jsx)(d.A.Option,{value:e.value,children:e.label},l))),p&&(0,o.jsx)(d.A.Option,{children:(0,o.jsx)(s.A,{size:"small"})})]})}}}]);