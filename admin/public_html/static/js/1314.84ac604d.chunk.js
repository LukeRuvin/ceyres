(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[1314],{6566:(e,t,l)=>{"use strict";l.d(t,{A:()=>i});var s=l(17706);const i=()=>{var e,t;const l={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_IS_DEMO:"true"}.MAP_API_KEY,{google_map_key:i}=null===(e=s.M.getState())||void 0===e||null===(t=e.globalSettings)||void 0===t?void 0:t.settings;return i||l}},8297:(e,t,l)=>{"use strict";l.d(t,{A:()=>d});var s=l(9950),i=l(55902),n=l(41397),a=l(60767),o=l(44414);function d(e){let{handleChange:t,defaultValue:l,resetSearch:d,...r}=e;const[c,u]=(0,s.useState)(l),v=(0,s.useMemo)((()=>(0,n.debounce)((e=>{t(e)}),800)),[]);return(0,s.useEffect)((()=>{u(l)}),[d]),(0,o.jsx)(i.A,{value:c,onChange:e=>{u(e.target.value),v(e.target.value)},prefix:(0,o.jsx)(a.A,{}),...r})}},8808:(e,t,l)=>{"use strict";l.d(t,{O:()=>n});var s=l(59051),i=l.n(s);const n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const l=t/3600;let s,n;l>=168?(s="weeks",n=l/168):l>=24?(s="days",n=l/24):l>=1?(s="hours",n=l):(s="minutes",n=t);return i()(e).add(n,s).toDate()}},28257:(e,t,l)=>{"use strict";l.d(t,{A:()=>m});l(9950);var s=l(84619),i=l(96011),n=l.n(i),a=l(63620);var o=l(91854),d=l(99674),r=l(59233),c=l(74635),u=l(44414);const v=a.bo?{componentRestrictions:{country:a.bo}}:{},m=e=>{let{value:t,setValue:l,setLocation:i,withLanguages:m=!0}=e;const{placePredictions:p,getPlacePredictions:h,isPlacePredictionsLoading:x}=(0,s.A)({apiKey:a.CJ,libraries:["places","geocode"],options:v}),{defaultLang:j,languages:A}=(0,o.d4)((e=>e.formLang),o.bN),g=()=>(0,u.jsx)(d.A,{allowClear:!0,searchValue:t,showSearch:!0,autoClearSearchValue:!0,loading:x,options:null===p||void 0===p?void 0:p.map((e=>({label:e.description,value:e.description}))),onSearch:e=>{l(e),e.length>0&&h({input:e})},onSelect:async e=>{const t=await async function(e){let t={address:e,key:arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.CJ};return n().get("https://maps.googleapis.com/maps/api/geocode/json",{params:t}).then((e=>{let{data:t}=e;return t.results[0]})).catch((e=>"not found"))}(e);i({lat:null===t||void 0===t?void 0:t.geometry.location.lat,lng:null===t||void 0===t?void 0:t.geometry.location.lng})},getPopupContainer:e=>e.parentNode});return m?(0,u.jsx)(u.Fragment,{children:A.map(((e,t)=>(0,u.jsx)(r.A.Item,{label:(0,c.t)("address"),name:`address[${e.locale}]`,rules:[{required:e.locale===j,message:(0,c.t)("required")}],hidden:e.locale!==j,children:g()},"address"+t)))}):(0,u.jsx)(r.A.Item,{label:(0,c.t)("address"),name:"address",rules:[{required:!0,message:(0,c.t)("required")}],children:g()})}},31281:(e,t,l)=>{"use strict";function s(e,t){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"title";const s=e.map((e=>({[e.locale]:""===t[`${l}[${e.locale}]`]?void 0:t[`${l}[${e.locale}]`]})));return Object.assign({},...s)}l.d(t,{A:()=>s})},39362:function(e,t){var l,s,i;s=[],void 0===(i="function"===typeof(l=function(){return function e(t,l,s){var i,n,a=window,o="application/octet-stream",d=s||o,r=t,c=!l&&!s&&r,u=document.createElement("a"),v=function(e){return String(e)},m=a.Blob||a.MozBlob||a.WebKitBlob||v,p=l||"download";if(m=m.call?m.bind(a):Blob,"true"===String(this)&&(d=(r=[r,d])[0],r=r[1]),c&&c.length<2048&&(p=c.split("/").pop().split("?")[0],u.href=c,-1!==u.href.indexOf(c))){var h=new XMLHttpRequest;return h.open("GET",c,!0),h.responseType="blob",h.onload=function(t){e(t.target.response,p,o)},setTimeout((function(){h.send()}),0),h}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(r)){if(!(r.length>2096103.424&&m!==v))return navigator.msSaveBlob?navigator.msSaveBlob(g(r),p):f(r);d=(r=g(r)).type||o}else if(/([\x80-\xff])/.test(r)){for(var x=0,j=new Uint8Array(r.length),A=j.length;x<A;++x)j[x]=r.charCodeAt(x);r=new m([j],{type:d})}function g(e){for(var t=e.split(/[:;,]/),l=t[1],s=("base64"==t[2]?atob:decodeURIComponent)(t.pop()),i=s.length,n=0,a=new Uint8Array(i);n<i;++n)a[n]=s.charCodeAt(n);return new m([a],{type:l})}function f(e,t){if("download"in u)return u.href=e,u.setAttribute("download",p),u.className="download-js-link",u.innerHTML="downloading...",u.style.display="none",document.body.appendChild(u),setTimeout((function(){u.click(),document.body.removeChild(u),!0===t&&setTimeout((function(){a.URL.revokeObjectURL(u.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,o)),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0;var l=document.createElement("iframe");document.body.appendChild(l),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,o)),l.src=e,setTimeout((function(){document.body.removeChild(l)}),333)}if(i=r instanceof m?r:new m([r],{type:d}),navigator.msSaveBlob)return navigator.msSaveBlob(i,p);if(a.URL)f(a.URL.createObjectURL(i),!0);else{if("string"===typeof i||i.constructor===v)try{return f("data:"+d+";base64,"+a.btoa(i))}catch(y){return f("data:"+d+","+encodeURIComponent(i))}(n=new FileReader).onload=function(e){f(this.result)},n.readAsDataURL(i)}return!0}})?l.apply(t,s):l)||(e.exports=i)},47992:(e,t,l)=>{"use strict";l.d(t,{G:()=>r});var s=l(9950),i=l(95491),n=l.n(i),a=l(99674),o=l(90650),d=l(44414);const r=e=>{let{fetchOptions:t,debounceTimeout:l=400,onClear:i,refetchOptions:r=!1,...c}=e;const[u,v]=(0,s.useState)(!1),[m,p]=(0,s.useState)([]),h=(0,s.useMemo)((()=>n()((e=>{p([]),v(!0),t(e).then((e=>{p(e),v(!1)}))}),l)),[t,l]);return(0,d.jsx)(a.A,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:h,onClear:()=>{h(""),i&&i()},notFoundContent:u?(0,d.jsx)(o.A,{size:"small"}):"no results",...c,options:m,onFocus:()=>{m.length&&!r||h("")}})}},51066:(e,t,l)=>{"use strict";l.d(t,{Q:()=>n});var s=l(17706),i=l(80415);const n=()=>{var e,t,l,n;return null!==(e=null===(t=s.M.getState())||void 0===t||null===(l=t.globalSettings)||void 0===l||null===(n=l.settings)||void 0===n?void 0:n.hour_format)&&void 0!==e?e:i.G}},53774:(e,t,l)=>{"use strict";function s(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"$",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"after";const l=Number(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,");return"after"===t?`${l} ${e}`:`${e} ${l}`}l.r(t),l.d(t,{default:()=>s})},66136:(e,t,l)=>{"use strict";l.d(t,{A:()=>i});var s=l(82371);const i={getAll:e=>s.A.get("rest/form-options",{params:e}),getById:e=>s.A.get(`rest/form-options/${e}`)}},74142:(e,t,l)=>{"use strict";l.d(t,{A:()=>n});var s=l(82371);const i="rest/services",n={getAll:e=>s.A.get(i,{params:e}),getById:(e,t)=>s.A.get(`${i}/${e}`,{params:t}),create:e=>s.A.post(i,e,{}),update:(e,t)=>s.A.put(`${i}/${e}`,t,{}),delete:e=>s.A.delete(`${i}/delete`,{params:e}),statusChange:(e,t)=>s.A.put(`${i}/${e}`,t)}},78498:(e,t,l)=>{"use strict";l.d(t,{A:()=>x});var s=l(9950),i=l(97239);const n=l.p+"static/media/pin.0e41858db80c699cd8a2.png";var a=l(96011),o=l.n(a),d=l(63620);async function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.CJ,l={latlng:`${null===e||void 0===e?void 0:e.lat},${null===e||void 0===e?void 0:e.lng}`,key:t};return o().get("https://maps.googleapis.com/maps/api/geocode/json",{params:l}).then((e=>{var t;let{data:l}=e;return null===(t=l.results[0])||void 0===t?void 0:t.formatted_address})).catch((e=>"not found"))}var c=l(39174),u=l(85923),v=l(70030),m=l(6566),p=l(44414);const h=(0,m.A)();const x=(0,i.GoogleApiWrapper)({apiKey:h,libraries:["places","geometry"]})((function(e){var t,l;const[a,o]=(0,s.useState)(),{t:d}=(0,v.B)(),m=async()=>{await navigator.geolocation.getCurrentPosition((function(e){const t={lat:e.coords.latitude,lng:e.coords.longitude};o(t)}),(function(e){u.oR.warning(d("turn.on.gps"))}))};(0,s.useEffect)((()=>{m()}),[]);const x=[{lat:Number(null===e||void 0===e||null===(t=e.location)||void 0===t?void 0:t.lat)||0,lng:Number(null===e||void 0===e||null===(l=e.location)||void 0===l?void 0:l.lng)||0}];for(var j=new e.google.maps.LatLngBounds,A=0;A<x.length;A++)j.extend(x[A]);return(0,p.jsxs)("div",{className:"map-container",style:{height:400,width:"100%"},children:[(0,p.jsx)("button",{className:"map-button",type:"button",onClick:()=>{m(),a&&(async t=>{const l={lat:null===t||void 0===t?void 0:t.lat,lng:null===t||void 0===t?void 0:t.lng};e.setLocation(l);const s=await r(l,h);e.setAddress(s)})(a)},children:(0,p.jsx)(c.uFi,{})}),(0,p.jsx)(i.Map,{cursor:"pointer",onClick:async(t,l,s)=>{const{latLng:i}=s,n={lat:i.lat(),lng:i.lng()};e.setLocation(n);const a=await r(n,h);e.setAddress(a)},google:e.google,defaultZoom:12,zoom:10,className:"clickable",initialCenter:e.location,center:e.location,children:(0,p.jsx)(i.Marker,{position:e.location,icon:{url:n,scaledSize:new e.google.maps.Size(32,32)},className:"marker"})})]})}))},80415:(e,t,l)=>{"use strict";l.d(t,{G:()=>a,HV:()=>i,LH:()=>s,PR:()=>n,wO:()=>d,xt:()=>o});const s={new:[1,2,3,4,5],accepted:[1,2,3,4,5],ready:[1,2,3,4,5],on_a_way:[1,2,3,4,5],delivered:[1,2,3,4,5],canceled:[1,2,3,4,5],cooking:[1,2,3,4,5]},i=(new Date,new Date,["new","accepted","ready","on_a_way","pause","delivered","canceled"]),n=30,a="HH:mm",o="hh:mm a",d=!0},85023:(e,t,l)=>{"use strict";l.d(t,{D:()=>o});var s=l(9950),i=l(99674),n=l(90650),a=l(44414);const o=e=>{let{fetchOptions:t,refetch:l=!1,value:o,...d}=e;const[r,c]=(0,s.useState)(!1),[u,v]=(0,s.useState)([]);"object"===typeof(null===o||void 0===o?void 0:o.label)&&null!==(null===o||void 0===o?void 0:o.label)&&(o.label=o.label.value);return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(i.A,{labelInValue:!0,filterOption:!1,notFoundContent:r?(0,a.jsx)(n.A,{size:"small"}):"no results",value:o,...d,options:r?[]:u,onFocus:()=>{u.length&&!l||(c(!0),t().then((e=>{v(e),c(!1)})))},getPopupContainer:e=>e.parentNode})})}},85217:(e,t,l)=>{"use strict";l.d(t,{It:()=>p,Ox:()=>v,_u:()=>m,dM:()=>u,hU:()=>c});l(13567),l(34996);var s=l(50686),i=l(74142),n=l(55660),a=l(53271),o=l(43957),d=l(39362),r=l.n(d);async function c(e){const t={search:e,perPage:10};return a.A.search(t).then((e=>{let{data:t}=e;return t.map((e=>({label:`${null===e||void 0===e?void 0:e.firstname} ${null===e||void 0===e?void 0:e.lastname}`,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id})))}))}async function u(e){let{service_id:t,shop_id:l,search:i}=e;const n={perPage:10,role:"master",search:null!==i&&void 0!==i&&i.length?i:void 0,service_id:t,shop_id:l};return s.A.getAll(n).then((e=>{let{data:t}=e;return t.map((e=>({label:`${null===e||void 0===e?void 0:e.firstname} ${null===e||void 0===e?void 0:e.lastname}`,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id})))}))}const v=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return await i.A.getAll(e).then((e=>{let{data:l}=e;return null===l||void 0===l?void 0:l.map((e=>{var l;return{label:null===e||void 0===e||null===(l=e.translation)||void 0===l?void 0:l.title,value:null===e||void 0===e?void 0:e.id,key:`${null===e||void 0===e?void 0:e.id} ${e.type}`,disabled:!(null===t||void 0===t||!t.length)&&!(null===t||void 0===t||!t.find((t=>{var l,s;return(null===t||void 0===t||null===(l=t.service_master)||void 0===l||null===(s=l.service)||void 0===s?void 0:s.id)===(null===e||void 0===e?void 0:e.id)})))}}))}))};async function m(e){const t={search:e,status:"approved"};return n.A.getAll(t).then((e=>{let{data:t}=e;return t.map((e=>{var t;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id,key:e.id}}))}))}async function p(e){return o.A.downloadInvoice(e).then((t=>r()(t,`booking-invoice-${e}.pdf`,"application/pdf")))}},90403:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>mt});var s=l(9950),i=l(81419),n=l(9083),a=l(82706),o=l(48538),d=l(74635),r=l(59051),c=l.n(r),u=l(95550),v=l(51066),m=l(44414);const p=()=>{var e;const t=(0,v.Q)(),{selectedSlots:l,isModalOpen:r,setIsModalOpen:p,setViewContent:h}=(0,s.useContext)(u.BookingContext),x=e=>{h(e),p(!1)};return(0,m.jsxs)(a.A,{title:`${null===(e=c()(null===l||void 0===l?void 0:l.start))||void 0===e?void 0:e.format(t)}`,visible:r,onOk:()=>{p(!1)},onCancel:()=>{p(!1)},width:280,footer:null,className:"calendar-modal",children:[(0,m.jsx)(o.A,{type:"text",className:"w-100",icon:(0,m.jsx)(i.A,{}),onClick:()=>x("addService"),style:{borderRadius:0,textAlign:"left",fontSize:16},children:(0,d.t)("add.booking")}),(0,m.jsx)(o.A,{type:"text",className:"w-100",icon:(0,m.jsx)(n.A,{}),onClick:()=>x("blockTime"),style:{borderRadius:0,textAlign:"left",fontSize:16},children:(0,d.t)("add.blocked.time")})]})};l(66379);var h=l(91854),x=l(1753),j=l(23263),A=l(90650),g=l(44071),f=l(43957),y=l(28429),_=l(48676);const b=()=>{const e=(0,y.Zp)(),t=(0,h.wA)(),l=(0,g.ye)(c()),i=(0,v.Q)(),{bookingList:n,loading:a}=(0,h.d4)((e=>e.booking)),{disabledTimes:o}=(0,h.d4)((e=>e.disabledTimes)),{infoForm:d,setIsLoading:r,setViewContent:p,setIsModalOpen:x,setSelectedSlots:b,setCalculatedData:w,setServiceData:C}=(0,s.useContext)(u.BookingContext),k=(0,s.useCallback)((t=>{if(t.disabled)return p("updateBlockTime"),void e(`?disabled_slot_id=${t.id}`);p("updateForm"),r(!0),e(`?service_id=${t.id}`),f.A.getBookingById(t.parent_id).then((e=>{var l,s,i,n,a,o,u,v,m,p,h,x,j,A,g,y,_,k,S,D,N,I,F,O,M,B,T,q,$;let{data:Y}=e;C(Y),b({start:Y[(null===Y||void 0===Y?void 0:Y.length)-1].start_date,end:Y[(null===Y||void 0===Y?void 0:Y.length)-1].end_date}),((e,t)=>{f.A.calculate({user_id:e.user_id,payment_id:e.payment_id,data:t.map((e=>({data:e.data,note:e.note,service_master_id:e.service_master.id,start_date:c().utc(null===e||void 0===e?void 0:e.start_date).format("YYYY-MM-DD HH:mm")}))),ids:e.ids}).then((e=>{let{data:l}=e;const s=l.items.map(((e,l)=>({...e,...t[l],booking_id:t[l].id,status:t[l].status,type:t[l].type,notes:t[l].notes})));w({...l,items:s})})).catch((e=>{console.error(e)})).finally((()=>r(!1)))})({user_id:null===(l=Y[0])||void 0===l?void 0:l.user_id,start:null===(s=Y[0])||void 0===s?void 0:s.start_date,payment_id:null===(i=Y[0])||void 0===i||null===(n=i.transaction)||void 0===n||null===(a=n.payment_system)||void 0===a?void 0:a.id,ids:Y.map((e=>e.id))},Y),d.setFieldsValue({id:t.parent_id,shop:{label:null===(o=Y[0])||void 0===o||null===(u=o.shop)||void 0===u||null===(v=u.translation)||void 0===v?void 0:v.title,value:null===(m=Y[0])||void 0===m||null===(p=m.shop)||void 0===p?void 0:p.id,key:null===(h=Y[0])||void 0===h||null===(x=h.shop)||void 0===x?void 0:x.id},client:{label:`${null===(j=Y[0])||void 0===j||null===(A=j.user)||void 0===A?void 0:A.firstname} ${null===(g=Y[0])||void 0===g||null===(y=g.user)||void 0===y?void 0:y.lastname}`,value:null===(_=Y[0])||void 0===_||null===(k=_.user)||void 0===k?void 0:k.id,key:null===(S=Y[0])||void 0===S||null===(D=S.user)||void 0===D?void 0:D.id},payment_id:{label:(null===(N=Y[0])||void 0===N||null===(I=N.transaction)||void 0===I||null===(F=I.payment_system)||void 0===F?void 0:F.tag)||"cash",value:null===(O=Y[0])||void 0===O||null===(M=O.transaction)||void 0===M||null===(B=M.payment_system)||void 0===B?void 0:B.id,key:null===(T=Y[0])||void 0===T||null===(q=T.transaction)||void 0===q||null===($=q.payment_system)||void 0===$?void 0:$.id}})})).catch((e=>{console.log(e)}))}),[]),{defaultDate:S,scrollToTime:D}=(0,s.useMemo)((()=>({defaultDate:new Date,scrollToTime:new Date})),[]);return(0,s.useEffect)((()=>{t((0,_.k1)({perPage:100}))}),[t]),(0,m.jsx)(j.A,{className:"h-100",children:(0,m.jsx)(A.A,{spinning:a,children:(0,m.jsx)(g.Vv,{localizer:l,startAccessor:"start",endAccessor:"end",defaultDate:S,events:[...n,...o],onSelectEvent:k,onSelectSlot:e=>{let{start:t,end:l}=e;x(!0),b({start:t,end:l})},selectable:!0,scrollToTime:D,timeslots:3,step:30,defaultView:"day",eventPropGetter:(e,t,l,s)=>e.disabled?{className:"disabled-slot"}:"",formats:{timeGutterFormat:i,eventTimeRangeFormat:e=>{let{start:t,end:l}=e;return`${c()(t).format(i)} - ${c()(l).format(i)}`}}})})})};var w=l(52695);const C=e=>{let{children:t,open:l,setOpen:i,footer:n}=e;const a=(0,y.Zp)(),{setCalculatedData:o}=(0,s.useContext)(u.BookingContext);return(0,m.jsx)(w.A,{onClose:()=>{i(""),a("/calendar"),o({})},visible:l,className:"drawer-view",width:600,headerStyle:{display:"none"},footer:n,destroyOnClose:!0,children:t})};var k=l(59233),S=l(55902),D=l(47992),N=l(8750),I=l(66362),F=l(87094),O=l(41988),M=l(99674),B=l(85217),T=l(40895),q=l(53774),$=l(24513),Y=l(54764);const V=e=>{var t,l,i,n,a,r,v,p,x,A,g,y,_,b,w,C,k,S,D,N;let{item:I}=e;const{setViewContent:F,serviceForm:O,service_id:M,setUpdateStatus:B,setSelectedMaster:V,setSelectedService:L}=(0,s.useContext)(u.BookingContext),{defaultCurrency:H}=(0,h.d4)((e=>e.currency),h.bN),P=e=>{M&&(F("updateService"),V(I),f.A.getById(e).then((t=>{var l,s,i,n,a,o,r,u,v,m,p,h,x,j,A,g,f,y,_;let{data:b}=t;var w,C;null!==b&&void 0!==b&&null!==(l=b.service_master)&&void 0!==l&&null!==(s=l.service)&&void 0!==s&&s.id&&(e=>{Y.A.getById(e).then((e=>{L(e.data)})).catch((e=>{console.log(e)}))})(null===b||void 0===b||null===(w=b.service_master)||void 0===w||null===(C=w.service)||void 0===C?void 0:C.id);O.setFieldsValue({id:e,shop:{key:null===b||void 0===b||null===(i=b.shop)||void 0===i?void 0:i.id,value:null===b||void 0===b||null===(n=b.shop)||void 0===n?void 0:n.id,label:null===b||void 0===b||null===(a=b.shop)||void 0===a||null===(o=a.translation)||void 0===o?void 0:o.title},service:{key:null===b||void 0===b||null===(r=b.service_master)||void 0===r||null===(u=r.service)||void 0===u?void 0:u.id,value:null===b||void 0===b||null===(v=b.service_master)||void 0===v||null===(m=v.service)||void 0===m?void 0:m.id,label:null===b||void 0===b||null===(p=b.service_master)||void 0===p||null===(h=p.service)||void 0===h||null===(x=h.translation)||void 0===x?void 0:x.title},extras:null!==b&&void 0!==b&&null!==(j=b.extras)&&void 0!==j&&j.length?null===b||void 0===b||null===(A=b.extras)||void 0===A?void 0:A.map((e=>{var t;return{key:null===e||void 0===e?void 0:e.service_extra_id,value:null===e||void 0===e?void 0:e.service_extra_id,label:(null===e||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title)||(0,d.t)("N/A")}})):[],master:{key:null===b||void 0===b||null===(g=b.master)||void 0===g?void 0:g.id,value:null===b||void 0===b||null===(f=b.master)||void 0===f?void 0:f.id,label:`${null===b||void 0===b||null===(y=b.master)||void 0===y?void 0:y.firstname} ${null===b||void 0===b||null===(_=b.master)||void 0===_?void 0:_.lastname}`},end_date:c()(null===b||void 0===b?void 0:b.end_date).utc(),start_date:c()(null===b||void 0===b?void 0:b.start_date).utc(),note:null===b||void 0===b?void 0:b.note})})).catch((e=>{console.log(e)})))};return(0,m.jsx)(j.A,{className:`service-card ${Boolean((null===(t=I.errors)||void 0===t?void 0:t.length)>0)&&!M&&"error"}`,children:(0,m.jsxs)("ul",{className:"mb-0",children:[(0,m.jsxs)("li",{className:"mb-3 flex justify-content-between gap-2",children:[(0,m.jsx)("strong",{className:"font-size-5",children:null===(l=I.service_master)||void 0===l||null===(i=l.service)||void 0===i||null===(n=i.translation)||void 0===n?void 0:n.title}),(0,m.jsx)(o.A,{icon:(0,m.jsx)($.A,{}),onClick:()=>P(I.booking_id),children:(0,d.t)("edit")})]}),(0,m.jsx)("li",{children:`${c().parseZone(null===I||void 0===I?void 0:I.start_date).format("LT")} - ${c().parseZone(I.end_date).format("LT")} (${null===I||void 0===I||null===(a=I.service_master)||void 0===a?void 0:a.interval}min + ${null===I||void 0===I||null===(r=I.service_master)||void 0===r?void 0:r.pause}min processing time)`}),(null===I||void 0===I?void 0:I.status)&&(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("status"),":"]}),(0,d.t)(null===I||void 0===I?void 0:I.status)," ",(0,m.jsx)($.A,{onClick:e=>(e=>{e.stopPropagation(),B({status:I.status,booking_id:I.booking_id})})(e),className:"edit-icon"})]}),(null===I||void 0===I?void 0:I.type)&&(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("type"),":"]}),(0,d.t)(null===I||void 0===I?void 0:I.type)]}),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("shop"),":"]}),(0,d.t)(null===I||void 0===I||null===(v=I.shop)||void 0===v||null===(p=v.translation)||void 0===p?void 0:p.title)]}),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("master.fullname"),":"]}),(0,d.t)(null===I||void 0===I||null===(x=I.master)||void 0===x?void 0:x.full_name)]}),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("service.name"),":"]}),(0,d.t)(null===I||void 0===I||null===(A=I.service_master)||void 0===A||null===(g=A.service)||void 0===g||null===(y=g.translation)||void 0===y?void 0:y.title)]}),!(null===I||void 0===I||null===(_=I.extras)||void 0===_||!_.length)&&(null===I||void 0===I||null===(b=I.extras)||void 0===b?void 0:b.map((e=>{var t;return(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("extra"),":"]}),(0,d.t)(null===e||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title)," -"," ",(0,q.default)(null===e||void 0===e?void 0:e.price,null===H||void 0===H?void 0:H.symbol,null===H||void 0===H?void 0:H.position)]})}))),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("client"),":"]}),(0,d.t)(null===I||void 0===I||null===(w=I.user)||void 0===w?void 0:w.full_name)]}),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("payment.type"),":"]}),(0,d.t)((null===I||void 0===I||null===(C=I.transaction)||void 0===C||null===(k=C.payment_system)||void 0===k?void 0:k.tag)||"cash")]}),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("transaction.status"),":"]}),(0,d.t)((null===I||void 0===I||null===(S=I.transaction)||void 0===S?void 0:S.status)||"progress")]}),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("commission.fee"),":"]}),(0,q.default)(null===I||void 0===I?void 0:I.commission_fee,null===H||void 0===H?void 0:H.symbol,null===H||void 0===H?void 0:H.position)]}),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("discount"),":"]}),(0,q.default)(null===I||void 0===I?void 0:I.discount,null===H||void 0===H?void 0:H.symbol,null===H||void 0===H?void 0:H.position)]}),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("gift.cart.price"),":"]}),(0,q.default)(null===I||void 0===I?void 0:I.gift_cart_price,null===H||void 0===H?void 0:H.symbol,null===H||void 0===H?void 0:H.position)]}),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("service.fee"),":"]}),(0,q.default)(null===I||void 0===I?void 0:I.service_fee,null===H||void 0===H?void 0:H.symbol,null===H||void 0===H?void 0:H.position)]}),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("service.master.price"),":"]}),(0,q.default)(null===I||void 0===I?void 0:I.service_master.price,null===H||void 0===H?void 0:H.symbol,null===H||void 0===H?void 0:H.position)]}),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("extras.price"),":"]}),(0,q.default)(null!==(D=null===I||void 0===I?void 0:I.extra_price)&&void 0!==D?D:0,null===H||void 0===H?void 0:H.symbol,null===H||void 0===H?void 0:H.position)]}),(0,m.jsx)(T.A,{}),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("strong",{children:[(0,d.t)("total.price"),":"]}),(0,q.default)(null===I||void 0===I?void 0:I.total_price,null===H||void 0===H?void 0:H.symbol,null===H||void 0===H?void 0:H.position)]}),!M&&(0,m.jsx)("div",{className:"error-list",children:null===(N=I.errors)||void 0===N?void 0:N.map(((e,t)=>(0,m.jsx)("li",{children:e},t)))})]})})};var L=l(40577),H=l(70030),P=l(53271),E=l(85923);const R=e=>{var t,l;let{isOpen:i,handleCancel:n}=e;const{t:d}=(0,H.B)(),[r]=k.A.useForm(),{infoForm:c}=(0,s.useContext)(u.BookingContext),[v,p]=(0,s.useState)(null),[h,x]=(0,s.useState)(!1),j=()=>{r.resetFields(),p(null),n()};return(0,m.jsx)(a.A,{title:d("create.user"),visible:i,onCancel:j,footer:[(0,m.jsx)(o.A,{type:"primary",loading:h,onClick:()=>r.submit(),children:d("save")},"ok-button"),(0,m.jsx)(o.A,{onClick:j,children:d("cancel")},"cancel-button")],children:(0,m.jsx)(k.A,{layout:"vertical",name:"create-user-form",form:r,onFinish:e=>{x(!0);const t={...e,role:"user"};P.A.create(t).then((e=>{let{data:t}=e;const l={label:`${(null===t||void 0===t?void 0:t.firstname)||""} ${(null===t||void 0===t?void 0:t.lastname)||""}`,value:null===t||void 0===t?void 0:t.id,key:null===t||void 0===t?void 0:t.id,disabled:void 0};c.setFieldsValue({client:l}),E.oR.success(d("successfully.added")),j()})).catch((e=>p(e.response.data.params))).finally((()=>x(!1)))},children:(0,m.jsxs)(F.A,{gutter:12,children:[(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{label:d("firstname"),name:"firstname",help:null!==v&&void 0!==v&&v.firstname?null===(t=v.firstname)||void 0===t?void 0:t[0]:null,validateStatus:null!==v&&void 0!==v&&v.firstname?"error":"success",rules:[{required:!0,message:d("required")}],children:(0,m.jsx)(S.A,{})})}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{label:d("lastname"),name:"lastname",help:null!==v&&void 0!==v&&v.lastname?null===v||void 0===v||null===(l=v.lastname)||void 0===l?void 0:l[0]:null,validateStatus:null!==v&&void 0!==v&&v.lastname?"error":"success",rules:[{required:!0,message:d("required")}],children:(0,m.jsx)(S.A,{})})}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{label:d("phone"),name:"phone",help:null!==v&&void 0!==v&&v.phone?v.phone[0]:null,validateStatus:null!==v&&void 0!==v&&v.phone?"error":"success",rules:[{required:!0,message:d("required")}],children:(0,m.jsx)(L.A,{min:0,className:"w-100"})})}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{label:d("email"),name:"email",help:null!==v&&void 0!==v&&v.email?v.email[0]:null,validateStatus:null!==v&&void 0!==v&&v.email?"error":"success",rules:[{required:!0,message:d("required")},{type:"email",message:d("invalid.email")}],children:(0,m.jsx)(S.A,{type:"email"})})})]})})})},{Title:U}=I.A,z=e=>{var t;let{isDisabled:l,title:i="new.booking",isAdd:n=!1}=e;const{t:a}=(0,H.B)(),{calculatedData:d,setViewContent:r,setInfoData:c,infoForm:v,service_id:p}=(0,s.useContext)(u.BookingContext),[h,x]=(0,s.useState)(!1),[j,A]=(0,s.useState)(!1);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(F.A,{gutter:12,children:[(0,m.jsxs)(O.A,{span:24,className:"mb-4 d-flex justify-content-between align-items-center",children:[(0,m.jsx)(U,{level:2,children:a(i)}),!!p&&(0,m.jsx)(o.A,{htmlType:"button",onClick:async()=>{A(!0),await(0,B.It)(p).finally((()=>{A(!1)}))},loading:j,children:a("download.invoice")})]}),(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"shop",label:a("select.shop"),placeholder:a("select.shop"),rules:[{required:!0,message:a("required")}],children:(0,m.jsx)(D.G,{disabled:!n,className:"w-100",fetchOptions:B._u})})}),(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"client",label:a("select.client"),placeholder:a("select.client"),rules:[{required:!0,message:a("required")}],children:(0,m.jsx)(D.G,{fetchOptions:B.hU,style:{width:"100%"},refetchOptions:!0,disabled:!n})})}),(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"payment_id",rules:[{required:!0,message:a("required")}],label:a("payment"),children:(0,m.jsx)(M.A,{disabled:!n,placeholder:a("select.payment.type"),children:(0,m.jsx)(M.A.Option,{value:1,children:a("cash")})})})}),null===d||void 0===d||null===(t=d.items)||void 0===t?void 0:t.map((e=>(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(V,{item:e})},e.id))),n&&(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(o.A,{block:!0,type:"dashed",icon:(0,m.jsx)(N.A,{}),disabled:l,onClick:()=>{c(null===v||void 0===v?void 0:v.getFieldsValue()),r("serviceForm")},children:a("add.service")})})]}),(0,m.jsx)(R,{isOpen:h,handleCancel:()=>x(!1)})]})},G=()=>{const{infoForm:e,setCalculatedData:t,setIsUpdate:l,setOpenService:i,isLoalding:n,calculatedData:a}=(0,s.useContext)(u.BookingContext),o=k.A.useWatch("client",e),d=k.A.useWatch("payment_id",e);return(0,m.jsx)(A.A,{spinning:n,children:(0,m.jsxs)(k.A,{form:e,layout:"vertical",onFinish:s=>{const i={user_id:s.client.value,payment_id:s.payment_id.value,data:null===a||void 0===a?void 0:a.items.map((e=>{var t;return{note:e.note,data:e.data,service_master_id:null===(t=e.service_master)||void 0===t?void 0:t.id}})),start_date:null===a||void 0===a?void 0:a.start_date};f.A.update(s.id,i).then((()=>{l(!1),e.resetFields(),t({})})).catch((e=>{console.error(e)}))},children:[(0,m.jsx)(k.A.Item,{name:"id",className:"d-none",children:(0,m.jsx)(S.A,{})}),(0,m.jsx)(z,{title:"update.booking",setOpenService:i,isDisabled:!(o&&d)})]})})};var W=l(12916),K=l(86971),Z=l(85023),Q=l(35821),J=l(80415);const{Title:X}=I.A,ee=e=>{var t,l;let{shop:s,setViewContent:i,getServiceByID:n,getMasterByID:a,selectedService:o,form:r}=e;return(0,m.jsxs)(F.A,{gutter:12,children:[(0,m.jsxs)(O.A,{span:24,children:[(0,m.jsx)(W.A,{icon:(0,m.jsx)(Q.A,{}),onClick:()=>{r.resetFields(),i("updateForm")}}),(0,m.jsx)(X,{className:"my-4",level:2,children:(0,d.t)("edit.service")})]}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{name:"shop",label:(0,d.t)("select.shop"),placeholder:(0,d.t)("select.shop"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,m.jsx)(Z.D,{disabled:!0,className:"w-100",fetchOptions:B._u})})}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{name:"service",label:(0,d.t)("select.service"),placeholder:(0,d.t)("select.service"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,m.jsx)(Z.D,{refetch:!0,disabled:!s,className:"w-100",onChange:e=>{n(e),r.setFieldsValue({extras:[]})},fetchOptions:()=>(0,B.Ox)({shop_id:s.value})})})}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{name:"extras",label:(0,d.t)("select.service.extras"),children:(0,m.jsx)(M.A,{disabled:!(null!==o&&void 0!==o&&null!==(t=o.service_extras)&&void 0!==t&&t.length),options:null===o||void 0===o||null===(l=o.service_extras)||void 0===l?void 0:l.map((e=>{var t;return{label:(null===e||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title)||(0,d.t)("N/A"),value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}})),labelInValue:!0,placeholder:(0,d.t)("select.extra"),mode:"multiple"})})}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{name:"master",label:(0,d.t)("select.master"),placeholder:(0,d.t)("select.master"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,m.jsx)(Z.D,{refetch:!0,className:"w-100",disabled:!o,onChange:e=>a(e),fetchOptions:()=>(0,B.dM)({shop_id:null===s||void 0===s?void 0:s.value,service_id:null===o||void 0===o?void 0:o.id})})})}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{label:(0,d.t)("start.date"),name:"start_date",rules:[{required:!0,message:(0,d.t)("required")}],children:(0,m.jsx)(K.A,{format:`YYYY-MM-DD ${J.xt}`,use12Hours:J.wO,className:"w-100",showTime:!0})})}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{label:(0,d.t)("end.date"),name:"end_date",rules:[{required:!0,message:(0,d.t)("required")}],children:(0,m.jsx)(K.A,{format:`YYYY-MM-DD ${J.xt}`,use12Hours:J.wO,className:"w-100",showTime:!0})})}),(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"note",label:(0,d.t)("note"),rules:[{required:!1,message:(0,d.t)("required")}],children:(0,m.jsx)(S.A.TextArea,{})})})]})};var te=l(50686);const le=()=>{const e=(0,h.wA)(),{serviceForm:t,setCalculatedData:l,setViewContent:i,isLoalding:n,selectedService:a,setSelectedService:o,selectedMaster:d,setSelectedMaster:r}=(0,s.useContext)(u.BookingContext),v=k.A.useWatch("shop",t);return(0,m.jsx)(A.A,{spinning:n,children:(0,m.jsxs)(k.A,{form:t,layout:"vertical",onFinish:s=>{var n,a,o;const r={note:null===s||void 0===s?void 0:s.note,service_master_id:null===d||void 0===d||null===(n=d.service_master)||void 0===n?void 0:n.id,end_date:c()(s.end_date).format("YYYY-MM-DD HH:mm"),start_date:c()(s.start_date).format("YYYY-MM-DD HH:mm"),service_extras:null!==s&&void 0!==s&&null!==(a=s.extras)&&void 0!==a&&a.length?null===s||void 0===s||null===(o=s.extras)||void 0===o?void 0:o.map((e=>e.value)):void 0};f.A.update(s.id,r).then((()=>{i(""),t.resetFields(),l({}),e((0,x.ww)({}))})).catch((e=>{console.error(e)}))},children:[(0,m.jsx)(k.A.Item,{name:"id",className:"d-none",children:(0,m.jsx)(S.A,{})}),(0,m.jsx)(ee,{form:t,shop:v,setViewContent:i,getMasterByID:e=>{te.A.getById(e.value).then((e=>{let{data:t}=e;const l=null===t||void 0===t?void 0:t.service_masters.find((e=>e.service_id===a.id));r({...t,service_master:l})})).catch((e=>{console.log(e)}))},getServiceByID:e=>{Y.A.getById(e.value).then((e=>{o(e.data)})).catch((e=>{console.log(e)}))},selectedService:a})]})})};var se=l(44070),ie=l(92759),ne=l(78003);const{useContext:ae,useState:oe}=l(9950),{BookingContext:de}=l(95550),{default:re}=l(53774),ce=()=>{const e=(0,h.wA)(),[t,l]=oe(),{calculatedData:s,sumInterval:i,service_id:n,setViewContent:a}=ae(de);return(0,m.jsxs)("div",{className:"w-100 d-flex between my-2",children:[(0,m.jsx)(ne.A,{title:(0,d.t)("delete.the.booking"),onConfirm:()=>{l(!0),f.A.delete({"ids[0]":n}).then((()=>{a(""),e((0,x.ww)()),ie.Ay.success((0,d.t)("booking.successfully.delete"))})).catch((e=>{console.log(e)})).finally((()=>l(!1)))},okText:(0,d.t)("yes"),cancelText:(0,d.t)("no"),children:(0,m.jsx)(o.A,{loading:t,type:"danger",icon:(0,m.jsx)(se.A,{})})}),(0,m.jsxs)("div",{className:"d-flex gap-2 my-2",children:[(0,m.jsxs)("strong",{className:"font-size-5",children:[(0,d.t)("total"),":"]}),(0,m.jsx)("strong",{className:"font-size-5 text-nowrap",children:`${re(null===s||void 0===s?void 0:s.total_price)} (${i}min)`})]})]})},ue=()=>{const{infoForm:e,setCalculatedData:t,selectedSlots:l,calculatedData:i,setViewContent:n}=(0,s.useContext)(u.BookingContext),a=(0,h.wA)(),o=k.A.useWatch("client",e),d=k.A.useWatch("payment_id",e);return(0,m.jsx)(k.A,{form:e,layout:"vertical",onFinish:l=>{f.A.create({user_id:l.client.value,payment_id:l.payment_id.value,data:null===i||void 0===i?void 0:i.items.map((e=>{var t,l,s,i;return{note:null!==e&&void 0!==e&&null!==(t=e.note)&&void 0!==t&&t.length?null===e||void 0===e?void 0:e.note:void 0,data:e.data,service_master_id:null===e||void 0===e||null===(l=e.service_master)||void 0===l?void 0:l.id,service_extras:null!==e&&void 0!==e&&null!==(s=e.extras)&&void 0!==s&&s.length?null===e||void 0===e||null===(i=e.extras)||void 0===i?void 0:i.map((e=>null===e||void 0===e?void 0:e.id)):void 0,start_date:e.start_date}}))}).then((()=>{n(""),t({}),e.resetFields(),a((0,x.ww)())})).catch((e=>{console.error(e)}))},children:(0,m.jsx)(z,{isAdd:!0,isDisabled:!(o&&d)})})},ve=()=>{const{calculatedData:e,infoForm:t,setCalculatedData:l,sumInterval:i,setViewContent:n}=(0,s.useContext)(u.BookingContext);return(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{className:"w-100 d-flex between my-2",children:[(0,m.jsx)("strong",{className:"font-size-5",children:"Total"}),(0,m.jsx)("strong",{className:"font-size-5",children:`${(0,q.default)(null===e||void 0===e?void 0:e.total_price)} (${i||0}min)`})]}),(0,m.jsxs)("div",{className:"w-100 d-flex gap-2",children:[(0,m.jsx)(o.A,{type:"primary",className:"w-100",onClick:t.submit,disabled:!(null!==e&&void 0!==e&&e.status),children:(0,d.t)("checkout")}),(0,m.jsx)(o.A,{type:"danger",className:"w-100",onClick:()=>{n(""),t.resetFields(),l({})},children:(0,d.t)("cancel")})]})]})};var me=l(63620),pe=l(8808),he=l(78498),xe=l(28257);const{Title:je}=I.A,Ae=e=>{var t,l,i;let{shop:n,setOpen:a,getServiceByID:r,getMasterByID:p,selectedService:h,form:x,location:j,setLocation:A,value:g,setValue:f,defaultLang:y,masterTimes:_}=e;const{calculatedData:b}=(0,s.useContext)(u.BookingContext),w=(0,v.Q)(),C=k.A.useWatch("start_date_date",x),D=k.A.useWatch("master",x),N=c()(new Date);return(0,m.jsxs)(F.A,{gutter:10,children:[(0,m.jsxs)(O.A,{span:24,children:[(0,m.jsx)(W.A,{icon:(0,m.jsx)(Q.A,{}),onClick:()=>{a("addService"),x.resetFields()}}),(0,m.jsx)(je,{className:"my-4",level:2,children:(0,d.t)("select.service")})]}),(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"service",label:(0,d.t)("select.service"),placeholder:(0,d.t)("select.service"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,m.jsx)(Z.D,{refetch:!0,disabled:!n,className:"w-100",onChange:e=>{r(e),x.setFieldsValue({extras:[]})},fetchOptions:()=>(0,B.Ox)({shop_id:n.value},null===b||void 0===b?void 0:b.items)})})}),(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"extras",label:(0,d.t)("select.service.extras"),children:(0,m.jsx)(M.A,{disabled:!(null!==h&&void 0!==h&&null!==(t=h.service_extras)&&void 0!==t&&t.length),options:null===h||void 0===h||null===(l=h.service_extras)||void 0===l?void 0:l.map((e=>{var t;return{label:(null===e||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title)||(0,d.t)("N/A"),value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}})),labelInValue:!0,placeholder:(0,d.t)("select.extra"),mode:"multiple"})})}),(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"master",label:(0,d.t)("select.master"),placeholder:(0,d.t)("select.master"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,m.jsx)(Z.D,{refetch:!0,className:"w-100",disabled:!h,onChange:e=>{p(e),x.setFieldsValue({start_date_date:void 0,start_date_time:void 0})},fetchOptions:()=>(0,B.dM)({shop_id:null===n||void 0===n?void 0:n.value,service_id:null===h||void 0===h?void 0:h.id})})})}),(0,m.jsx)(O.A,{span:16,children:(0,m.jsx)(k.A.Item,{name:"start_date_date",label:(0,d.t)("start.date"),placeholder:(0,d.t)("select.start.date"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,m.jsx)(K.A,{disabled:!_||!D,disabledDate:e=>new Date(e)<=c()().subtract(1,"days"),onChange:()=>{x.setFieldsValue({start_date_time:void 0})},className:"w-100"})})}),(0,m.jsx)(O.A,{span:8,children:(0,m.jsx)(k.A.Item,{name:"start_date_time",label:(0,d.t)("start.time"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,m.jsx)(M.A,{placeholder:(0,d.t)("select.start.time"),disabled:!C,options:null===(i=(()=>{const e=_[null===C||void 0===C?void 0:C.format("YYYY-MM-DD")]||[];return N.format("YYYY-MM-DD")===(null===C||void 0===C?void 0:C.format("YYYY-MM-DD"))?e.filter((e=>c()(e,"HH:mm").isAfter(c()(new Date)))):e})())||void 0===i?void 0:i.map((e=>({label:c()(e,"HH:mm").format(w),value:e})))})})}),(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"note",label:(0,d.t)("note"),rules:[{required:!1,message:(0,d.t)("required")}],children:(0,m.jsx)(S.A.TextArea,{})})}),Boolean("offline_out"===(null===h||void 0===h?void 0:h.type))&&(0,m.jsxs)(O.A,{span:24,children:[(0,m.jsx)(xe.A,{value:g,setValue:f,setLocation:A}),(0,m.jsx)(he.A,{location:j,setLocation:A,setAddress:e=>{x.setFieldsValue({[`address[${y}]`]:e})}})]}),(0,m.jsx)(O.A,{span:24,className:"mt-4",children:(0,m.jsx)(o.A,{type:"primary",htmlType:"submit",className:"w-100",children:(0,d.t)("submit")})})]})},ge=()=>{const e=(0,h.wA)(),[t]=k.A.useForm(),{infoData:l,selectedSlots:i,setViewContent:n,calculatedData:a,setCalculatedData:o}=(0,s.useContext)(u.BookingContext),{defaultLang:d}=(0,h.d4)((e=>e.formLang)),{bookingList:r}=(0,h.d4)((e=>e.booking)),[v,p]=(0,s.useState)(null),[j,A]=(0,s.useState)(null),[g,y]=(0,s.useState)(me.Jb),[_,b]=(0,s.useState)([]),[w,C]=(0,s.useState)(""),S=null===l||void 0===l?void 0:l.shop;return(0,m.jsx)(k.A,{layout:"vertical",form:t,onFinish:s=>{var c,u,m;let p=[];null!==a&&void 0!==a&&a.items&&(p=null===a||void 0===a||null===(c=a.items)||void 0===c?void 0:c.map((e=>{var t,l;return{...e,service_extras:null!==e&&void 0!==e&&null!==(t=e.extras)&&void 0!==t&&t.length?null===e||void 0===e||null===(l=e.extras)||void 0===l?void 0:l.map((e=>null===e||void 0===e?void 0:e.id)):void 0}})));const h={note:s.note,data:{address:s[`address[${d}]`],...g},service_master:null===j||void 0===j?void 0:j.service_master,service_extras:null!==s&&void 0!==s&&null!==(u=s.extras)&&void 0!==u&&u.length?null===s||void 0===s||null===(m=s.extras)||void 0===m?void 0:m.map((e=>null===e||void 0===e?void 0:e.value)):void 0,start_date:`${s.start_date_date.format("YYYY-MM-DD")} ${s.start_date_time}`};var A;(A=[...p,h],f.A.calculate({user_id:l.client.value,payment_id:l.payment_id.value,data:A.map((e=>{var t;return{note:e.note,data:e.data,service_master_id:null===(t=e.service_master)||void 0===t?void 0:t.id,service_extras:null===e||void 0===e?void 0:e.service_extras,start_date:e.start_date}}))})).then((l=>{let{data:s}=l;t.resetFields(),(()=>{let t=(0,pe.O)(i.start,null===v||void 0===v?void 0:v.interval);var l,s;r.length>0?(t=(0,pe.O)(null===r||void 0===r||null===(l=r[r.length-1])||void 0===l?void 0:l.end,null===r||void 0===r||null===(s=r[r.length-1])||void 0===s?void 0:s.pause),e((0,x.lZ)({id:v.id,pause:v.pause,title:v.translation.title,start:t,end:(0,pe.O)(t,null===v||void 0===v?void 0:v.interval)}))):e((0,x.lZ)({id:v.id,pause:v.pause,title:v.translation.title,start:new Date(i.start),end:t}))})(),o(s),n("addService")})).catch((e=>{console.log(e)}))},children:(0,m.jsx)(Ae,{shop:S,form:t,setOpen:n,location:g,setLocation:y,getMasterByID:e=>{te.A.getById(e.value).then((e=>{let{data:t}=e;const l=null===t||void 0===t?void 0:t.service_masters.find((e=>e.service_id===v.id));A({...t,service_master:l}),te.A.getTimes({service_master_ids:[null===l||void 0===l?void 0:l.id],start_date:c()(null===i||void 0===i?void 0:i.start).format("YYYY-MM-DD HH:mm")}).then((e=>{var t;let{data:l}=e;b(Object.fromEntries(null===l||void 0===l||null===(t=l[0])||void 0===t?void 0:t.times.map((e=>[e.date,e.times]))))}))})).catch((e=>{console.log(e)}))},getServiceByID:e=>{Y.A.getById(e.value).then((e=>{p(e.data)})).catch((e=>{console.log(e)}))},selectedService:v,value:w,setValue:C,defaultLang:d,masterTimes:_})})},{useContext:fe}=l(9950),{BookingContext:ye}=l(95550),{Button:_e}=l(30628),be=()=>{const{serviceForm:e}=fe(ye);return(0,m.jsx)("div",{className:"d-flex gap-2",children:(0,m.jsx)(_e,{type:"primary",className:"w-100",onClick:e.submit,children:(0,d.t)("apply")})})};var we=l(99985);const{Title:Ce}=I.A,ke=()=>{var e,t;const[l]=k.A.useForm(),[i,n]=(0,s.useState)(!1),{service_id:a,calculatedData:r,setCalculatedData:c}=(0,s.useContext)(u.BookingContext),v=null===r||void 0===r||null===(e=r.items)||void 0===e?void 0:e.find((e=>e.booking_id===Number(a)));return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(Ce,{level:2,children:(0,d.t)("notes")}),null===v||void 0===v||null===(t=v.notes)||void 0===t?void 0:t.map((e=>(0,m.jsx)(we.A,{message:e,className:"mb-2"}))),(0,m.jsxs)(k.A,{form:l,onFinish:e=>{n(!0),f.A.updateNote(a,e).then((e=>{let{data:t}=e;l.resetFields(),c((e=>{var l;return{...e,items:null===r||void 0===r||null===(l=r.items)||void 0===l?void 0:l.map((e=>e.booking_id===Number(a)?{...e,notes:t.notes}:e))}}))})).catch((e=>{console.log(e)})).finally((()=>n(!1)))},layout:"vertical",className:"mt-5",children:[(0,m.jsx)(k.A.Item,{name:"note",rules:[{required:!0}],label:"add.note",children:(0,m.jsx)(S.A.TextArea,{})}),(0,m.jsx)(o.A,{htmlType:"submit",type:"primary",loading:i,children:(0,d.t)("submit")})]})]})};var Se=l(95749),De=l(47738),Ne=l(19826),Ie=l(12534),Fe=l(69216);function Oe(e,t,l,s){return{key:t,icon:l,children:s,label:e}}const Me=()=>{const{setViewContent:e,service_id:t}=(0,s.useContext)(u.BookingContext),l=[Oe("Info",t?"updateForm":"addService",(0,m.jsx)(Se.A,{})),Oe("Forms","forms",(0,m.jsx)(De.A,{})),Oe("Activity","activity",(0,m.jsx)(Ne.A,{})),Oe("Notes","notes",(0,m.jsx)(Ie.A,{}))];return(0,m.jsx)("div",{className:"content-menu",children:(0,m.jsx)(Fe.A,{mode:"inline",items:l,defaultSelectedKeys:["info"],onClick:t=>(t=>{e(t.key)})(t)})})};var Be=l(90247);const{Title:Te,Text:qe}=I.A,$e=()=>{var e,t;const{setIsAddForm:l,calculatedData:i,setFormDetailId:n}=(0,s.useContext)(u.BookingContext),a=null===i||void 0===i||null===(e=i.items)||void 0===e?void 0:e.flatMap((e=>e.data.form||[]));return(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{className:"d-flex between",children:[(0,m.jsx)(Te,{children:(0,d.t)("forms")}),(0,m.jsx)(o.A,{type:"text",size:"large",onClick:()=>l(!0),children:(0,d.t)("add.form")})]}),0===(null===a||void 0===a?void 0:a.length)&&(0,m.jsx)(j.A,{children:(0,m.jsx)(Be.A,{image:Be.A.PRESENTED_IMAGE_SIMPLE,description:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("strong",{children:"No client forms added yet."})," ",(0,m.jsx)("br",{})," Forms will appear here if required by any services in the appointment or if added manually."]})})}),null===i||void 0===i||null===(t=i.items)||void 0===t?void 0:t.map((e=>{var t;return e.data.form&&(0,m.jsx)("div",{children:null===(t=e.data.form)||void 0===t?void 0:t.map((e=>{var t;return(0,m.jsxs)(j.A,{children:[(0,m.jsx)(qe,{type:"secondary",children:c()().format("ddd Do MMM, h:mm a")}),(0,m.jsxs)(qe,{type:"success",className:"ml-2",children:["\u2022 ",(0,d.t)("complated")]}),(0,m.jsx)(Te,{level:4,className:"mt-2",children:null===e||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title}),(0,m.jsx)(o.A,{onClick:()=>n(e.id),children:(0,d.t)("view.form")})]},null===e||void 0===e?void 0:e.id)}))},e.id)}))]})};var Ye=l(98252);const{Title:Ve}=I.A,Le=()=>{var e,t;const{serviceData:l,service_id:i}=(0,s.useContext)(u.BookingContext),n=null===l||void 0===l?void 0:l.find((e=>e.id==i)),a=Boolean(!(null!==n&&void 0!==n&&null!==(e=n.activities)&&void 0!==e&&e.length));return(0,m.jsxs)("div",{className:"h-100",children:[(0,m.jsx)(Ve,{children:(0,d.t)("activities")}),null===n||void 0===n||null===(t=n.activities)||void 0===t?void 0:t.map((e=>{var t;return(0,m.jsxs)(j.A,{className:"mb-2",children:[(0,m.jsx)(j.A.Meta,{avatar:(0,m.jsx)(Ye.A,{src:null===(t=e.user)||void 0===t?void 0:t.img,size:"large"}),title:e.user.firstname,description:c()(e.created_at).format("MMMM Do YYYY, h:mm a")}),(0,m.jsx)(j.A.Meta,{description:e.note,className:"mt-3"})]},e.id)})),a&&(0,m.jsx)(Be.A,{description:(0,d.t)("activities.not.found")})]})};var He=l(57796),Pe=l(52765);const Ee=[{label:"M",value:"monday"},{label:"T",value:"tuesday"},{label:"W",value:"wednesday"},{label:"T",value:"thursday"},{label:"F",value:"friday"},{label:"S",value:"saturday"},{label:"S",value:"sunday"}],Re=e=>{let{end:t}=e;return"date"===t?(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{name:"end_value_date",children:(0,m.jsx)(K.A,{className:"w-100"})})}):"after"===t?(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{label:(0,d.t)("occurrences"),name:"end_value",children:(0,m.jsx)(L.A,{className:"w-100"})})}):""},Ue=e=>{let{type:t,form:l}=e;const s=k.A.useWatch("end_type",l),i=k.A.useWatch("every",l);return"dont_repeat"===t?"":"custom"===t?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"every",label:"every",children:(0,m.jsxs)(S.A.Group,{compact:!0,children:[(0,m.jsx)(k.A.Item,{name:["every","number"],noStyle:!0,children:(0,m.jsx)(L.A,{})}),(0,m.jsx)(k.A.Item,{name:["every","type"],noStyle:!0,children:(0,m.jsxs)(M.A,{children:[(0,m.jsx)(M.A.Option,{value:"day",children:(0,d.t)("day")}),(0,m.jsx)(M.A.Option,{value:"week",children:(0,d.t)("week")}),(0,m.jsx)(M.A.Option,{value:"month",children:(0,d.t)("month")})]})})]})})}),"week"===(null===i||void 0===i?void 0:i.type)&&(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"on_days",label:(0,d.t)("on.days"),children:(0,m.jsx)(Pe.A.Group,{options:Ee})})}),(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"end_type",label:(0,d.t)("end"),placeholder:(0,d.t)("select.end"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,m.jsxs)(M.A,{style:{width:"100%"},children:[(0,m.jsx)(M.A.Option,{value:"never",children:(0,d.t)("never")}),(0,m.jsx)(M.A.Option,{value:"date",children:(0,d.t)("date")}),(0,m.jsx)(M.A.Option,{value:"after",children:(0,d.t)("after")})]})})}),(0,m.jsx)(Re,{end:s})]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"end_type",label:(0,d.t)("end"),placeholder:(0,d.t)("select.end"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,m.jsxs)(M.A,{style:{width:"100%"},children:[(0,m.jsx)(M.A.Option,{value:"never",children:(0,d.t)("never")}),(0,m.jsx)(M.A.Option,{value:"date",children:(0,d.t)("date")}),(0,m.jsx)(M.A.Option,{value:"after",children:(0,d.t)("after")})]})})}),(0,m.jsx)(Re,{end:s})]})},{Title:ze}=I.A,Ge=e=>{let{form:t}=e;const{t:l}=(0,H.B)(),s=k.A.useWatch("repeats",t),{languages:i,defaultLang:n}=(0,h.d4)((e=>e.formLang),h.bN),a=(0,h.d4)((e=>{var t,l;return null===(t=e.globalSettings)||void 0===t||null===(l=t.settings)||void 0===l?void 0:l.using_12_hour_format}),h.bN),o=(0,v.Q)();return(0,m.jsxs)(F.A,{gutter:[12,12],children:[(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(ze,{className:"my-4",level:2,children:l("add.blocked.time")})}),(0,m.jsx)(O.A,{span:24,children:i.map((e=>(0,m.jsx)(k.A.Item,{label:l("title"),name:`title[${e.locale}]`,hidden:e.locale!==n,rules:[{required:e.locale===n,message:l("required")}],children:(0,m.jsx)(S.A,{})},"title"+e.locale)))}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{name:"master_id",label:l("select.master"),placeholder:l("select.master"),rules:[{required:!0,message:l("required")}],children:(0,m.jsx)(D.G,{fetchOptions:e=>(0,B.dM)({search:e}),style:{width:"100%"}})})}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{label:l("date"),name:"date",rules:[{required:!0,message:l("required")}],children:(0,m.jsx)(K.A,{className:"w-100"})})}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{label:l("from"),name:"from",rules:[{required:!0,message:l("required")}],children:(0,m.jsx)(He.A,{format:o,use12Hour:"1"===a,className:"w-100",showTime:!0})})}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{label:l("to"),name:"to",rules:[{required:!0,message:l("required")}],children:(0,m.jsx)(He.A,{format:o,use12Hour:"1"===a,className:"w-100",showTime:!0})})}),(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"repeats",label:l("repeats"),placeholder:l("select.repeat"),rules:[{required:!0,message:l("required")}],children:(0,m.jsxs)(M.A,{style:{width:"100%"},children:[(0,m.jsx)(M.A.Option,{value:"dont_repeat",children:l("dont_repeat")}),(0,m.jsx)(M.A.Option,{value:"day",children:l("day")}),(0,m.jsx)(M.A.Option,{value:"week",children:l("week")}),(0,m.jsx)(M.A.Option,{value:"month",children:l("month")}),(0,m.jsx)(M.A.Option,{value:"custom",children:l("custom")})]})})}),(0,m.jsx)(Ue,{type:s,form:t}),(0,m.jsx)(O.A,{span:24,style:{flexGrow:1},children:i.map((e=>(0,m.jsx)(k.A.Item,{label:l("description"),name:`description[${e.locale}]`,hidden:e.locale!==n,rules:[{required:e.locale===n,message:l("required")}],children:(0,m.jsx)(S.A.TextArea,{})},"description"+e.locale)))})]})};var We=l(9456);const Ke=()=>{const e=(0,h.wA)(),{defaultLang:t}=(0,h.d4)((e=>e.formLang)),{selectedSlots:l,setViewContent:i,blocktimeForm:n}=(0,s.useContext)(u.BookingContext);return(0,m.jsx)(k.A,{form:n,layout:"vertical",onFinish:l=>{var s,n,a,o;We.b.create({repeats:l.repeats,end_type:l.end_type,master_id:null===(s=l.master_id)||void 0===s?void 0:s.value,to:c()(l.to).format("HH:mm"),custom_repeat_type:null===(n=l.every)||void 0===n?void 0:n.type,from:c()(l.from).format("HH:mm"),date:c()(l.date).format("YYYY-MM-DD"),end_value:l.end_value||l.end_value_date,[`title[${t}]`]:l[`title[${t}]`],custom_repeat_value:l.on_days&&(null===(a=l.every)||void 0===a?void 0:a.number)&&[null===(o=l.every)||void 0===o?void 0:o.number,...l.on_days],[`description[${t}]`]:l[`description[${t}]`]}).then((()=>{i(""),e((0,_.k1)({perPage:100}))})).catch((e=>{console.log(e)}))},initialValues:{date:c()(),end_type:"never",repeats:"dont_repeat",from:c()(null===l||void 0===l?void 0:l.start,"HH:mm:ss"),to:c()(null===l||void 0===l?void 0:l.end,"HH:mm:ss"),every:{type:"day",number:1}},children:(0,m.jsx)(Ge,{form:n})})},Ze=()=>{const e=(0,h.wA)(),{blocktimeForm:t,disabled_slot_id:l,setViewContent:i}=(0,s.useContext)(u.BookingContext);return(0,m.jsxs)(F.A,{gutter:6,children:[Boolean(l)&&(0,m.jsx)(O.A,{span:2,children:(0,m.jsx)(ne.A,{title:"Delete the task",description:"Are you sure to delete this task?",onConfirm:()=>{We.b.delete({"ids[0]":l}).then((()=>{i(""),e((0,_.k1)({perPage:100}))})).catch((e=>{console.log(e)}))},okText:"Yes",cancelText:"No",children:(0,m.jsx)(o.A,{type:"danger",icon:(0,m.jsx)(se.A,{})})})}),(0,m.jsx)(O.A,{span:Boolean(l)?22:24,children:(0,m.jsx)(o.A,{type:"primary",className:"w-100",onClick:()=>t.submit(),children:(0,d.t)("submit")})})]})};var Qe=l(84970),Je=l(31281);const Xe=()=>{const e=(0,h.wA)(),{languages:t}=(0,h.d4)((e=>e.formLang)),{setViewContent:l,disabled_slot_id:i,blocktimeForm:n}=(0,s.useContext)(u.BookingContext),[a,o]=(0,s.useState)(!1);function d(e){if(null===e||void 0===e||!e.translations)return{};const{translations:l}=e,s=t.map((e=>{var t,s;return{[`title[${e.locale}]`]:null===(t=l.find((t=>t.locale===e.locale)))||void 0===t?void 0:t.title,[`description[${e.locale}]`]:null===(s=l.find((t=>t.locale===e.locale)))||void 0===s?void 0:s.description}}));return Object.assign({},...s)}return(0,s.useEffect)((()=>{i&&(o(!0),Qe.A.getById(i).then((e=>{var t,l,s,i,a,o;let{data:r}=e;const u={master_id:{label:`${(null===r||void 0===r||null===(t=r.master)||void 0===t?void 0:t.firstname)||""} ${(null===r||void 0===r||null===(l=r.master)||void 0===l?void 0:l.lastname)||""}`,value:null===r||void 0===r||null===(s=r.master)||void 0===s?void 0:s.id,key:null===r||void 0===r||null===(i=r.master)||void 0===i?void 0:i.id},every:{type:r.custom_repeat_type,number:null===(a=r.custom_repeat_value)||void 0===a?void 0:a[0]},on_days:null===(o=r.custom_repeat_value)||void 0===o?void 0:o.filter(((e,t)=>0!==t)),repeats:r.repeats,end_type:r.end_type,end_value:r.end_value,date:c()(r.date,"YYYY-MM-DD"),end_value_date:"date"===r.end_type?c()(r.end_value.replace(/\"/g,""),"YYYY-MM-DD"):"",from:c()(null===r||void 0===r?void 0:r.from,"HH:mm:ss"),to:c()(null===r||void 0===r?void 0:r.to,"HH:mm:ss"),...d(r)};n.setFieldsValue(u)})).catch((e=>{console.log(e)})).finally((()=>o(!1))))}),[i]),(0,m.jsx)(A.A,{spinning:a,children:(0,m.jsx)(k.A,{form:n,layout:"vertical",onFinish:s=>{var n,a,o,d,r;We.b.update(i,{repeats:s.repeats,end_type:s.end_type,master_id:null===(n=s.master_id)||void 0===n?void 0:n.value,to:c()(s.to).format("HH:mm"),custom_repeat_type:null===(a=s.every)||void 0===a?void 0:a.type,from:c()(s.from).format("HH:mm"),date:c()(s.date).format("YYYY-MM-DD"),end_value:(null===(o=s.end_value)||void 0===o?void 0:o.toString())||s.end_value_date,title:(0,Je.A)(t,s),description:(0,Je.A)(t,s,"description"),custom_repeat_value:s.on_days&&(null===(d=s.every)||void 0===d?void 0:d.number)&&[null===(r=s.every)||void 0===r?void 0:r.number,...s.on_days]}).then((()=>{l(""),e((0,_.k1)({perPage:100}))})).catch((e=>{console.log(e)}))},children:(0,m.jsx)(Ge,{form:n})})})},et=()=>{const{viewContent:e,setViewContent:t}=(0,s.useContext)(u.BookingContext);return(0,m.jsx)(C,{open:e,setOpen:t,footer:(()=>{switch(e){case"addService":return(0,m.jsx)(ve,{});case"updateForm":return(0,m.jsx)(ce,{});case"updateService":return(0,m.jsx)(be,{});case"blockTime":case"updateBlockTime":return(0,m.jsx)(Ze,{});default:return""}})(),children:(0,m.jsxs)(m.Fragment,{children:["addService"!==e&&"serviceForm"!==e&&"blockTime"!==e&&"updateBlockTime"!==e&&(0,m.jsx)(Me,{}),(()=>{switch(e){case"addService":return(0,m.jsx)(ue,{});case"serviceForm":return(0,m.jsx)(ge,{});case"updateForm":default:return(0,m.jsx)(G,{});case"updateService":return(0,m.jsx)(le,{});case"notes":return(0,m.jsx)(ke,{});case"forms":return(0,m.jsx)($e,{});case"activity":return(0,m.jsx)(Le,{});case"blockTime":return(0,m.jsx)(Ke,{});case"updateBlockTime":return(0,m.jsx)(Xe,{})}})()]})})};var tt=l(66136),lt=l(24893),st=l(25933);const{Title:it}=I.A,nt=e=>{var t,l,i;let{item:n}=e;const[a]=k.A.useForm(),{service_id:r,setIsAddForm:c,calculatedData:v,setCalculatedData:p}=(0,s.useContext)(u.BookingContext),h=e=>{var t,l,s;switch(e.answer_type){case"single_answer":return(0,m.jsx)(lt.Ay.Group,{children:null===(t=e.answer)||void 0===t?void 0:t.map((e=>(0,m.jsx)(lt.Ay,{value:e,children:e})))});case"short_answer":return(0,m.jsx)(S.A,{});case"long_answer":return(0,m.jsx)(S.A.TextArea,{});case"multiple_choice":return(0,m.jsx)(Pe.A.Group,{children:null===(l=e.answer)||void 0===l?void 0:l.map((e=>(0,m.jsx)(Pe.A,{value:e,children:e})))});case"drop_down":return(0,m.jsx)(M.A,{children:null===(s=e.answer)||void 0===s?void 0:s.map((e=>(0,m.jsx)(M.A.Option,{value:e,children:e})))});case"yes_or_no":return(0,m.jsx)(st.A,{});default:return""}},x=null===v||void 0===v||null===(t=v.items)||void 0===t?void 0:t.flatMap((e=>e.data.form||[]));return(0,m.jsxs)(j.A,{className:"w-100",children:[(0,m.jsx)(it,{children:null===n||void 0===n||null===(l=n.translation)||void 0===l?void 0:l.title}),(0,m.jsxs)(k.A,{layout:"vertical",form:a,onFinish:e=>{var t,l;f.A.update(r,{data:{...null===v||void 0===v||null===(t=v.items[0])||void 0===t?void 0:t.data,form:[...x,{...n,data:null===(l=n.data)||void 0===l?void 0:l.map((t=>{const l=e[t.answer_type];return{...t,user_answer:l?"object"===typeof l?l:[l]:void 0}}))}]}}).then((e=>{a.resetFields(),c(!1),p((t=>({...t,items:t.items.map((t=>({...t,data:e.data.data})))})))})).catch((e=>{console.log(e)}))},children:[null===(i=n.data)||void 0===i?void 0:i.map((e=>(0,m.jsx)(m.Fragment,{children:"description_text"===e.answer_type?(0,m.jsx)(we.A,{message:e.question,type:"info"}):(0,m.jsx)(k.A.Item,{label:e.question,name:e.answer_type,rules:[{required:Boolean(e.required)}],children:h(e)})}))),(0,m.jsx)(o.A,{className:"mt-4",type:"primary",htmlType:"submit",children:(0,d.t)("complate")})]})]})},at=()=>{const{isAddForm:e,setIsAddForm:t}=(0,s.useContext)(u.BookingContext),[l,i]=(0,s.useState)([]),[n,o]=(0,s.useState)(null),r=l.map((e=>({key:e.id,label:e.translation.title}))),c=(0,s.useMemo)((()=>l.find((e=>e.id===n))),[n,l]);return(0,s.useEffect)((()=>{tt.A.getAll().then((e=>{let{data:t}=e;i(t),o(t[0].id)})).catch((e=>{console.log(e)}))}),[]),(0,m.jsx)(a.A,{centered:!0,width:912,footer:null,visible:e,onCancel:()=>{t(!1)},title:(0,d.t)("select.a.form"),children:(0,m.jsxs)("div",{className:"d-flex gap-2",children:[(0,m.jsx)(Fe.A,{style:{width:256},mode:"vertical",items:r,onClick:e=>{let{key:t}=e;return o(Number(t))}}),(0,m.jsx)(nt,{item:c,formList:l})]})})};var ot=l(8297),dt=l(58547);const rt=()=>{const{t:e}=(0,H.B)(),t=(0,h.wA)(),[l,i]=(0,s.useState)({}),n=e=>{const t={search:null!==e&&void 0!==e&&e.length?e:void 0,page:1,perPage:20,role:"master",shop_id:(null===l||void 0===l?void 0:l.shop_id)||void 0};return te.A.getAll(t).then((e=>{let{data:t}=e;return null===t||void 0===t?void 0:t.map((e=>({label:`${null===e||void 0===e?void 0:e.firstname} ${null===e||void 0===e?void 0:e.lastname}`,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id})))}))},a=e=>{i((t=>({...t,...e})))};return(0,s.useEffect)((()=>{t((0,x.ww)(l)),t((0,_.k1)({perPage:100,...l}))}),[l]),(0,s.useEffect)((()=>{n()}),[]),(0,m.jsx)(j.A,{children:(0,m.jsxs)(F.A,{gutter:24,children:[(0,m.jsx)(O.A,{span:5,children:(0,m.jsx)(ot.A,{defaultValue:l.search,placeholder:e("search"),handleChange:e=>a({search:e})})}),(0,m.jsx)(O.A,{span:5,children:(0,m.jsx)(D.G,{className:"w-100",fetchOptions:n,placeholder:e("select.master"),refetchOptions:!0,onClear:()=>a({master_id:null}),onSelect:e=>a({master_id:null===e||void 0===e?void 0:e.value})})}),(0,m.jsx)(O.A,{span:5,children:(0,m.jsx)(D.G,{placeholder:e("select.shop"),fetchOptions:async function(e){const t={search:e,status:"approved"};return dt.A.getAll(t).then((e=>{let{data:t}=e;return t.map((e=>{var t;return{label:null===e||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}}))}))},style:{width:"100%"},onSelect:e=>a({shop_id:null===e||void 0===e?void 0:e.value}),onDeselect:()=>a({shop_id:null}),onClear:()=>a({shop_id:null}),allowClear:!0,value:null===l||void 0===l?void 0:l.shop_id})})]})})};var ct=l(91524);const ut=()=>{var e,t,l;const{formDetailId:i,setFormDetailId:n,calculatedData:o}=(0,s.useContext)(u.BookingContext),r=null===o||void 0===o||null===(e=o.items)||void 0===e?void 0:e.flatMap((e=>e.data.form||[])).find((e=>e.id===i));return(0,m.jsx)(a.A,{footer:null,visible:i,onCancel:()=>{n(null)},title:(0,d.t)("form.detail"),children:(0,m.jsx)(ct.A,{title:null===r||void 0===r||null===(t=r.translation)||void 0===t?void 0:t.title,layout:"vertical",children:null===r||void 0===r||null===(l=r.data)||void 0===l?void 0:l.map(((e,t)=>{var l,s;return"yes_or_no"===e.answer_type?(0,m.jsx)(ct.A.Item,{label:e.question,span:12,children:null===e||void 0===e||null===(l=e.user_answer)||void 0===l?void 0:l.map((e=>e?(0,d.t)("yes"):(0,d.t)("no")))},t):(0,m.jsx)(ct.A.Item,{label:e.question,span:12,children:null===e||void 0===e||null===(s=e.user_answer)||void 0===s?void 0:s.map((e=>(e.answer_type,(0,m.jsx)("div",{className:"ml-1",children:e}))))},t)}))})})},vt=()=>{const[e]=k.A.useForm(),{updateStatus:t,setUpdateStatus:l,setCalculatedData:i}=(0,s.useContext)(u.BookingContext),n=()=>{l(null),e.resetFields()};return(0,m.jsx)(a.A,{title:(0,d.t)("update.status"),visible:t,onCancel:n,width:280,footer:null,children:(0,m.jsxs)(k.A,{form:e,onFinish:e=>{f.A.changeStatus(t.booking_id,e).then((e=>{let{data:l}=e;n(),i((e=>({...e,items:e.items.map((e=>({...e,status:e.booking_id===t.booking_id?l.status:e.status})))})))})).catch((e=>{console.log(e)}))},layout:"vertical",initialValues:{status:null===t||void 0===t?void 0:t.status},children:[(0,m.jsx)(k.A.Item,{name:"status",rules:[{required:!0}],label:"status",children:(0,m.jsxs)(M.A,{children:[(0,m.jsx)(M.A.Option,{value:"new",children:(0,d.t)("new")}),(0,m.jsx)(M.A.Option,{value:"canceled",children:(0,d.t)("canceled")}),(0,m.jsx)(M.A.Option,{value:"booked",children:(0,d.t)("booked")}),(0,m.jsx)(M.A.Option,{value:"progress",children:(0,d.t)("progress")}),(0,m.jsx)(M.A.Option,{value:"ended",children:(0,d.t)("ended")})]})}),(0,m.jsx)(o.A,{htmlType:"submit",type:"primary",children:(0,d.t)("submit")})]})})},mt=()=>{const e=(0,h.wA)();return(0,s.useEffect)((()=>{e((0,x.ww)())}),[e]),(0,m.jsxs)(u.default,{children:[(0,m.jsx)(rt,{}),(0,m.jsx)(b,{}),(0,m.jsx)(p,{}),(0,m.jsx)(et,{}),(0,m.jsx)(at,{}),(0,m.jsx)(ut,{}),(0,m.jsx)(vt,{})]})}},95550:(e,t,l)=>{"use strict";l.r(t),l.d(t,{BookingContext:()=>o,default:()=>d});var s=l(59233),i=l(9950),n=l(42074),a=l(44414);const o=(0,i.createContext)(null),d=e=>{var t;let{children:l}=e,[d]=(0,n.ok)();const r=d.get("service_id"),c=d.get("disabled_slot_id"),[u]=s.A.useForm(),[v]=s.A.useForm(),[m]=s.A.useForm(),[p,h]=(0,i.useState)([]),[x,j]=(0,i.useState)({}),[A,g]=(0,i.useState)({}),[f,y]=(0,i.useState)(!1),[_,b]=(0,i.useState)(null),[w,C]=(0,i.useState)(!1),[k,S]=(0,i.useState)(""),[D,N]=(0,i.useState)(!1),[I,F]=(0,i.useState)(null),[O,M]=(0,i.useState)(null),[B,T]=(0,i.useState)(null),[q,$]=(0,i.useState)(null),Y=null===x||void 0===x||null===(t=x.items)||void 0===t?void 0:t.reduce(((e,t)=>{var l;return e+(null===t||void 0===t||null===(l=t.service_master)||void 0===l?void 0:l.interval)}),0);return(0,a.jsx)(o.Provider,{value:{infoForm:v,serviceForm:u,serviceData:p,setServiceData:h,calculatedData:x,setCalculatedData:j,selectedSlots:_,setSelectedSlots:b,isModalOpen:f,setIsModalOpen:y,isLoalding:w,setIsLoading:C,viewContent:k,setViewContent:S,sumInterval:Y,infoData:A,setInfoData:g,service_id:r,isAddForm:D,setIsAddForm:N,disabled_slot_id:c,blocktimeForm:m,formDetailId:I,setFormDetailId:F,updateStatus:O,setUpdateStatus:M,selectedService:B,setSelectedService:T,selectedMaster:q,setSelectedMaster:$},children:l})}}}]);