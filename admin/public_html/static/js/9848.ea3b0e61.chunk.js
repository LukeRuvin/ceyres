"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[9848],{27276:(e,l,t)=>{t.d(l,{v:()=>s});var a=t(9950),i=t(90777),r=t(90650),n=t(44414);const s=e=>{let{fetchOptions:l,refetch:t=!1,...s}=e;const[d,o]=(0,a.useState)(!1),[u,c]=(0,a.useState)([]);return(0,n.jsx)(i.A,{treeLine:!0,treeData:d?[]:u,treeDefaultExpandAll:!0,labelInValue:!0,onFocus:()=>{u.length&&!t||(o(!0),l().then((e=>{c(e),o(!1)})))},notFoundContent:d?(0,n.jsx)(r.A,{size:"small"}):"no results",...s})}},49848:(e,l,t)=>{t.r(l),t.d(l,{default:()=>_});var a=t(9950),i=t(59233),r=t(23263),n=t(87094),s=t(41988),d=t(55902),o=t(99674),u=t(40577),c=t(25933),m=t(48538),v=t(90650),p=t(85923),h=t(28429),j=t(71999),y=t(98591),g=t(91854),x=t(74623),A=t(28264),b=t(70030),f=t(48970),w=t(27276),k=t(12598),I=t(44414);const _=()=>{var e,l;const{t:t}=(0,b.B)(),_=(0,h.Zp)(),P=(0,g.wA)(),{activeMenu:E}=(0,g.d4)((e=>e.menu),g.bN),{state:q}=(0,h.zy)(),[S,$]=(0,a.useState)(!1),[F,N]=(0,a.useState)("main"),[z,L]=(0,a.useState)(null!==(e=E.data)&&void 0!==e&&e.image?[null===(l=E.data)||void 0===l?void 0:l.image]:[]),[O]=i.A.useForm(),[C,V]=(0,a.useState)(!1),[B,D]=(0,a.useState)(null),{uuid:M}=(0,h.g)(),{defaultLang:U,languages:K}=(0,g.d4)((e=>e.formLang),g.bN);(0,a.useEffect)((()=>()=>{const e=O.getFieldsValue(!0);P((0,x.Ok)({activeMenu:E,data:e}))}),[]);const R=e=>({name:e,url:e});function T(e){if(!e)return{};const{translations:l}=e,t=K.map((e=>{var t,a;return{[`title[${e.locale}]`]:null===(t=l.find((l=>l.locale===e.locale)))||void 0===t?void 0:t.title,[`description[${e.locale}]`]:null===(a=l.find((l=>l.locale===e.locale)))||void 0===a?void 0:a.description}}));return Object.assign({},...t)}(0,a.useEffect)((()=>{var e;E.refetch&&(e=M,$(!0),k.A.getById(e).then((e=>{var l,t;let a=e.data;const i={...a,...T(a),image:[R(a.img)],keywords:a.keywords.split(","),parent_id:{label:null===(l=a.parent)||void 0===l||null===(t=l.translation)||void 0===t?void 0:t.title,value:a.parent_id,key:a.parent_id}};O.setFieldsValue(i),L([R(a.img)])})).finally((()=>{$(!1),P((0,x.km)(E))})))}),[E.refetch]);return(0,I.jsx)(r.A,{title:t("category.clone"),extra:(0,I.jsx)(j.A,{}),children:S?(0,I.jsx)("div",{className:"d-flex justify-content-center align-items-center py-5",children:(0,I.jsx)(v.A,{size:"large",className:"mt-5 pt-5"})}):(0,I.jsxs)(i.A,{name:"basic",layout:"vertical",onFinish:e=>{var l,a,i;V(!0);const r={...e,type:null!==(l=e.parent_id)&&void 0!==l&&l.value?F:"main",active:e.active?1:0,keywords:e.keywords.join(","),parent_id:null===(a=e.parent_id)||void 0===a?void 0:a.value,"images[0]":null===(i=z[0])||void 0===i?void 0:i.name},n=null!==q&&void 0!==q&&q.parentId?`seller/${q.parentUuid}`:"seller/categories";k.A.create(r).then((()=>{p.oR.success(t("successfully.updated")),P((0,x.EK)({...E,nextUrl:n})),P((0,A.uO)({type:null!==q&&void 0!==q&&q.parentId?"sub_main":"main",parent_id:null===q||void 0===q?void 0:q.parentId})),_(`/${n}`)})).catch((e=>D(e.response.data.params))).finally((()=>V(!1)))},initialValues:{parent_id:{title:"---",value:0,key:0},active:!0,...E.data},form:O,children:[(0,I.jsxs)(n.A,{gutter:12,children:[(0,I.jsx)(s.A,{span:12,children:K.map(((e,l)=>(0,I.jsx)(i.A.Item,{label:t("name"),name:`title[${e.locale}]`,help:B&&B[`title.${U}`]?B[`title.${U}`][0]:null,validateStatus:B?"error":"success",rules:[{validator:(l,a)=>a||(null===e||void 0===e?void 0:e.locale)!==U?a&&""===(null===a||void 0===a?void 0:a.trim())?Promise.reject(new Error(t("no.empty.space"))):a&&(null===a||void 0===a?void 0:a.trim().length)<2?Promise.reject(new Error(t("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(t("required")))}],hidden:e.locale!==U,children:(0,I.jsx)(d.A,{})},e.title+l)))}),(0,I.jsx)(s.A,{span:12,children:K.map(((e,l)=>(0,I.jsx)(i.A.Item,{label:t("description"),name:`description[${e.locale}]`,rules:[{validator:(l,a)=>a||(null===e||void 0===e?void 0:e.locale)!==U?a&&""===(null===a||void 0===a?void 0:a.trim())?Promise.reject(new Error(t("no.empty.space"))):a&&(null===a||void 0===a?void 0:a.trim().length)<5?Promise.reject(new Error(t("must.be.at.least.5"))):Promise.resolve():Promise.reject(new Error(t("required")))}],hidden:e.locale!==U,children:(0,I.jsx)(y.A,{rows:4})},e.locale+l)))}),(0,I.jsx)(s.A,{span:12,children:(0,I.jsx)(i.A.Item,{label:t("keywords"),name:"keywords",rules:[{required:!0,message:t("required")}],children:(0,I.jsx)(o.A,{mode:"tags",style:{width:"100%"}})})}),!(null!==q&&void 0!==q&&q.parentId)&&(0,I.jsx)(s.A,{span:12,children:(0,I.jsx)(i.A.Item,{label:t("parent.category"),name:"parent_id",rules:[{required:!1,message:t("required")}],children:(0,I.jsx)(w.v,{refetch:!0,fetchOptions:async function(){return k.A.getAll({perPage:100,type:"main"}).then((e=>e.data.map((e=>{var l,t;return{label:null===(l=e.translation)||void 0===l?void 0:l.title,value:e.id,key:e.id,type:"main",children:null===(t=e.children)||void 0===t?void 0:t.map((e=>{var l,t;return{label:null===(l=e.translation)||void 0===l?void 0:l.title,value:e.id,key:e.id,type:"sub_main",disabled:"child"===e.type,children:null===(t=e.children)||void 0===t?void 0:t.map((e=>{var l;return{label:null===(l=e.translation)||void 0===l?void 0:l.title,value:e.id,key:e.id,disabled:!0,type:"child"}}))}}))}}))))},onSelect:(e,l,t)=>{const{type:a}=l||{};N("main"===a?"sub_main":"sub_main"===a?"child":"main")},allowClear:!0})})}),(0,I.jsx)(s.A,{span:12,children:(0,I.jsx)(i.A.Item,{name:"input",label:t("input"),rules:[{required:!0,message:t("required")}],children:(0,I.jsx)(u.A,{min:0,parser:e=>parseInt(e,10),max:9999999,className:"w-100"})})}),(0,I.jsx)(s.A,{span:4,children:(0,I.jsx)(i.A.Item,{label:t("image"),name:"images",rules:[{validator:()=>0===(null===z||void 0===z?void 0:z.length)?Promise.reject(new Error(t("required"))):Promise.resolve()}],children:(0,I.jsx)(f.A,{type:"categories",imageList:z,setImageList:L,form:O,multiple:!1})})}),(0,I.jsx)(s.A,{span:2,children:(0,I.jsx)(i.A.Item,{label:t("active"),name:"active",valuePropName:"checked",children:(0,I.jsx)(c.A,{})})})]}),(0,I.jsx)(m.A,{type:"primary",htmlType:"submit",loading:C,children:t("submit")})]})})}}}]);