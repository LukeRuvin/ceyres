"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[4225],{8002:(e,l,t)=>{t.d(l,{A:()=>s});var a=t(82371);const s={getAll:e=>a.A.get("dashboard/seller/stocks/select-paginate",{params:e})}},14225:(e,l,t)=>{t.r(l),t.d(l,{default:()=>D});var a=t(9950),s=t(28429),n=t(85923),d=t(59233),r=t(23263),i=t(87094),o=t(41988),u=t(99674),c=t(40577),m=t(86971),v=t(48538),p=t(59051),h=t.n(p),x=t(91854),A=t(74623),f=t(35765),j=t(73439),g=t(47992),Y=t(70030),b=t(48970),y=t(8002),M=t(44738),N=t(44414);function D(){var e,l;const{t:t}=(0,Y.B)(),{activeMenu:p}=(0,x.d4)((e=>e.menu),x.bN),D=(0,x.wA)(),[q]=d.A.useForm(),S=(0,s.Zp)(),[w,O]=(0,a.useState)(!1),{myShop:k}=(0,x.d4)((e=>e.myShop),x.bN),[I,C]=(0,a.useState)(null!==(e=p.data)&&void 0!==e&&e.images?[null===(l=p.data)||void 0===l?void 0:l.images[0]]:[]);(0,a.useEffect)((()=>()=>{const e=q.getFieldsValue(!0),l=JSON.stringify(e.start),t=JSON.stringify(e.end),a={...e,start:l,end:t};D((0,A.Ok)({activeMenu:p,data:a}))}),[]);return(0,N.jsx)(r.A,{title:t("add.discount"),className:"h-100",children:(0,N.jsxs)(d.A,{name:"discount-add",layout:"vertical",onFinish:e=>{var l;if(h()(e.start).format("YYYY-MM-DD")>h()(e.end).format("YYYY-MM-DD"))return n.oR.error(t("start.date.must.be.before.end.date"));const a={price:e.price,type:e.type,stocks:e.products.map((e=>e.value)),start:e.start?h()(e.start).format("YYYY-MM-DD"):void 0,end:e.end?h()(e.end).format("YYYY-MM-DD"):void 0,images:[null===(l=I[0])||void 0===l?void 0:l.name]};O(!0);const s="seller/discounts";f.A.create(a).then((()=>{n.oR.success(t("successfully.created")),(0,x.vA)((()=>{D((0,A.EK)({...p,nextUrl:s})),D((0,j.X)({}))})),S(`/${s}`)})).finally((()=>O(!1)))},form:q,initialValues:{...(()=>{var e,l,t,a;const s=p.data;if(null===(e=p.data)||void 0===e||!e.start||null===(l=p.data)||void 0===l||!l.end)return s;const n=null===(t=p.data)||void 0===t?void 0:t.start,d=null===(a=p.data)||void 0===a?void 0:a.end;return{...s,start:h()(n,"YYYY-MM-DD"),end:h()(d,"YYYY-MM-DD")}})(),...p.data},className:"d-flex flex-column h-100",children:[(0,N.jsxs)(i.A,{gutter:12,children:[(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(d.A.Item,{label:t("type"),name:"type",rules:[{required:!0,message:t("required")}],children:(0,N.jsxs)(u.A,{children:[(0,N.jsx)(u.A.Option,{value:"fix",children:t("fix")}),(0,N.jsx)(u.A.Option,{value:"percent",children:t("percent")})]})})}),(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(d.A.Item,{label:t("price"),name:"price",rules:[{required:!0,message:t("required")}],children:(0,N.jsx)(c.A,{min:0,className:"w-100"})})}),(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(d.A.Item,{label:t("start.date"),name:"start",rules:[{required:!0,message:t("required")}],valuePropName:"date",children:(0,N.jsx)(m.A,{className:"w-100",placeholder:"",disabledDate:e=>h()().add(-1,"days")>=e})})}),(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(d.A.Item,{label:t("end.date"),name:"end",rules:[{required:!0,message:t("required")}],valuePropName:"date",children:(0,N.jsx)(m.A,{className:"w-100",placeholder:"",disabledDate:e=>h()().add(-1,"days")>=e})})}),(0,N.jsx)(o.A,{span:24,children:(0,N.jsx)(d.A.Item,{label:t("products"),name:"products",rules:[{required:!0,message:t("required")}],children:(0,N.jsx)(g.G,{fetchOptions:async function(e){const l={search:null!==e&&void 0!==e&&e.length?e:void 0,shop_id:k.id};return y.A.getAll(l).then((e=>{let{data:l}=e;return l.map((e=>{var l,a,s,n;return{label:`${null===e||void 0===e||null===(l=e.product)||void 0===l||null===(a=l.translation)||void 0===a?void 0:a.title} => ${null===e||void 0===e||null===(s=e.extras)||void 0===s||null===(n=s.map((e=>{var l,a,s,n,d;return`${(null===e||void 0===e||null===(l=e.group)||void 0===l||null===(a=l.translation)||void 0===a?void 0:a.title)||t("N/A")}: ${"color"===(null===e||void 0===e||null===(s=e.group)||void 0===s?void 0:s.type)?(0,M.n)(null===e||void 0===e||null===(n=e.value)||void 0===n?void 0:n.value):(null===e||void 0===e||null===(d=e.value)||void 0===d?void 0:d.value)||t("N/A")}`})))||void 0===n?void 0:n.join(", ")}`,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}}))}))},mode:"multiple"})})}),(0,N.jsx)(o.A,{span:24,children:(0,N.jsx)(d.A.Item,{label:t("image"),name:"images",rules:[{required:!I.length,message:t("required")}],children:(0,N.jsx)(b.A,{type:"discounts",imageList:I,setImageList:C,form:q,multiple:!1,name:"image"})})})]}),(0,N.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,N.jsx)("div",{className:"pb-5",children:(0,N.jsx)(v.A,{type:"primary",htmlType:"submit",loading:w,children:t("submit")})})})]})})}},47992:(e,l,t)=>{t.d(l,{G:()=>o});var a=t(9950),s=t(95491),n=t.n(s),d=t(99674),r=t(90650),i=t(44414);const o=e=>{let{fetchOptions:l,debounceTimeout:t=400,onClear:s,refetchOptions:o=!1,...u}=e;const[c,m]=(0,a.useState)(!1),[v,p]=(0,a.useState)([]),h=(0,a.useMemo)((()=>n()((e=>{p([]),m(!0),l(e).then((e=>{p(e),m(!1)}))}),t)),[l,t]);return(0,i.jsx)(d.A,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:h,onClear:()=>{h(""),s&&s()},notFoundContent:c?(0,i.jsx)(r.A,{size:"small"}):"no results",...u,options:v,onFocus:()=>{v.length&&!o||h("")}})}}}]);